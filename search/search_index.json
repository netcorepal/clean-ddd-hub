{"config":{"lang":["en"],"separator":"[\\s\\u200b\\u3000\\-\u3001\u3002\uff0c\uff0e\uff1f\uff01\uff1b]+","pipeline":["stemmer"]},"docs":[{"location":"","title":"\u6b22\u8fce\u6765\u5230 Clean DDD Hub \u77e5\u8bc6\u5e93","text":""},{"location":"#_1","title":"\u5173\u4e8e\u672c\u77e5\u8bc6\u5e93","text":"<p>Clean DDD Hub \u77e5\u8bc6\u5e93\u81f4\u529b\u4e8e\u5e2e\u52a9\u5f00\u53d1\u8005\u7406\u89e3\u548c\u5b9e\u8df5\u9886\u57df\u9a71\u52a8\u8bbe\u8ba1(Domain-Driven Design)\u548c\u6574\u6d01\u67b6\u6784(Clean Architecture)\u3002\u65e0\u8bba\u4f60\u662f\u521a\u63a5\u89e6\u8fd9\u4e9b\u6982\u5ff5\u7684\u65b0\u624b\uff0c\u8fd8\u662f\u5e0c\u671b\u6df1\u5165\u4e86\u89e3\u6700\u4f73\u5b9e\u8df5\u7684\u7ecf\u9a8c\u5f00\u53d1\u8005\uff0c\u8fd9\u91cc\u90fd\u80fd\u627e\u5230\u4f60\u9700\u8981\u7684\u5185\u5bb9\u3002</p>"},{"location":"#_2","title":"\u5feb\u901f\u5bfc\u822a","text":""},{"location":"#_3","title":"\ud83d\ude80 \u5165\u95e8\u6307\u5357","text":"<p>\u5982\u679c\u4f60\u662f\u65b0\u624b\uff0c\u5efa\u8bae\u4ece\u4ee5\u4e0b\u5185\u5bb9\u5f00\u59cb\uff1a</p> <ul> <li>\u4ec0\u4e48\u662fDDD - \u4e86\u89e3\u9886\u57df\u9a71\u52a8\u8bbe\u8ba1\u7684\u6838\u5fc3\u601d\u60f3</li> <li>\u4ec0\u4e48\u662fClean Architecture - \u7406\u89e3\u6574\u6d01\u67b6\u6784\u7684\u8bbe\u8ba1\u539f\u5219</li> <li>\u5feb\u901f\u5f00\u59cb - \u4f7f\u7528\u6211\u4eec\u7684\u6846\u67b6\u5feb\u901f\u642d\u5efa\u9879\u76ee</li> </ul>"},{"location":"#_4","title":"\ud83d\udcda \u6838\u5fc3\u6982\u5ff5","text":"<p>\u6df1\u5165\u7406\u89e3DDD\u7684\u6838\u5fc3\u6982\u5ff5\uff1a</p> <ul> <li>\u9886\u57df\u6a21\u578b - \u6784\u5efa\u4e1a\u52a1\u6838\u5fc3\u6a21\u578b</li> <li>\u9650\u754c\u4e0a\u4e0b\u6587 - \u5212\u5206\u7cfb\u7edf\u8fb9\u754c</li> <li>\u805a\u5408\u6839 - \u4fdd\u8bc1\u6570\u636e\u4e00\u81f4\u6027</li> <li>\u5b9e\u4f53\u4e0e\u503c\u5bf9\u8c61 - \u533a\u5206\u4e0d\u540c\u7684\u9886\u57df\u5bf9\u8c61</li> <li>\u9886\u57df\u4e8b\u4ef6 - \u5b9e\u73b0\u677e\u8026\u5408\u7684\u4e8b\u4ef6\u9a71\u52a8</li> <li>\u4ed3\u50a8\u6a21\u5f0f - \u62bd\u8c61\u6570\u636e\u8bbf\u95ee</li> </ul>"},{"location":"#_5","title":"\ud83c\udfd7\ufe0f \u67b6\u6784\u8bbe\u8ba1","text":"<p>\u5b66\u4e60\u4e0d\u540c\u7684\u67b6\u6784\u6a21\u5f0f\uff1a</p> <ul> <li>\u5206\u5c42\u67b6\u6784 - \u4f20\u7edf\u7684\u5206\u5c42\u8bbe\u8ba1</li> <li>\u516d\u8fb9\u5f62\u67b6\u6784 - \u7aef\u53e3\u4e0e\u9002\u914d\u5668\u6a21\u5f0f</li> <li>\u6574\u6d01\u67b6\u6784 - Uncle Bob\u7684\u6574\u6d01\u67b6\u6784</li> <li>CQRS\u6a21\u5f0f - \u547d\u4ee4\u67e5\u8be2\u804c\u8d23\u5206\u79bb</li> <li>\u4e8b\u4ef6\u9a71\u52a8\u67b6\u6784 - \u57fa\u4e8e\u4e8b\u4ef6\u7684\u7cfb\u7edf\u8bbe\u8ba1</li> </ul>"},{"location":"#_6","title":"\ud83d\udca1 \u6700\u4f73\u5b9e\u8df5","text":"<p>\u5b9e\u6218\u7ecf\u9a8c\u548c\u5efa\u8bae\uff1a</p> <ul> <li>\u9879\u76ee\u7ed3\u6784 - \u63a8\u8350\u7684\u9879\u76ee\u7ec4\u7ec7\u65b9\u5f0f</li> <li>\u547d\u540d\u89c4\u8303 - \u7edf\u4e00\u7684\u547d\u540d\u7ea6\u5b9a</li> <li>\u6d4b\u8bd5\u7b56\u7565 - \u5168\u9762\u7684\u6d4b\u8bd5\u65b9\u6cd5</li> <li>\u4ee3\u7801\u89c4\u8303 - \u4ee3\u7801\u8d28\u91cf\u6807\u51c6</li> </ul>"},{"location":"#_7","title":"\ud83d\udee0\ufe0f \u5f00\u53d1\u5de5\u5177","text":"<p>\u6211\u4eec\u63d0\u4f9b\u7684\u5f00\u53d1\u6846\u67b6\u548c\u5de5\u5177\uff1a</p> <ul> <li>NetCorePal Cloud Framework - .NET\u5e73\u53f0\u7684DDD\u6846\u67b6</li> <li>CAP4J Framework - Java\u5e73\u53f0\u7684DDD\u6846\u67b6</li> <li>\u5f00\u53d1\u5de5\u5177\u63a8\u8350 - \u63d0\u5347\u5f00\u53d1\u6548\u7387\u7684\u5de5\u5177</li> </ul>"},{"location":"#dddclean-architecture","title":"\u4e3a\u4ec0\u4e48\u9009\u62e9DDD\u548cClean Architecture?","text":""},{"location":"#ddd","title":"\u9886\u57df\u9a71\u52a8\u8bbe\u8ba1 (DDD)","text":"<p>\u9886\u57df\u9a71\u52a8\u8bbe\u8ba1\u662f\u4e00\u79cd\u8f6f\u4ef6\u5f00\u53d1\u65b9\u6cd5\uff0c\u5b83\u5f3a\u8c03\uff1a</p> <ul> <li>\u9886\u57df\u4e13\u5bb6\u4e0e\u5f00\u53d1\u8005\u7684\u534f\u4f5c - \u5efa\u7acb\u7edf\u4e00\u8bed\u8a00(Ubiquitous Language)</li> <li>\u4e1a\u52a1\u903b\u8f91\u7684\u6838\u5fc3\u5730\u4f4d - \u5c06\u4e1a\u52a1\u89c4\u5219\u4f5c\u4e3a\u7cfb\u7edf\u7684\u6838\u5fc3</li> <li>\u6218\u7565\u8bbe\u8ba1\u4e0e\u6218\u672f\u8bbe\u8ba1 - \u4ece\u5b8f\u89c2\u5230\u5fae\u89c2\u7684\u5b8c\u6574\u65b9\u6cd5\u8bba</li> <li>\u5e94\u5bf9\u590d\u6742\u6027 - \u901a\u8fc7\u5408\u7406\u7684\u5efa\u6a21\u6765\u7ba1\u7406\u4e1a\u52a1\u590d\u6742\u5ea6</li> </ul>"},{"location":"#clean-architecture","title":"\u6574\u6d01\u67b6\u6784 (Clean Architecture)","text":"<p>\u6574\u6d01\u67b6\u6784\u7684\u6838\u5fc3\u539f\u5219\u5305\u62ec\uff1a</p> <ul> <li>\u4f9d\u8d56\u5012\u7f6e - \u5185\u5c42\u4e0d\u4f9d\u8d56\u5916\u5c42\uff0c\u4f9d\u8d56\u6307\u5411\u5185\u90e8</li> <li>\u4e1a\u52a1\u903b\u8f91\u72ec\u7acb - \u6838\u5fc3\u4e1a\u52a1\u4e0d\u4f9d\u8d56\u6846\u67b6\u548c\u6280\u672f\u7ec6\u8282</li> <li>\u53ef\u6d4b\u8bd5\u6027 - \u4e1a\u52a1\u903b\u8f91\u53ef\u4ee5\u72ec\u7acb\u6d4b\u8bd5</li> <li>\u6280\u672f\u65e0\u5173 - \u53ef\u4ee5\u8f7b\u677e\u66f4\u6362\u6280\u672f\u6808\u548c\u6846\u67b6</li> </ul>"},{"location":"#_8","title":"\u8d21\u732e","text":"<p>\u6211\u4eec\u6b22\u8fce\u793e\u533a\u8d21\u732e\uff01\u5982\u679c\u4f60\u53d1\u73b0\u6587\u6863\u4e2d\u7684\u9519\u8bef\u6216\u6709\u6539\u8fdb\u5efa\u8bae\uff0c\u8bf7\uff1a</p> <ol> <li>\u8bbf\u95ee\u6211\u4eec\u7684 GitHub \u4ed3\u5e93</li> <li>\u63d0\u4ea4 Issue \u6216 Pull Request</li> <li>\u53c2\u4e0e\u8ba8\u8bba\u548c\u5206\u4eab\u4f60\u7684\u7ecf\u9a8c</li> </ol>"},{"location":"#_9","title":"\u8054\u7cfb\u6211\u4eec","text":"<ul> <li>GitHub: https://github.com/netcorepal</li> <li>\u52a0\u5165\u6211\u4eec\u7684\u793e\u533a\uff0c\u4e0e\u5176\u4ed6\u5f00\u53d1\u8005\u4ea4\u6d41\u5b66\u4e60</li> </ul> <p>\u8ba9\u6211\u4eec\u4e00\u8d77\u6784\u5efa\u66f4\u597d\u7684\u8f6f\u4ef6\uff01</p>"},{"location":"architecture/clean-architecture/","title":"Clean Architecture","text":"<p>(\u5185\u5bb9\u5f85\u8865\u5145)</p>"},{"location":"architecture/cqrs/","title":"Cqrs","text":"<p>(\u5185\u5bb9\u5f85\u8865\u5145)</p>"},{"location":"architecture/event-driven/","title":"Event Driven","text":"<p>(\u5185\u5bb9\u5f85\u8865\u5145)</p>"},{"location":"architecture/hexagonal-architecture/","title":"Hexagonal Architecture","text":"<p>(\u5185\u5bb9\u5f85\u8865\u5145)</p>"},{"location":"architecture/layered-architecture/","title":"Layered Architecture","text":"<p>(\u5185\u5bb9\u5f85\u8865\u5145)</p>"},{"location":"best-practices/code-standards/","title":"\u4ee3\u7801\u89c4\u8303","text":""},{"location":"best-practices/code-standards/#_2","title":"\u6982\u8ff0","text":"<p>\u7edf\u4e00\u7684\u4ee3\u7801\u89c4\u8303\u53ef\u4ee5\u63d0\u9ad8\u4ee3\u7801\u8d28\u91cf\u3001\u53ef\u8bfb\u6027\u548c\u53ef\u7ef4\u62a4\u6027\u3002\u672c\u6587\u6863\u5b9a\u4e49\u4e86\u5728DDD\u548cClean Architecture\u9879\u76ee\u4e2d\u5e94\u9075\u5faa\u7684\u4ee3\u7801\u6807\u51c6\u548c\u6700\u4f73\u5b9e\u8df5\u3002</p>"},{"location":"best-practices/code-standards/#_3","title":"\u4ee3\u7801\u7ec4\u7ec7","text":""},{"location":"best-practices/code-standards/#1","title":"1. \u6587\u4ef6\u7ed3\u6784","text":"<p>\u6bcf\u4e2a\u6587\u4ef6\u5e94\u9075\u5faa\u4ee5\u4e0b\u7ed3\u6784\u987a\u5e8f\uff1a</p> <pre><code>// 1. Using\u6307\u4ee4\uff08\u6309\u5b57\u6bcd\u987a\u5e8f\uff09\nusing System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing MyProject.Domain.AggregatesModel.UserAggregate;\n\n// 2. \u547d\u540d\u7a7a\u95f4\nnamespace MyProject.Web.Application.Commands.User;\n\n// 3. \u7c7b\u578b\u5b9a\u4e49\npublic record CreateUserCommand(string Name, string Email) : ICommand&lt;UserId&gt;;\n\n// 4. \u5d4c\u5957\u7c7b\u578b\u6216\u76f8\u5173\u7c7b\u578b\npublic class CreateUserCommandValidator : AbstractValidator&lt;CreateUserCommand&gt;\n{\n    // \u5b9e\u73b0\n}\n</code></pre>"},{"location":"best-practices/code-standards/#2","title":"2. \u7c7b\u6210\u5458\u987a\u5e8f","text":"<p>\u7c7b\u6210\u5458\u5e94\u6309\u4ee5\u4e0b\u987a\u5e8f\u7ec4\u7ec7\uff1a</p> <pre><code>public class User : Entity&lt;UserId&gt;, IAggregateRoot\n{\n    // 1. \u5e38\u91cf\n    private const int MaxNameLength = 100;\n\n    // 2. \u5b57\u6bb5\n    private readonly List&lt;UserRole&gt; _roles = new();\n\n    // 3. \u6784\u9020\u51fd\u6570\n    protected User() { }\n\n    public User(string name, string email)\n    {\n        // \u5b9e\u73b0\n    }\n\n    // 4. \u5c5e\u6027\n    public string Name { get; private set; } = string.Empty;\n    public string Email { get; private set; } = string.Empty;\n\n    // 5. \u516c\u5171\u65b9\u6cd5\n    public void ChangeEmail(string email)\n    {\n        // \u5b9e\u73b0\n    }\n\n    // 6. \u79c1\u6709\u65b9\u6cd5\n    private void ValidateEmail(string email)\n    {\n        // \u5b9e\u73b0\n    }\n}\n</code></pre>"},{"location":"best-practices/code-standards/#_4","title":"\u4ee3\u7801\u683c\u5f0f","text":""},{"location":"best-practices/code-standards/#1_1","title":"1. \u7f29\u8fdb\u548c\u7a7a\u683c","text":"<ul> <li>\u4f7f\u75284\u4e2a\u7a7a\u683c\u7f29\u8fdb\uff08\u4e0d\u4f7f\u7528Tab\uff09</li> <li>\u5927\u62ec\u53f7\u72ec\u5360\u4e00\u884c\uff08Allman\u98ce\u683c\uff09</li> <li>\u8fd0\u7b97\u7b26\u4e24\u4fa7\u6dfb\u52a0\u7a7a\u683c</li> </ul> <pre><code>// \u2705 \u6b63\u786e\npublic void ProcessOrder(Order order)\n{\n    if (order.Status == OrderStatus.Pending)\n    {\n        order.Confirm();\n    }\n}\n\n// \u274c \u9519\u8bef\npublic void ProcessOrder(Order order){\n    if(order.Status==OrderStatus.Pending){\n        order.Confirm();\n    }\n}\n</code></pre>"},{"location":"best-practices/code-standards/#2_1","title":"2. \u884c\u957f\u5ea6","text":"<ul> <li>\u5efa\u8bae\u6bcf\u884c\u4e0d\u8d85\u8fc7120\u4e2a\u5b57\u7b26</li> <li>\u957f\u8bed\u53e5\u5e94\u8be5\u5408\u7406\u6362\u884c</li> </ul> <pre><code>// \u2705 \u597d\u7684\u6362\u884c\nvar user = await userRepository.GetByEmailAsync(\n    email, \n    cancellationToken) \n    ?? throw new KnownException(\"\u7528\u6237\u4e0d\u5b58\u5728\");\n\n// \u65b9\u6cd5\u53c2\u6570\u6362\u884c\npublic void CreateOrder(\n    string customerName,\n    string shippingAddress,\n    List&lt;OrderItem&gt; items)\n{\n    // \u5b9e\u73b0\n}\n</code></pre>"},{"location":"best-practices/code-standards/#3","title":"3. \u7a7a\u884c\u4f7f\u7528","text":"<ul> <li>\u65b9\u6cd5\u4e4b\u95f4\u6dfb\u52a0\u4e00\u4e2a\u7a7a\u884c</li> <li>\u903b\u8f91\u5757\u4e4b\u95f4\u6dfb\u52a0\u4e00\u4e2a\u7a7a\u884c</li> <li>\u7c7b\u6210\u5458\u7ec4\u4e4b\u95f4\u6dfb\u52a0\u4e00\u4e2a\u7a7a\u884c</li> </ul> <pre><code>public class User : Entity&lt;UserId&gt;, IAggregateRoot\n{\n    // \u5c5e\u6027\u7ec4\n    public string Name { get; private set; } = string.Empty;\n    public string Email { get; private set; } = string.Empty;\n\n    // \u6784\u9020\u51fd\u6570\u7ec4\n    protected User() { }\n\n    public User(string name, string email)\n    {\n        Name = name;\n        Email = email;\n    }\n\n    // \u65b9\u6cd5\u7ec4\n    public void ChangeEmail(string email)\n    {\n        // \u9a8c\u8bc1\u903b\u8f91\n        if (string.IsNullOrWhiteSpace(email))\n        {\n            throw new KnownException(\"\u90ae\u7bb1\u4e0d\u80fd\u4e3a\u7a7a\");\n        }\n\n        // \u4e1a\u52a1\u903b\u8f91\n        Email = email;\n        this.AddDomainEvent(new UserEmailChangedDomainEvent(this));\n    }\n}\n</code></pre>"},{"location":"best-practices/code-standards/#_5","title":"\u6ce8\u91ca\u89c4\u8303","text":""},{"location":"best-practices/code-standards/#1-xml","title":"1. XML\u6587\u6863\u6ce8\u91ca","text":"<p>\u516c\u5171API\u5e94\u8be5\u6dfb\u52a0XML\u6587\u6863\u6ce8\u91ca\uff1a</p> <pre><code>/// &lt;summary&gt;\n/// \u6839\u636e\u90ae\u7bb1\u83b7\u53d6\u7528\u6237\n/// &lt;/summary&gt;\n/// &lt;param name=\"email\"&gt;\u90ae\u7bb1\u5730\u5740&lt;/param&gt;\n/// &lt;param name=\"cancellationToken\"&gt;\u53d6\u6d88\u4ee4\u724c&lt;/param&gt;\n/// &lt;returns&gt;\u7528\u6237\u5b9e\u4f53\uff0c\u5982\u679c\u4e0d\u5b58\u5728\u5219\u8fd4\u56denull&lt;/returns&gt;\n/// &lt;exception cref=\"ArgumentNullException\"&gt;\u5f53\u90ae\u7bb1\u4e3anull\u65f6\u629b\u51fa&lt;/exception&gt;\npublic async Task&lt;User?&gt; GetByEmailAsync(\n    string email, \n    CancellationToken cancellationToken = default)\n{\n    // \u5b9e\u73b0\n}\n</code></pre>"},{"location":"best-practices/code-standards/#2_2","title":"2. \u4ee3\u7801\u6ce8\u91ca","text":"<ul> <li>\u6ce8\u91ca\u5e94\u8be5\u89e3\u91ca\"\u4e3a\u4ec0\u4e48\"\u800c\u4e0d\u662f\"\u662f\u4ec0\u4e48\"</li> <li>\u907f\u514d\u5197\u4f59\u6ce8\u91ca</li> <li>\u590d\u6742\u903b\u8f91\u9700\u8981\u6dfb\u52a0\u6ce8\u91ca</li> </ul> <pre><code>// \u2705 \u597d\u7684\u6ce8\u91ca\n// \u9700\u8981\u5ef6\u8fdf1ms\u786e\u4fdd\u65f6\u95f4\u6233\u4e0d\u540c\nThread.Sleep(1);\n\n// \u4f7f\u7528\u4e50\u89c2\u5e76\u53d1\u63a7\u5236\u9632\u6b62\u5e76\u53d1\u51b2\u7a81\npublic RowVersion RowVersion { get; private set; }\n\n// \u274c \u4e0d\u597d\u7684\u6ce8\u91ca\n// \u8bbe\u7f6e\u7528\u6237\u540d\nuser.Name = name;\n\n// \u8c03\u7528\u4fdd\u5b58\u65b9\u6cd5\nawait repository.SaveAsync(user);\n</code></pre>"},{"location":"best-practices/code-standards/#3-todo","title":"3. TODO\u6ce8\u91ca","text":"<p>\u4f7f\u7528\u6807\u51c6\u683c\u5f0f\u7684TODO\u6ce8\u91ca\uff1a</p> <pre><code>// TODO: \u5b9e\u73b0\u90ae\u4ef6\u53d1\u9001\u529f\u80fd\n// TODO(\u5f20\u4e09): \u9700\u8981\u4f18\u5316\u67e5\u8be2\u6027\u80fd\n// FIXME: \u4fee\u590d\u5e76\u53d1\u95ee\u9898\n// HACK: \u4e34\u65f6\u89e3\u51b3\u65b9\u6848\uff0c\u9700\u8981\u91cd\u6784\n</code></pre>"},{"location":"best-practices/code-standards/#_6","title":"\u547d\u540d\u89c4\u8303\u7b80\u8981","text":"<p>\u8be6\u7ec6\u547d\u540d\u89c4\u8303\u8bf7\u53c2\u8003\u547d\u540d\u89c4\u8303\u6587\u6863\u3002</p>"},{"location":"best-practices/code-standards/#_7","title":"\u5173\u952e\u8981\u70b9","text":"<ul> <li>\u7c7b\u3001\u65b9\u6cd5\u3001\u5c5e\u6027\u4f7f\u7528PascalCase</li> <li>\u5c40\u90e8\u53d8\u91cf\u3001\u53c2\u6570\u4f7f\u7528camelCase</li> <li>\u79c1\u6709\u5b57\u6bb5\u4f7f\u7528_camelCase</li> <li>\u63a5\u53e3\u4f7f\u7528I\u524d\u7f00</li> <li>\u5f02\u6b65\u65b9\u6cd5\u4f7f\u7528Async\u540e\u7f00</li> </ul>"},{"location":"best-practices/code-standards/#solid","title":"SOLID\u539f\u5219","text":""},{"location":"best-practices/code-standards/#1-srp","title":"1. \u5355\u4e00\u804c\u8d23\u539f\u5219 (SRP)","text":"<p>\u6bcf\u4e2a\u7c7b\u5e94\u8be5\u53ea\u6709\u4e00\u4e2a\u804c\u8d23\uff1a</p> <pre><code>// \u2705 \u597d\u7684\u8bbe\u8ba1 - \u804c\u8d23\u5355\u4e00\npublic class User : Entity&lt;UserId&gt;, IAggregateRoot\n{\n    // \u53ea\u8d1f\u8d23\u7528\u6237\u76f8\u5173\u7684\u4e1a\u52a1\u903b\u8f91\n}\n\npublic class UserRepository : IUserRepository\n{\n    // \u53ea\u8d1f\u8d23\u7528\u6237\u7684\u6570\u636e\u8bbf\u95ee\n}\n\npublic class CreateUserCommandHandler : ICommandHandler&lt;CreateUserCommand, UserId&gt;\n{\n    // \u53ea\u8d1f\u8d23\u5904\u7406\u521b\u5efa\u7528\u6237\u547d\u4ee4\n}\n\n// \u274c \u4e0d\u597d\u7684\u8bbe\u8ba1 - \u804c\u8d23\u6df7\u4e71\npublic class UserService\n{\n    // \u65e2\u5904\u7406\u4e1a\u52a1\u903b\u8f91\uff0c\u53c8\u5904\u7406\u6570\u636e\u8bbf\u95ee\uff0c\u8fd8\u53d1\u9001\u90ae\u4ef6\n}\n</code></pre>"},{"location":"best-practices/code-standards/#2-ocp","title":"2. \u5f00\u95ed\u539f\u5219 (OCP)","text":"<p>\u5bf9\u6269\u5c55\u5f00\u653e\uff0c\u5bf9\u4fee\u6539\u5173\u95ed\uff1a</p> <pre><code>// \u2705 \u597d\u7684\u8bbe\u8ba1 - \u901a\u8fc7\u6269\u5c55\u6dfb\u52a0\u65b0\u529f\u80fd\npublic interface INotificationService\n{\n    Task SendAsync(string message);\n}\n\npublic class EmailNotificationService : INotificationService { }\npublic class SmsNotificationService : INotificationService { }\npublic class WeChatNotificationService : INotificationService { }\n</code></pre>"},{"location":"best-practices/code-standards/#3-lsp","title":"3. \u91cc\u6c0f\u66ff\u6362\u539f\u5219 (LSP)","text":"<p>\u5b50\u7c7b\u5e94\u8be5\u80fd\u591f\u66ff\u6362\u7236\u7c7b\uff1a</p> <pre><code>// \u2705 \u6b63\u786e\u5b9e\u73b0\npublic abstract class Entity&lt;TId&gt;\n{\n    public TId Id { get; protected set; }\n}\n\npublic class User : Entity&lt;UserId&gt;\n{\n    // \u53ef\u4ee5\u5b89\u5168\u5730\u66ff\u6362Entity&lt;UserId&gt;\n}\n</code></pre>"},{"location":"best-practices/code-standards/#4-isp","title":"4. \u63a5\u53e3\u9694\u79bb\u539f\u5219 (ISP)","text":"<p>\u4e0d\u5e94\u8be5\u5f3a\u8feb\u5ba2\u6237\u7aef\u4f9d\u8d56\u5b83\u4e0d\u4f7f\u7528\u7684\u65b9\u6cd5\uff1a</p> <pre><code>// \u2705 \u597d\u7684\u8bbe\u8ba1 - \u63a5\u53e3\u7ec6\u5206\npublic interface IRepository&lt;TEntity, TKey&gt;\n{\n    Task&lt;TEntity?&gt; GetAsync(TKey id);\n    Task&lt;TEntity&gt; AddAsync(TEntity entity);\n}\n\npublic interface IUserRepository : IRepository&lt;User, UserId&gt;\n{\n    Task&lt;User?&gt; GetByEmailAsync(string email);\n}\n\n// \u274c \u4e0d\u597d\u7684\u8bbe\u8ba1 - \u81c3\u80bf\u7684\u63a5\u53e3\npublic interface IRepository\n{\n    Task&lt;T?&gt; GetAsync&lt;T&gt;(int id);\n    Task&lt;T?&gt; GetByEmailAsync&lt;T&gt;(string email);\n    Task&lt;List&lt;T&gt;&gt; GetAllAsync&lt;T&gt;();\n    // ... \u66f4\u591a\u4e0d\u662f\u6240\u6709\u4ed3\u50a8\u90fd\u9700\u8981\u7684\u65b9\u6cd5\n}\n</code></pre>"},{"location":"best-practices/code-standards/#5-dip","title":"5. \u4f9d\u8d56\u5012\u7f6e\u539f\u5219 (DIP)","text":"<p>\u9ad8\u5c42\u6a21\u5757\u4e0d\u5e94\u8be5\u4f9d\u8d56\u4f4e\u5c42\u6a21\u5757\uff0c\u90fd\u5e94\u8be5\u4f9d\u8d56\u62bd\u8c61\uff1a</p> <pre><code>// \u2705 \u597d\u7684\u8bbe\u8ba1 - \u4f9d\u8d56\u62bd\u8c61\npublic class CreateUserCommandHandler(IUserRepository userRepository)\n    : ICommandHandler&lt;CreateUserCommand, UserId&gt;\n{\n    // \u4f9d\u8d56IUserRepository\u63a5\u53e3\uff0c\u800c\u4e0d\u662f\u5177\u4f53\u5b9e\u73b0\n}\n\n// \u274c \u4e0d\u597d\u7684\u8bbe\u8ba1 - \u4f9d\u8d56\u5177\u4f53\u5b9e\u73b0\npublic class CreateUserCommandHandler(UserRepository userRepository)\n{\n    // \u76f4\u63a5\u4f9d\u8d56\u5177\u4f53\u5b9e\u73b0\n}\n</code></pre>"},{"location":"best-practices/code-standards/#ddd","title":"DDD\u6700\u4f73\u5b9e\u8df5","text":""},{"location":"best-practices/code-standards/#1_2","title":"1. \u805a\u5408\u8fb9\u754c","text":"<p>\u4fdd\u6301\u805a\u5408\u8fb9\u754c\u5c0f\u800c\u6e05\u6670\uff1a</p> <pre><code>// \u2705 \u597d\u7684\u805a\u5408 - \u8fb9\u754c\u6e05\u6670\npublic class Order : Entity&lt;OrderId&gt;, IAggregateRoot\n{\n    private readonly List&lt;OrderItem&gt; _orderItems = new();\n\n    public IReadOnlyCollection&lt;OrderItem&gt; OrderItems =&gt; _orderItems.AsReadOnly();\n\n    public void AddItem(string productName, decimal price, int quantity)\n    {\n        var item = new OrderItem(productName, price, quantity);\n        _orderItems.Add(item);\n    }\n}\n\n// \u274c \u4e0d\u597d\u7684\u805a\u5408 - \u8fb9\u754c\u6a21\u7cca\npublic class Order : Entity&lt;OrderId&gt;, IAggregateRoot\n{\n    public Customer Customer { get; set; } // \u4e0d\u5e94\u8be5\u5305\u542b\u5176\u4ed6\u805a\u5408\u6839\n    public List&lt;Product&gt; Products { get; set; } // \u4e0d\u5e94\u8be5\u5305\u542b\u5176\u4ed6\u805a\u5408\u6839\n}\n</code></pre>"},{"location":"best-practices/code-standards/#2_3","title":"2. \u4e0d\u53d8\u6027\u4fdd\u62a4","text":"<p>\u4f7f\u7528private set\u4fdd\u62a4\u4e0d\u53d8\u6027\uff1a</p> <pre><code>// \u2705 \u6b63\u786e\npublic class User : Entity&lt;UserId&gt;, IAggregateRoot\n{\n    public string Name { get; private set; } = string.Empty;\n\n    public void ChangeName(string name)\n    {\n        if (string.IsNullOrWhiteSpace(name))\n        {\n            throw new KnownException(\"\u540d\u79f0\u4e0d\u80fd\u4e3a\u7a7a\");\n        }\n\n        Name = name;\n        this.AddDomainEvent(new UserNameChangedDomainEvent(this));\n    }\n}\n\n// \u274c \u9519\u8bef - \u5141\u8bb8\u76f4\u63a5\u4fee\u6539\npublic class User : Entity&lt;UserId&gt;, IAggregateRoot\n{\n    public string Name { get; set; } = string.Empty;\n}\n</code></pre>"},{"location":"best-practices/code-standards/#3_1","title":"3. \u9886\u57df\u4e8b\u4ef6\u53d1\u5e03","text":"<p>\u5728\u72b6\u6001\u53d8\u66f4\u65f6\u53d1\u5e03\u9886\u57df\u4e8b\u4ef6\uff1a</p> <pre><code>public void ChangeEmail(string email)\n{\n    // 1. \u9a8c\u8bc1\n    if (string.IsNullOrWhiteSpace(email))\n    {\n        throw new KnownException(\"\u90ae\u7bb1\u4e0d\u80fd\u4e3a\u7a7a\");\n    }\n\n    // 2. \u72b6\u6001\u53d8\u66f4\n    Email = email;\n\n    // 3. \u53d1\u5e03\u4e8b\u4ef6\n    this.AddDomainEvent(new UserEmailChangedDomainEvent(this));\n}\n</code></pre>"},{"location":"best-practices/code-standards/#_8","title":"\u5f02\u5e38\u5904\u7406","text":""},{"location":"best-practices/code-standards/#1-knownexception","title":"1. \u4f7f\u7528KnownException\u5904\u7406\u4e1a\u52a1\u5f02\u5e38","text":"<pre><code>// \u2705 \u6b63\u786e\nif (order.Status != OrderStatus.Pending)\n{\n    throw new KnownException(\"\u53ea\u6709\u5f85\u5904\u7406\u7684\u8ba2\u5355\u53ef\u4ee5\u88ab\u786e\u8ba4\");\n}\n\n// \u274c \u9519\u8bef\nif (order.Status != OrderStatus.Pending)\n{\n    throw new Exception(\"\u53ea\u6709\u5f85\u5904\u7406\u7684\u8ba2\u5355\u53ef\u4ee5\u88ab\u786e\u8ba4\");\n}\n</code></pre>"},{"location":"best-practices/code-standards/#2_4","title":"2. \u63d0\u4f9b\u6e05\u6670\u7684\u5f02\u5e38\u6d88\u606f","text":"<pre><code>// \u2705 \u597d\u7684\u5f02\u5e38\u6d88\u606f\nthrow new KnownException($\"\u672a\u627e\u5230\u7528\u6237\uff0cUserId = {userId}\");\nthrow new KnownException(\"\u90ae\u7bb1\u5df2\u88ab\u4f7f\u7528\");\nthrow new KnownException(\"\u8ba2\u5355\u91d1\u989d\u4e0d\u80fd\u4e3a\u8d1f\u6570\");\n\n// \u274c \u4e0d\u597d\u7684\u5f02\u5e38\u6d88\u606f\nthrow new KnownException(\"\u9519\u8bef\");\nthrow new KnownException(\"\u5931\u8d25\");\n</code></pre>"},{"location":"best-practices/code-standards/#3_2","title":"3. \u4e0d\u8981\u6355\u83b7\u5e76\u5ffd\u7565\u5f02\u5e38","text":"<pre><code>// \u274c \u9519\u8bef - \u541e\u6389\u5f02\u5e38\ntry\n{\n    await SendEmailAsync(email);\n}\ncatch\n{\n    // \u4ec0\u4e48\u90fd\u4e0d\u505a\n}\n\n// \u2705 \u6b63\u786e - \u8bb0\u5f55\u5f02\u5e38\u6216\u91cd\u65b0\u629b\u51fa\ntry\n{\n    await SendEmailAsync(email);\n}\ncatch (Exception ex)\n{\n    _logger.LogError(ex, \"\u53d1\u9001\u90ae\u4ef6\u5931\u8d25\");\n    throw;\n}\n</code></pre>"},{"location":"best-practices/code-standards/#_9","title":"\u5f02\u6b65\u7f16\u7a0b","text":""},{"location":"best-practices/code-standards/#1_3","title":"1. \u59cb\u7ec8\u4f7f\u7528\u5f02\u6b65\u65b9\u6cd5","text":"<pre><code>// \u2705 \u6b63\u786e\npublic async Task&lt;User?&gt; GetUserAsync(UserId userId)\n{\n    return await _context.Users.FindAsync(userId);\n}\n\n// \u274c \u9519\u8bef - \u963b\u585e\u8c03\u7528\npublic User? GetUser(UserId userId)\n{\n    return _context.Users.Find(userId);\n}\n</code></pre>"},{"location":"best-practices/code-standards/#2-cancellationtoken","title":"2. \u4f20\u9012CancellationToken","text":"<pre><code>// \u2705 \u6b63\u786e\npublic async Task&lt;User?&gt; GetAsync(\n    UserId userId, \n    CancellationToken cancellationToken = default)\n{\n    return await _context.Users\n        .FindAsync(new object[] { userId }, cancellationToken);\n}\n\n// \u274c \u9519\u8bef - \u6ca1\u6709\u4f20\u9012\u53d6\u6d88\u4ee4\u724c\npublic async Task&lt;User?&gt; GetAsync(UserId userId)\n{\n    return await _context.Users.FindAsync(userId);\n}\n</code></pre>"},{"location":"best-practices/code-standards/#3-async-void","title":"3. \u907f\u514dasync void","text":"<pre><code>// \u2705 \u6b63\u786e\npublic async Task ProcessAsync()\n{\n    await DoSomethingAsync();\n}\n\n// \u274c \u9519\u8bef - \u9664\u4e86\u4e8b\u4ef6\u5904\u7406\u5668\npublic async void ProcessAsync()\n{\n    await DoSomethingAsync();\n}\n</code></pre>"},{"location":"best-practices/code-standards/#linq","title":"LINQ\u4f7f\u7528","text":""},{"location":"best-practices/code-standards/#1_4","title":"1. \u4f7f\u7528\u65b9\u6cd5\u8bed\u6cd5","text":"<pre><code>// \u2705 \u63a8\u8350 - \u65b9\u6cd5\u8bed\u6cd5\nvar users = await _context.Users\n    .Where(u =&gt; u.IsActive)\n    .OrderBy(u =&gt; u.Name)\n    .ToListAsync();\n\n// \u4e5f\u53ef\u4ee5 - \u67e5\u8be2\u8bed\u6cd5\uff08\u590d\u6742\u67e5\u8be2\u65f6\uff09\nvar users = await (\n    from u in _context.Users\n    where u.IsActive\n    orderby u.Name\n    select u\n).ToListAsync();\n</code></pre>"},{"location":"best-practices/code-standards/#2_5","title":"2. \u4f7f\u7528\u6295\u5f71\u4f18\u5316\u6027\u80fd","text":"<pre><code>// \u2705 \u597d - \u4f7f\u7528\u6295\u5f71\nvar userDtos = await _context.Users\n    .Select(u =&gt; new UserDto(u.Id, u.Name, u.Email))\n    .ToListAsync();\n\n// \u274c \u4e0d\u597d - \u67e5\u8be2\u5b8c\u6574\u5b9e\u4f53\u7136\u540e\u6620\u5c04\nvar users = await _context.Users.ToListAsync();\nvar userDtos = users.Select(u =&gt; new UserDto(u.Id, u.Name, u.Email));\n</code></pre>"},{"location":"best-practices/code-standards/#_10","title":"\u8d44\u6e90\u7ba1\u7406","text":""},{"location":"best-practices/code-standards/#1-using","title":"1. \u4f7f\u7528using\u8bed\u53e5","text":"<pre><code>// \u2705 \u6b63\u786e\nusing var connection = new SqlConnection(connectionString);\nawait connection.OpenAsync();\n\n// \u2705 \u4e5f\u6b63\u786e\nusing (var connection = new SqlConnection(connectionString))\n{\n    await connection.OpenAsync();\n}\n</code></pre>"},{"location":"best-practices/code-standards/#2_6","title":"2. \u4f9d\u8d56\u6ce8\u5165\u751f\u547d\u5468\u671f","text":"<p>\u6b63\u786e\u9009\u62e9\u670d\u52a1\u751f\u547d\u5468\u671f\uff1a</p> <ul> <li>Singleton: \u65e0\u72b6\u6001\u670d\u52a1</li> <li>Scoped: DbContext\u3001\u4ed3\u50a8</li> <li>Transient: \u8f7b\u91cf\u7ea7\u65e0\u72b6\u6001\u670d\u52a1</li> </ul> <pre><code>// Program.cs\nbuilder.Services.AddSingleton&lt;ICacheService, CacheService&gt;();\nbuilder.Services.AddScoped&lt;IUserRepository, UserRepository&gt;();\nbuilder.Services.AddTransient&lt;IEmailService, EmailService&gt;();\n</code></pre>"},{"location":"best-practices/code-standards/#_11","title":"\u6027\u80fd\u6700\u4f73\u5b9e\u8df5","text":""},{"location":"best-practices/code-standards/#1-n1","title":"1. \u907f\u514dN+1\u67e5\u8be2","text":"<pre><code>// \u2705 \u597d - \u4f7f\u7528Include\nvar orders = await _context.Orders\n    .Include(o =&gt; o.OrderItems)\n    .ToListAsync();\n\n// \u274c \u4e0d\u597d - N+1\u67e5\u8be2\nvar orders = await _context.Orders.ToListAsync();\nforeach (var order in orders)\n{\n    var items = await _context.OrderItems\n        .Where(i =&gt; i.OrderId == order.Id)\n        .ToListAsync();\n}\n</code></pre>"},{"location":"best-practices/code-standards/#2-asnotracking","title":"2. \u4f7f\u7528AsNoTracking","text":"<pre><code>// \u2705 \u67e5\u8be2\u4e0d\u9700\u8981\u8ddf\u8e2a\nvar users = await _context.Users\n    .AsNoTracking()\n    .ToListAsync();\n</code></pre>"},{"location":"best-practices/code-standards/#3_3","title":"3. \u6279\u91cf\u64cd\u4f5c","text":"<pre><code>// \u2705 \u597d - \u6279\u91cf\u6dfb\u52a0\nawait _context.Users.AddRangeAsync(users);\nawait _context.SaveChangesAsync();\n\n// \u274c \u4e0d\u597d - \u9010\u4e2a\u6dfb\u52a0\nforeach (var user in users)\n{\n    await _context.Users.AddAsync(user);\n    await _context.SaveChangesAsync();\n}\n</code></pre>"},{"location":"best-practices/code-standards/#_12","title":"\u6d4b\u8bd5\u7f16\u5199","text":""},{"location":"best-practices/code-standards/#1-aaa","title":"1. \u9075\u5faaAAA\u6a21\u5f0f","text":"<pre><code>[Fact]\npublic void User_Constructor_ShouldCreateValidUser()\n{\n    // Arrange - \u51c6\u5907\n    var name = \"\u5f20\u4e09\";\n    var email = \"test@example.com\";\n\n    // Act - \u6267\u884c\n    var user = new User(name, email);\n\n    // Assert - \u65ad\u8a00\n    Assert.Equal(name, user.Name);\n    Assert.Equal(email, user.Email);\n}\n</code></pre>"},{"location":"best-practices/code-standards/#2_7","title":"2. \u6e05\u6670\u7684\u6d4b\u8bd5\u547d\u540d","text":"<pre><code>// \u2705 \u597d\u7684\u547d\u540d\n[Fact]\npublic void ChangeEmail_WithValidEmail_ShouldUpdateEmail() { }\n\n[Fact]\npublic void ChangeEmail_WithInvalidEmail_ShouldThrowException() { }\n\n// \u274c \u4e0d\u597d\u7684\u547d\u540d\n[Fact]\npublic void Test1() { }\n\n[Fact]\npublic void TestChangeEmail() { }\n</code></pre>"},{"location":"best-practices/code-standards/#_13","title":"\u5b89\u5168\u6700\u4f73\u5b9e\u8df5","text":""},{"location":"best-practices/code-standards/#1_5","title":"1. \u9a8c\u8bc1\u8f93\u5165","text":"<pre><code>public void ChangeEmail(string email)\n{\n    if (string.IsNullOrWhiteSpace(email))\n    {\n        throw new KnownException(\"\u90ae\u7bb1\u4e0d\u80fd\u4e3a\u7a7a\");\n    }\n\n    if (!IsValidEmail(email))\n    {\n        throw new KnownException(\"\u90ae\u7bb1\u683c\u5f0f\u4e0d\u6b63\u786e\");\n    }\n\n    Email = email;\n}\n</code></pre>"},{"location":"best-practices/code-standards/#2_8","title":"2. \u4e0d\u8981\u5728\u4ee3\u7801\u4e2d\u786c\u7f16\u7801\u654f\u611f\u4fe1\u606f","text":"<pre><code>// \u274c \u9519\u8bef\nvar connectionString = \"Server=localhost;Database=MyDb;User=sa;Password=123456;\";\n\n// \u2705 \u6b63\u786e\nvar connectionString = configuration.GetConnectionString(\"DefaultConnection\");\n</code></pre>"},{"location":"best-practices/code-standards/#3_4","title":"3. \u4f7f\u7528\u53c2\u6570\u5316\u67e5\u8be2","text":"<p>EF Core\u9ed8\u8ba4\u4f7f\u7528\u53c2\u6570\u5316\u67e5\u8be2\uff0c\u907f\u514dSQL\u6ce8\u5165\u3002</p>"},{"location":"best-practices/code-standards/#editorconfig","title":"EditorConfig\u914d\u7f6e","text":"<p>\u9879\u76ee\u5e94\u8be5\u5305\u542b<code>.editorconfig</code>\u6587\u4ef6\uff1a</p> <pre><code># \u9876\u7ea7EditorConfig\u6587\u4ef6\nroot = true\n\n# \u6240\u6709\u6587\u4ef6\n[*]\ncharset = utf-8\nindent_style = space\ninsert_final_newline = true\ntrim_trailing_whitespace = true\n\n# C#\u6587\u4ef6\n[*.cs]\nindent_size = 4\n\n# .NET\u4ee3\u7801\u98ce\u683c\u89c4\u5219\ndotnet_sort_system_directives_first = true\ndotnet_separate_import_directive_groups = false\n\n# C#\u4ee3\u7801\u98ce\u683c\u89c4\u5219\ncsharp_new_line_before_open_brace = all\ncsharp_new_line_before_else = true\ncsharp_new_line_before_catch = true\ncsharp_new_line_before_finally = true\n</code></pre>"},{"location":"best-practices/code-standards/#_14","title":"\u4ee3\u7801\u5ba1\u67e5\u68c0\u67e5\u6e05\u5355","text":"<p>\u5728\u63d0\u4ea4\u4ee3\u7801\u524d\uff0c\u68c0\u67e5\uff1a</p> <ul> <li>[ ] \u662f\u5426\u9075\u5faa\u547d\u540d\u89c4\u8303\uff1f</li> <li>[ ] \u662f\u5426\u9075\u5faa\u4ee3\u7801\u683c\u5f0f\u89c4\u8303\uff1f</li> <li>[ ] \u662f\u5426\u6709\u9002\u5f53\u7684\u6ce8\u91ca\uff1f</li> <li>[ ] \u662f\u5426\u6709\u5355\u5143\u6d4b\u8bd5\uff1f</li> <li>[ ] \u662f\u5426\u5904\u7406\u4e86\u5f02\u5e38\u60c5\u51b5\uff1f</li> <li>[ ] \u662f\u5426\u6709\u6027\u80fd\u95ee\u9898\uff1f</li> <li>[ ] \u662f\u5426\u6709\u5b89\u5168\u95ee\u9898\uff1f</li> <li>[ ] \u662f\u5426\u9075\u5faaSOLID\u539f\u5219\uff1f</li> <li>[ ] \u662f\u5426\u7b26\u5408DDD\u8bbe\u8ba1\u539f\u5219\uff1f</li> </ul>"},{"location":"best-practices/code-standards/#_15","title":"\u5de5\u5177\u63a8\u8350","text":"<ul> <li>StyleCop: \u4ee3\u7801\u98ce\u683c\u68c0\u67e5</li> <li>SonarLint: \u4ee3\u7801\u8d28\u91cf\u68c0\u67e5</li> <li>ReSharper: \u4ee3\u7801\u5206\u6790\u548c\u91cd\u6784</li> <li>CodeMaid: \u4ee3\u7801\u6e05\u7406</li> </ul>"},{"location":"best-practices/code-standards/#_16","title":"\u76f8\u5173\u6587\u6863","text":"<ul> <li>\u547d\u540d\u89c4\u8303</li> <li>\u9879\u76ee\u7ed3\u6784</li> <li>\u6d4b\u8bd5\u7b56\u7565</li> <li>\u5f00\u53d1\u5de5\u5177\u63a8\u8350</li> </ul>"},{"location":"best-practices/naming-conventions/","title":"\u547d\u540d\u89c4\u8303","text":""},{"location":"best-practices/naming-conventions/#_2","title":"\u4e3a\u4ec0\u4e48\u9700\u8981\u547d\u540d\u89c4\u8303\uff1f","text":"<p>\u7edf\u4e00\u7684\u547d\u540d\u89c4\u8303\u53ef\u4ee5\u63d0\u9ad8\u4ee3\u7801\u7684\u53ef\u8bfb\u6027\u548c\u53ef\u7ef4\u62a4\u6027\uff0c\u4f7f\u56e2\u961f\u6210\u5458\u66f4\u5bb9\u6613\u7406\u89e3\u4ee3\u7801\u610f\u56fe\u3002\u672c\u6587\u6863\u5b9a\u4e49\u4e86\u5728DDD\u548cClean Architecture\u9879\u76ee\u4e2d\u7684\u547d\u540d\u7ea6\u5b9a\u3002</p>"},{"location":"best-practices/naming-conventions/#_3","title":"\u901a\u7528\u547d\u540d\u6709\u54ea\u4e9b\u539f\u5219\uff1f","text":""},{"location":"best-practices/naming-conventions/#1","title":"1. \u5982\u4f55\u4f7f\u7528\u6709\u610f\u4e49\u7684\u540d\u79f0\uff1f","text":"<ul> <li>\u540d\u79f0\u5e94\u8be5\u6e05\u695a\u5730\u8868\u8fbe\u5176\u7528\u9014</li> <li>\u907f\u514d\u4f7f\u7528\u7f29\u5199\uff08\u9664\u975e\u662f\u5e7f\u4e3a\u4eba\u77e5\u7684\uff09</li> <li>\u907f\u514d\u4f7f\u7528\u5355\u5b57\u6bcd\u53d8\u91cf\u540d\uff08\u9664\u4e86\u5faa\u73af\u8ba1\u6570\u5668\uff09</li> </ul> <pre><code>// \u2705 \u597d\u7684\u547d\u540d\npublic class UserService { }\npublic string GetUserFullName() { }\nprivate decimal CalculateTotalPrice() { }\n\n// \u274c \u4e0d\u597d\u7684\u547d\u540d\npublic class UsrSrv { }\npublic string GetName() { }\nprivate decimal Calc() { }\n</code></pre>"},{"location":"best-practices/naming-conventions/#2","title":"2. \u5982\u4f55\u4fdd\u6301\u8bcd\u6c47\u4e00\u81f4\u6027\uff1f","text":"<p>\u5728\u6574\u4e2a\u9879\u76ee\u4e2d\u4f7f\u7528\u76f8\u540c\u7684\u8bcd\u6c47\u8868\u8fbe\u76f8\u540c\u7684\u6982\u5ff5\uff1a</p> <ul> <li>\u5982\u679c\u4f7f\u7528\"Customer\"\uff0c\u5c31\u4e0d\u8981\u5728\u5176\u4ed6\u5730\u65b9\u4f7f\u7528\"Client\"</li> <li>\u5982\u679c\u4f7f\u7528\"Order\"\uff0c\u5c31\u4e0d\u8981\u5728\u5176\u4ed6\u5730\u65b9\u4f7f\u7528\"Purchase\"</li> <li>\u9075\u5faaUbiquitous Language\uff08\u7edf\u4e00\u8bed\u8a00\uff09</li> </ul>"},{"location":"best-practices/naming-conventions/#3","title":"3. \u4e3a\u4ec0\u4e48\u8981\u907f\u514d\u566a\u97f3\u8bcd\uff1f","text":"<p>\u907f\u514d\u4f7f\u7528\u6ca1\u6709\u5b9e\u9645\u610f\u4e49\u7684\u8bcd\u6c47\uff1a</p> <pre><code>// \u274c \u907f\u514d\u4f7f\u7528\nUserData, UserInfo, UserManager, UserHelper\n\n// \u2705 \u66f4\u597d\u7684\u9009\u62e9\nUser, UserService, UserValidator\n</code></pre>"},{"location":"best-practices/naming-conventions/#c","title":"C#\u4e2d\u5982\u4f55\u547d\u540d\uff1f","text":""},{"location":"best-practices/naming-conventions/#pascal","title":"\u4ec0\u4e48\u65f6\u5019\u4f7f\u7528Pascal\u547d\u540d\u6cd5\uff1f","text":"<p>\u7528\u4e8e\uff1a - \u7c7b\u540d - \u63a5\u53e3\u540d - \u679a\u4e3e\u540d - \u65b9\u6cd5\u540d - \u5c5e\u6027\u540d - \u4e8b\u4ef6\u540d - \u547d\u540d\u7a7a\u95f4</p> <pre><code>public class UserService { }\npublic interface IUserRepository { }\npublic enum OrderStatus { }\npublic void CalculateTotalPrice() { }\npublic string UserName { get; set; }\npublic event EventHandler UserCreated;\nnamespace MyProject.Domain.AggregatesModel { }\n</code></pre>"},{"location":"best-practices/naming-conventions/#camel","title":"\u4ec0\u4e48\u65f6\u5019\u4f7f\u7528Camel\u547d\u540d\u6cd5\uff1f","text":"<p>\u7528\u4e8e\uff1a - \u5c40\u90e8\u53d8\u91cf - \u65b9\u6cd5\u53c2\u6570 - \u79c1\u6709\u5b57\u6bb5\uff08\u5e26\u4e0b\u5212\u7ebf\u524d\u7f00\uff09</p> <pre><code>public void ProcessOrder(string customerName, decimal totalAmount)\n{\n    var orderDate = DateTime.Now;\n    var isValid = ValidateOrder(customerName);\n}\n\nprivate readonly IUserRepository _userRepository;\n</code></pre>"},{"location":"best-practices/naming-conventions/#_4","title":"\u5982\u4f55\u547d\u540d\u9879\u76ee\u548c\u547d\u540d\u7a7a\u95f4\uff1f","text":""},{"location":"best-practices/naming-conventions/#_5","title":"\u9879\u76ee\u5982\u4f55\u547d\u540d\uff1f","text":"<p>\u683c\u5f0f\uff1a<code>{CompanyName}.{ProjectName}.{Layer}</code></p> <pre><code>MyCompany.OrderSystem.Domain\nMyCompany.OrderSystem.Infrastructure\nMyCompany.OrderSystem.Web\n</code></pre>"},{"location":"best-practices/naming-conventions/#_6","title":"\u547d\u540d\u7a7a\u95f4\u5982\u4f55\u547d\u540d\uff1f","text":"<p>\u9075\u5faa\u9879\u76ee\u7ed3\u6784\uff1a</p> <pre><code>namespace MyProject.Domain.AggregatesModel.UserAggregate;\nnamespace MyProject.Domain.DomainEvents;\nnamespace MyProject.Infrastructure.Repositories;\nnamespace MyProject.Web.Application.Commands.User;\nnamespace MyProject.Web.Application.Queries.Order;\nnamespace MyProject.Web.Endpoints.User;\n</code></pre>"},{"location":"best-practices/naming-conventions/#ddd","title":"DDD\u4e2d\u5982\u4f55\u547d\u540d\uff1f","text":""},{"location":"best-practices/naming-conventions/#_7","title":"\u805a\u5408\u6839\u5982\u4f55\u547d\u540d\uff1f","text":"<ul> <li>\u4f7f\u7528\u9886\u57df\u4e2d\u7684\u540d\u8bcd</li> <li>\u4e0d\u9700\u8981\u6dfb\u52a0\"Aggregate\"\u540e\u7f00</li> <li>\u4e0e\u6587\u4ef6\u540d\u4e00\u81f4</li> </ul> <pre><code>// \u2705 \u597d\u7684\u547d\u540d\npublic class User : Entity&lt;UserId&gt;, IAggregateRoot { }\npublic class Order : Entity&lt;OrderId&gt;, IAggregateRoot { }\npublic class Product : Entity&lt;ProductId&gt;, IAggregateRoot { }\n\n// \u274c \u4e0d\u597d\u7684\u547d\u540d\npublic class UserAggregate : Entity&lt;UserId&gt;, IAggregateRoot { }\npublic class OrderRoot : Entity&lt;OrderId&gt;, IAggregateRoot { }\n</code></pre>"},{"location":"best-practices/naming-conventions/#id","title":"\u5f3a\u7c7b\u578bID\u5982\u4f55\u547d\u540d\uff1f","text":"<p>\u683c\u5f0f\uff1a<code>{EntityName}Id</code></p> <pre><code>public partial record UserId : IGuidStronglyTypedId;\npublic partial record OrderId : IGuidStronglyTypedId;\npublic partial record ProductId : IGuidStronglyTypedId;\n</code></pre>"},{"location":"best-practices/naming-conventions/#_8","title":"\u5b9e\u4f53","text":"<ul> <li>\u4f7f\u7528\u9886\u57df\u4e2d\u7684\u540d\u8bcd</li> <li>\u5b50\u5b9e\u4f53\u5e94\u8be5\u53cd\u6620\u5176\u5728\u805a\u5408\u4e2d\u7684\u89d2\u8272</li> </ul> <pre><code>public class OrderItem : Entity&lt;OrderItemId&gt;, IEntity { }\npublic class Address : Entity&lt;AddressId&gt;, IEntity { }\npublic class ContactInfo : Entity&lt;ContactInfoId&gt;, IEntity { }\n</code></pre>"},{"location":"best-practices/naming-conventions/#_9","title":"\u503c\u5bf9\u8c61\u5982\u4f55\u547d\u540d\uff1f","text":"<ul> <li>\u4f7f\u7528\u63cf\u8ff0\u6027\u540d\u8bcd</li> <li>\u901a\u5e38\u4e0d\u9700\u8981\"ValueObject\"\u540e\u7f00</li> </ul> <pre><code>public record Money(decimal Amount, string Currency);\npublic record Address(string Street, string City, string Country);\npublic record DateRange(DateTimeOffset Start, DateTimeOffset End);\n</code></pre>"},{"location":"best-practices/naming-conventions/#_10","title":"\u9886\u57df\u4e8b\u4ef6","text":"<p>\u683c\u5f0f\uff1a<code>{Entity}{Action}DomainEvent</code></p> <p>\u4f7f\u7528\u8fc7\u53bb\u5f0f\u52a8\u8bcd\uff1a</p> <pre><code>// \u2705 \u597d\u7684\u547d\u540d\npublic record UserCreatedDomainEvent(User User) : IDomainEvent;\npublic record OrderPaidDomainEvent(Order Order) : IDomainEvent;\npublic record ProductPublishedDomainEvent(Product Product) : IDomainEvent;\n\n// \u274c \u4e0d\u597d\u7684\u547d\u540d\npublic record CreateUserEvent(User User) : IDomainEvent;\npublic record PayingOrderEvent(Order Order) : IDomainEvent;\n</code></pre>"},{"location":"best-practices/naming-conventions/#_11","title":"\u9886\u57df\u670d\u52a1\u5982\u4f55\u547d\u540d\uff1f","text":"<p>\u683c\u5f0f\uff1a<code>{Domain}{Action}Service</code> \u6216 <code>{Domain}Service</code></p> <pre><code>public class PricingService { }\npublic class ShippingCalculationService { }\npublic class InventoryService { }\n</code></pre>"},{"location":"best-practices/naming-conventions/#cqrs","title":"CQRS\u4e2d\u5982\u4f55\u547d\u540d\uff1f","text":""},{"location":"best-practices/naming-conventions/#_12","title":"\u547d\u4ee4\u5982\u4f55\u547d\u540d\uff1f","text":"<p>\u683c\u5f0f\uff1a<code>{Action}{Entity}Command</code></p> <p>\u4f7f\u7528\u52a8\u8bcd\u539f\u5f62\uff1a</p> <pre><code>// \u2705 \u597d\u7684\u547d\u540d\npublic record CreateUserCommand(string Name, string Email) : ICommand&lt;UserId&gt;;\npublic record UpdateUserEmailCommand(UserId UserId, string Email) : ICommand;\npublic record DeleteUserCommand(UserId UserId) : ICommand;\npublic record PayOrderCommand(OrderId OrderId, decimal Amount) : ICommand;\n\n// \u274c \u4e0d\u597d\u7684\u547d\u540d\npublic record UserCreateCommand(...) : ICommand&lt;UserId&gt;;\npublic record CreatingUserCommand(...) : ICommand&lt;UserId&gt;;\n</code></pre>"},{"location":"best-practices/naming-conventions/#_13","title":"\u547d\u4ee4\u5904\u7406\u5668\u5982\u4f55\u547d\u540d\uff1f","text":"<p>\u683c\u5f0f\uff1a<code>{CommandName}Handler</code></p> <pre><code>public class CreateUserCommandHandler : ICommandHandler&lt;CreateUserCommand, UserId&gt; { }\npublic class UpdateUserEmailCommandHandler : ICommandHandler&lt;UpdateUserEmailCommand&gt; { }\n</code></pre>"},{"location":"best-practices/naming-conventions/#_14","title":"\u547d\u4ee4\u9a8c\u8bc1\u5668\u5982\u4f55\u547d\u540d\uff1f","text":"<p>\u683c\u5f0f\uff1a<code>{CommandName}Validator</code></p> <pre><code>public class CreateUserCommandValidator : AbstractValidator&lt;CreateUserCommand&gt; { }\npublic class UpdateUserEmailCommandValidator : AbstractValidator&lt;UpdateUserEmailCommand&gt; { }\n</code></pre>"},{"location":"best-practices/naming-conventions/#_15","title":"\u67e5\u8be2","text":"<p>\u683c\u5f0f\uff1a<code>Get{Entity}Query</code> \u6216 <code>Get{Entity}ListQuery</code></p> <pre><code>public record GetUserQuery(UserId UserId) : IQuery&lt;UserDto&gt;;\npublic record GetUserListQuery(int PageIndex, int PageSize) : IQuery&lt;PagedData&lt;UserListItemDto&gt;&gt;;\npublic record GetOrderDetailQuery(OrderId OrderId) : IQuery&lt;OrderDetailDto&gt;;\n</code></pre>"},{"location":"best-practices/naming-conventions/#_16","title":"\u67e5\u8be2\u5904\u7406\u5668\u5982\u4f55\u547d\u540d\uff1f","text":"<p>\u683c\u5f0f\uff1a<code>{QueryName}Handler</code></p> <pre><code>public class GetUserQueryHandler : IQueryHandler&lt;GetUserQuery, UserDto&gt; { }\npublic class GetUserListQueryHandler : IQueryHandler&lt;GetUserListQuery, PagedData&lt;UserListItemDto&gt;&gt; { }\n</code></pre>"},{"location":"best-practices/naming-conventions/#dto","title":"DTO\u5982\u4f55\u547d\u540d\uff1f","text":"<p>\u683c\u5f0f\uff1a<code>{Entity}Dto</code> \u6216 <code>{Entity}{Purpose}Dto</code></p> <pre><code>public record UserDto(UserId Id, string Name, string Email);\npublic record UserListItemDto(UserId Id, string Name, string Email);\npublic record OrderDetailDto(OrderId Id, string CustomerName, List&lt;OrderItemDto&gt; Items);\n</code></pre>"},{"location":"best-practices/naming-conventions/#_17","title":"\u4ed3\u50a8\u5982\u4f55\u547d\u540d\uff1f","text":""},{"location":"best-practices/naming-conventions/#_18","title":"\u4ed3\u50a8\u63a5\u53e3\u5982\u4f55\u547d\u540d\uff1f","text":"<p>\u683c\u5f0f\uff1a<code>I{Entity}Repository</code></p> <pre><code>public interface IUserRepository : IRepository&lt;User, UserId&gt; { }\npublic interface IOrderRepository : IRepository&lt;Order, OrderId&gt; { }\n</code></pre>"},{"location":"best-practices/naming-conventions/#_19","title":"\u4ed3\u50a8\u5b9e\u73b0\u5982\u4f55\u547d\u540d\uff1f","text":"<p>\u683c\u5f0f\uff1a<code>{Entity}Repository</code></p> <pre><code>public class UserRepository : RepositoryBase&lt;User, UserId, ApplicationDbContext&gt;, IUserRepository { }\npublic class OrderRepository : RepositoryBase&lt;Order, OrderId, ApplicationDbContext&gt;, IOrderRepository { }\n</code></pre>"},{"location":"best-practices/naming-conventions/#_20","title":"\u4ed3\u50a8\u65b9\u6cd5\u5982\u4f55\u547d\u540d\uff1f","text":"<p>\u4f7f\u7528\u4e1a\u52a1\u8bed\u8a00\uff0c\u4f53\u73b0\u4e1a\u52a1\u610f\u56fe\uff1a</p> <pre><code>Task&lt;User?&gt; GetByEmailAsync(string email, CancellationToken cancellationToken);\nTask&lt;bool&gt; EmailExistsAsync(string email, CancellationToken cancellationToken);\nTask&lt;List&lt;Order&gt;&gt; GetPendingOrdersAsync(CancellationToken cancellationToken);\nTask&lt;List&lt;Product&gt;&gt; GetPublishedProductsAsync(CancellationToken cancellationToken);\n</code></pre>"},{"location":"best-practices/naming-conventions/#_21","title":"\u4e8b\u4ef6\u5904\u7406\u5668\u5982\u4f55\u547d\u540d\uff1f","text":""},{"location":"best-practices/naming-conventions/#_22","title":"\u9886\u57df\u4e8b\u4ef6\u5904\u7406\u5668\u5982\u4f55\u547d\u540d\uff1f","text":"<p>\u683c\u5f0f\uff1a<code>{DomainEvent}HandlerFor{Purpose}</code></p> <pre><code>public class UserCreatedDomainEventHandlerForNotification \n    : IDomainEventHandler&lt;UserCreatedDomainEvent&gt; { }\n\npublic class OrderPaidDomainEventHandlerForDelivery \n    : IDomainEventHandler&lt;OrderPaidDomainEvent&gt; { }\n</code></pre>"},{"location":"best-practices/naming-conventions/#_23","title":"\u96c6\u6210\u4e8b\u4ef6","text":"<p>\u683c\u5f0f\uff1a<code>{Entity}{Action}IntegrationEvent</code></p> <pre><code>public record UserCreatedIntegrationEvent(\n    UserId UserId, \n    string Name, \n    string Email, \n    DateTime CreatedTime);\n</code></pre>"},{"location":"best-practices/naming-conventions/#_24","title":"\u96c6\u6210\u4e8b\u4ef6\u5904\u7406\u5668\u5982\u4f55\u547d\u540d\uff1f","text":"<p>\u683c\u5f0f\uff1a<code>{IntegrationEvent}Handler</code></p> <pre><code>public class PaymentCompletedIntegrationEventHandler \n    : IIntegrationEventHandler&lt;PaymentCompletedIntegrationEvent&gt; { }\n</code></pre>"},{"location":"best-practices/naming-conventions/#api","title":"API\u7aef\u70b9\u5982\u4f55\u547d\u540d\uff1f","text":""},{"location":"best-practices/naming-conventions/#endpoint","title":"Endpoint\u7c7b\u5982\u4f55\u547d\u540d\uff1f","text":"<p>\u683c\u5f0f\uff1a<code>{Action}{Entity}Endpoint</code></p> <pre><code>public class CreateUserEndpoint : EndpointWithoutRequest&lt;UserId&gt; { }\npublic class GetUserEndpoint : Endpoint&lt;GetUserRequest, UserDto&gt; { }\npublic class UpdateUserEmailEndpoint : EndpointWithoutResponse&lt;UpdateUserEmailRequest&gt; { }\n</code></pre>"},{"location":"best-practices/naming-conventions/#_25","title":"\u8def\u7531\u5982\u4f55\u547d\u540d\uff1f","text":"<p>\u4f7f\u7528RESTful\u7ea6\u5b9a\uff1a</p> <pre><code>// \u2705 \u597d\u7684\u8def\u7531\n/api/users\n/api/users/{id}\n/api/orders\n/api/orders/{id}/items\n\n// \u274c \u4e0d\u597d\u7684\u8def\u7531\n/api/GetUsers\n/api/user/create\n/api/OrderList\n</code></pre>"},{"location":"best-practices/naming-conventions/#_26","title":"\u914d\u7f6e\u7c7b\u5982\u4f55\u547d\u540d\uff1f","text":""},{"location":"best-practices/naming-conventions/#_27","title":"\u5b9e\u4f53\u914d\u7f6e\u5982\u4f55\u547d\u540d\uff1f","text":"<p>\u683c\u5f0f\uff1a<code>{Entity}EntityConfiguration</code></p> <pre><code>public class UserEntityConfiguration : IEntityTypeConfiguration&lt;User&gt; { }\npublic class OrderEntityConfiguration : IEntityTypeConfiguration&lt;Order&gt; { }\n</code></pre>"},{"location":"best-practices/naming-conventions/#_28","title":"\u6d4b\u8bd5\u7c7b\u5982\u4f55\u547d\u540d\uff1f","text":""},{"location":"best-practices/naming-conventions/#_29","title":"\u6d4b\u8bd5\u7c7b\u547d\u540d\u89c4\u5219\u662f\u4ec0\u4e48\uff1f","text":"<p>\u683c\u5f0f\uff1a<code>{ClassUnderTest}Tests</code></p> <pre><code>public class UserTests { }\npublic class CreateUserCommandHandlerTests { }\npublic class GetUserQueryHandlerTests { }\n</code></pre>"},{"location":"best-practices/naming-conventions/#_30","title":"\u6d4b\u8bd5\u65b9\u6cd5\u5982\u4f55\u547d\u540d\uff1f","text":"<p>\u683c\u5f0f\uff1a<code>{MethodName}_{Scenario}_{ExpectedBehavior}</code></p> <pre><code>[Fact]\npublic void User_Constructor_ShouldCreateValidUser() { }\n\n[Fact]\npublic void ChangeEmail_WithValidEmail_ShouldUpdateEmail() { }\n\n[Fact]\npublic void ChangeEmail_WithInvalidEmail_ShouldThrowException() { }\n</code></pre>"},{"location":"best-practices/naming-conventions/#_31","title":"\u6587\u4ef6\u5982\u4f55\u547d\u540d\uff1f","text":""},{"location":"best-practices/naming-conventions/#_32","title":"\u4e00\u822c\u89c4\u5219\u662f\u4ec0\u4e48\uff1f","text":"<ul> <li>\u6587\u4ef6\u540d\u4e0e\u4e3b\u8981\u7c7b\u540d\u4e00\u81f4</li> <li>\u4f7f\u7528PascalCase</li> <li>\u4e00\u4e2a\u6587\u4ef6\u4e00\u4e2a\u4e3b\u8981\u7c7b\uff08\u9664\u4e86\u76f8\u5173\u7684\u5c0f\u7c7b\uff09</li> </ul> <pre><code>User.cs                              # \u805a\u5408\u6839 + \u5f3a\u7c7b\u578bID\nCreateUserCommand.cs                 # \u547d\u4ee4 + \u9a8c\u8bc1\u5668 + \u5904\u7406\u5668\nGetUserQuery.cs                      # \u67e5\u8be2 + DTO + \u9a8c\u8bc1\u5668 + \u5904\u7406\u5668\nUserDomainEvents.cs                  # \u591a\u4e2a\u76f8\u5173\u9886\u57df\u4e8b\u4ef6\nUserRepository.cs                    # \u4ed3\u50a8\u63a5\u53e3 + \u5b9e\u73b0\nUserEntityConfiguration.cs           # \u5b9e\u4f53\u914d\u7f6e\nUserTests.cs                         # \u6d4b\u8bd5\u7c7b\n</code></pre>"},{"location":"best-practices/naming-conventions/#_33","title":"\u5e38\u91cf\u548c\u679a\u4e3e\u5982\u4f55\u547d\u540d\uff1f","text":""},{"location":"best-practices/naming-conventions/#_34","title":"\u5e38\u91cf\u5982\u4f55\u547d\u540d\uff1f","text":"<p>\u4f7f\u7528UPPER_CASE\uff08C#\u4f20\u7edf\uff09\u6216PascalCase\uff08.NET\u7ea6\u5b9a\uff09\uff1a</p> <pre><code>// \u4e24\u79cd\u65b9\u5f0f\u90fd\u53ef\u4ee5\npublic const int MAX_PAGE_SIZE = 100;\npublic const int MaxPageSize = 100;\n</code></pre>"},{"location":"best-practices/naming-conventions/#_35","title":"\u679a\u4e3e\u5982\u4f55\u547d\u540d\uff1f","text":"<p>\u4f7f\u7528PascalCase\uff0c\u679a\u4e3e\u503c\u4e5f\u4f7f\u7528PascalCase\uff1a</p> <pre><code>public enum OrderStatus\n{\n    Pending,\n    Confirmed,\n    Paid,\n    Shipped,\n    Completed,\n    Cancelled\n}\n</code></pre>"},{"location":"best-practices/naming-conventions/#_36","title":"\u5f02\u5e38\u5982\u4f55\u547d\u540d\uff1f","text":"<p>\u683c\u5f0f\uff1a<code>{Description}Exception</code></p> <pre><code>public class KnownException : Exception { }\npublic class InvalidOrderStateException : Exception { }\npublic class UserNotFoundException : Exception { }\n</code></pre>"},{"location":"best-practices/naming-conventions/#_37","title":"\u7f29\u5199\u5982\u4f55\u4f7f\u7528\uff1f","text":""},{"location":"best-practices/naming-conventions/#_38","title":"\u54ea\u4e9b\u662f\u5e38\u89c1\u7f29\u5199\uff1f","text":"<p>\u53ef\u4ee5\u4f7f\u7528\u7684\u5e38\u89c1\u7f29\u5199\uff1a</p> <ul> <li>Id - Identity/Identifier</li> <li>Dto - Data Transfer Object</li> <li>API - Application Programming Interface</li> <li>HTTP - Hypertext Transfer Protocol</li> <li>SQL - Structured Query Language</li> <li>EF - Entity Framework</li> <li>DB - Database</li> </ul>"},{"location":"best-practices/naming-conventions/#_39","title":"\u7f29\u5199\u5927\u5c0f\u5199\u89c4\u5219\u662f\u4ec0\u4e48\uff1f","text":"<ul> <li>2\u4e2a\u5b57\u6bcd\u7684\u7f29\u5199\uff1a\u5168\u5927\u5199\uff08\u5982 <code>ID</code>, <code>IO</code>\uff09</li> <li>3\u4e2a\u6216\u66f4\u591a\u5b57\u6bcd\uff1a\u53ea\u9996\u5b57\u6bcd\u5927\u5199\uff08\u5982 <code>Api</code>, <code>Http</code>, <code>Sql</code>\uff09</li> </ul> <pre><code>// \u2705 \u6b63\u786e\npublic UserId Id { get; set; }\npublic string ApiKey { get; set; }\npublic HttpClient HttpClient { get; set; }\n\n// \u274c \u4e0d\u6b63\u786e\npublic UserId ID { get; set; }\npublic string APIKey { get; set; }\npublic HttpClient HTTPClient { get; set; }\n</code></pre>"},{"location":"best-practices/naming-conventions/#_40","title":"\u5e03\u5c14\u503c\u5982\u4f55\u547d\u540d\uff1f","text":"<p>\u4f7f\u7528\u660e\u786e\u7684\u524d\u7f00\uff1a</p> <pre><code>// \u2705 \u597d\u7684\u547d\u540d\npublic bool IsActive { get; set; }\npublic bool HasPermission { get; set; }\npublic bool CanEdit { get; set; }\npublic bool ShouldNotify { get; set; }\n\n// \u274c \u4e0d\u597d\u7684\u547d\u540d\npublic bool Active { get; set; }\npublic bool Permission { get; set; }\npublic bool Editable { get; set; }\n</code></pre>"},{"location":"best-practices/naming-conventions/#_41","title":"\u96c6\u5408\u5982\u4f55\u547d\u540d\uff1f","text":"<p>\u4f7f\u7528\u590d\u6570\u5f62\u5f0f\uff1a</p> <pre><code>// \u2705 \u597d\u7684\u547d\u540d\npublic List&lt;User&gt; Users { get; set; }\npublic IEnumerable&lt;Order&gt; Orders { get; set; }\npublic IReadOnlyCollection&lt;OrderItem&gt; OrderItems { get; set; }\n\n// \u274c \u4e0d\u597d\u7684\u547d\u540d\npublic List&lt;User&gt; UserList { get; set; }\npublic IEnumerable&lt;Order&gt; OrderCollection { get; set; }\n</code></pre>"},{"location":"best-practices/naming-conventions/#_42","title":"\u5f02\u6b65\u65b9\u6cd5\u5982\u4f55\u547d\u540d\uff1f","text":"<p>\u6dfb\u52a0\"Async\"\u540e\u7f00\uff1a</p> <pre><code>public async Task&lt;User&gt; GetUserAsync(UserId userId) { }\npublic async Task&lt;bool&gt; EmailExistsAsync(string email) { }\npublic async Task CreateUserAsync(User user) { }\n</code></pre>"},{"location":"best-practices/naming-conventions/#_43","title":"\u5982\u4f55\u68c0\u67e5\u547d\u540d\u662f\u5426\u5408\u683c\uff1f","text":"<p>\u5728\u547d\u540d\u65f6\uff0c\u95ee\u81ea\u5df1\uff1a</p> <ol> <li>\u2705 \u540d\u79f0\u662f\u5426\u6e05\u695a\u5730\u8868\u8fbe\u4e86\u610f\u56fe\uff1f</li> <li>\u2705 \u662f\u5426\u4f7f\u7528\u4e86\u9886\u57df\u8bed\u8a00\uff1f</li> <li>\u2705 \u662f\u5426\u9075\u5faa\u4e86\u9879\u76ee\u7684\u547d\u540d\u7ea6\u5b9a\uff1f</li> <li>\u2705 \u662f\u5426\u4e0e\u73b0\u6709\u4ee3\u7801\u4fdd\u6301\u4e00\u81f4\uff1f</li> <li>\u2705 \u662f\u5426\u907f\u514d\u4e86\u7f29\u5199\u548c\u566a\u97f3\u8bcd\uff1f</li> <li>\u2705 \u662f\u5426\u5bb9\u6613\u88ab\u56e2\u961f\u6210\u5458\u7406\u89e3\uff1f</li> </ol>"},{"location":"best-practices/naming-conventions/#_44","title":"\u5728\u54ea\u91cc\u53ef\u4ee5\u627e\u5230\u76f8\u5173\u6587\u6863\uff1f","text":"<ul> <li>\u9879\u76ee\u7ed3\u6784\u6700\u4f73\u5b9e\u8df5</li> <li>\u4ee3\u7801\u89c4\u8303</li> <li>\u805a\u5408\u5f00\u53d1\u6307\u5357</li> <li>\u547d\u4ee4\u5f00\u53d1\u6307\u5357</li> </ul>"},{"location":"best-practices/project-structure/","title":"\u9879\u76ee\u7ed3\u6784\u6700\u4f73\u5b9e\u8df5","text":""},{"location":"best-practices/project-structure/#_2","title":"\u4e3a\u4ec0\u4e48\u9879\u76ee\u7ed3\u6784\u5f88\u91cd\u8981\uff1f","text":"<p>\u826f\u597d\u7684\u9879\u76ee\u7ed3\u6784\u662fDDD\u548cClean Architecture\u6210\u529f\u5b9e\u65bd\u7684\u57fa\u7840\u3002\u672c\u6587\u6863\u63cf\u8ff0\u4e86\u63a8\u8350\u7684\u9879\u76ee\u7ec4\u7ec7\u65b9\u5f0f\uff0c\u9075\u5faa\u5206\u5c42\u67b6\u6784\u548c\u5173\u6ce8\u70b9\u5206\u79bb\u539f\u5219\u3002</p>"},{"location":"best-practices/project-structure/#_3","title":"\u6807\u51c6\u9879\u76ee\u7ed3\u6784\u662f\u4ec0\u4e48\u6837\u7684\uff1f","text":""},{"location":"best-practices/project-structure/#_4","title":"\u6574\u4f53\u7ed3\u6784","text":"<pre><code>MyProject.sln\n\u251c\u2500\u2500 src/\n\u2502   \u251c\u2500\u2500 MyProject.Domain/           # \u9886\u57df\u5c42 - \u6838\u5fc3\u4e1a\u52a1\u903b\u8f91\n\u2502   \u251c\u2500\u2500 MyProject.Infrastructure/   # \u57fa\u7840\u8bbe\u65bd\u5c42 - \u6570\u636e\u8bbf\u95ee\u548c\u5916\u90e8\u670d\u52a1\n\u2502   \u2514\u2500\u2500 MyProject.Web/             # \u8868\u73b0\u5c42 - API\u548c\u5e94\u7528\u670d\u52a1\n\u2514\u2500\u2500 test/                          # \u6d4b\u8bd5\u9879\u76ee\n    \u251c\u2500\u2500 MyProject.Domain.UnitTests/\n    \u251c\u2500\u2500 MyProject.Infrastructure.UnitTests/\n    \u2514\u2500\u2500 MyProject.Web.UnitTests/\n</code></pre>"},{"location":"best-practices/project-structure/#_5","title":"\u5206\u5c42\u4f9d\u8d56\u5173\u7cfb\u662f\u600e\u6837\u7684\uff1f","text":"<p>\u4e25\u683c\u5355\u5411\u4f9d\u8d56\uff1a Web \u2192 Infrastructure \u2192 Domain</p> <ul> <li>Domain \u5c42\u4e0d\u4f9d\u8d56\u4efb\u4f55\u5176\u4ed6\u5c42</li> <li>Infrastructure \u5c42\u4f9d\u8d56 Domain \u5c42</li> <li>Web \u5c42\u4f9d\u8d56 Infrastructure \u548c Domain \u5c42</li> <li>\u6d4b\u8bd5\u9879\u76ee\u53ef\u4ee5\u4f9d\u8d56\u5bf9\u5e94\u7684\u88ab\u6d4b\u9879\u76ee</li> </ul>"},{"location":"best-practices/project-structure/#domain","title":"Domain\u5c42\uff08\u9886\u57df\u5c42\uff09\u5982\u4f55\u7ec4\u7ec7\uff1f","text":""},{"location":"best-practices/project-structure/#_6","title":"\u76ee\u5f55\u7ed3\u6784","text":"<pre><code>MyProject.Domain/\n\u251c\u2500\u2500 AggregatesModel/                    # \u805a\u5408\u6a21\u578b\n\u2502   \u251c\u2500\u2500 UserAggregate/                  # \u7528\u6237\u805a\u5408\n\u2502   \u2502   \u251c\u2500\u2500 User.cs                     # \u805a\u5408\u6839 + \u5f3a\u7c7b\u578bID\n\u2502   \u2502   \u2514\u2500\u2500 UserRole.cs                 # \u5b50\u5b9e\u4f53\uff08\u5982\u679c\u6709\uff09\n\u2502   \u251c\u2500\u2500 OrderAggregate/                 # \u8ba2\u5355\u805a\u5408\n\u2502   \u2502   \u251c\u2500\u2500 Order.cs                    # \u805a\u5408\u6839 + \u5f3a\u7c7b\u578bID\n\u2502   \u2502   \u251c\u2500\u2500 OrderItem.cs                # \u8ba2\u5355\u9879\u5b50\u5b9e\u4f53\n\u2502   \u2502   \u2514\u2500\u2500 OrderStatus.cs              # \u8ba2\u5355\u72b6\u6001\u679a\u4e3e\n\u2502   \u2514\u2500\u2500 ProductAggregate/               # \u4ea7\u54c1\u805a\u5408\n\u2502       \u251c\u2500\u2500 Product.cs                  # \u805a\u5408\u6839\n\u2502       \u2514\u2500\u2500 ProductReview.cs            # \u4ea7\u54c1\u8bc4\u8bba\u5b50\u5b9e\u4f53\n\u251c\u2500\u2500 DomainEvents/                       # \u9886\u57df\u4e8b\u4ef6\n\u2502   \u251c\u2500\u2500 UserDomainEvents.cs             # \u7528\u6237\u76f8\u5173\u9886\u57df\u4e8b\u4ef6\n\u2502   \u251c\u2500\u2500 OrderDomainEvents.cs            # \u8ba2\u5355\u76f8\u5173\u9886\u57df\u4e8b\u4ef6\n\u2502   \u2514\u2500\u2500 ProductDomainEvents.cs          # \u4ea7\u54c1\u76f8\u5173\u9886\u57df\u4e8b\u4ef6\n\u251c\u2500\u2500 DomainServices/                     # \u9886\u57df\u670d\u52a1\uff08\u53ef\u9009\uff09\n\u2502   \u2514\u2500\u2500 PricingService.cs               # \u5b9a\u4ef7\u670d\u52a1\n\u251c\u2500\u2500 Exceptions/                         # \u9886\u57df\u5f02\u5e38\uff08\u53ef\u9009\uff09\n\u2502   \u2514\u2500\u2500 DomainException.cs\n\u2514\u2500\u2500 GlobalUsings.cs                     # \u5168\u5c40using\u5f15\u7528\n</code></pre>"},{"location":"best-practices/project-structure/#_7","title":"\u804c\u8d23\u8bf4\u660e","text":"<p>AggregatesModel\uff08\u805a\u5408\u6a21\u578b\uff09: - \u5305\u542b\u6240\u6709\u805a\u5408\u6839\u3001\u5b9e\u4f53\u3001\u503c\u5bf9\u8c61 - \u6bcf\u4e2a\u805a\u5408\u72ec\u7acb\u6587\u4ef6\u5939 - \u805a\u5408\u6839\u5305\u542b\u5f3a\u7c7b\u578bID\u5b9a\u4e49 - \u5305\u542b\u4e1a\u52a1\u89c4\u5219\u548c\u4e0d\u53d8\u6027</p> <p>DomainEvents\uff08\u9886\u57df\u4e8b\u4ef6\uff09: - \u5b9a\u4e49\u9886\u57df\u4e2d\u53d1\u751f\u7684\u91cd\u8981\u4e8b\u4ef6 - \u6309\u805a\u5408\u5206\u7ec4\u7ec4\u7ec7 - \u4f7f\u7528\u8fc7\u53bb\u5f0f\u547d\u540d</p> <p>DomainServices\uff08\u9886\u57df\u670d\u52a1\uff09: - \u4e0d\u5c5e\u4e8e\u4efb\u4f55\u7279\u5b9a\u5b9e\u4f53\u7684\u4e1a\u52a1\u903b\u8f91 - \u8de8\u805a\u5408\u7684\u590d\u6742\u4e1a\u52a1\u89c4\u5219</p>"},{"location":"best-practices/project-structure/#infrastructure","title":"Infrastructure\u5c42\uff08\u57fa\u7840\u8bbe\u65bd\u5c42\uff09\u5982\u4f55\u7ec4\u7ec7\uff1f","text":""},{"location":"best-practices/project-structure/#_8","title":"\u76ee\u5f55\u7ed3\u6784","text":"<pre><code>MyProject.Infrastructure/\n\u251c\u2500\u2500 Repositories/                       # \u4ed3\u50a8\u5b9e\u73b0\n\u2502   \u251c\u2500\u2500 UserRepository.cs               # \u7528\u6237\u4ed3\u50a8\u63a5\u53e3+\u5b9e\u73b0\n\u2502   \u251c\u2500\u2500 OrderRepository.cs              # \u8ba2\u5355\u4ed3\u50a8\u63a5\u53e3+\u5b9e\u73b0\n\u2502   \u2514\u2500\u2500 ProductRepository.cs            # \u4ea7\u54c1\u4ed3\u50a8\u63a5\u53e3+\u5b9e\u73b0\n\u251c\u2500\u2500 EntityConfigurations/               # EF Core\u5b9e\u4f53\u914d\u7f6e\n\u2502   \u251c\u2500\u2500 UserEntityConfiguration.cs      # \u7528\u6237\u5b9e\u4f53\u914d\u7f6e\n\u2502   \u251c\u2500\u2500 OrderEntityConfiguration.cs     # \u8ba2\u5355\u5b9e\u4f53\u914d\u7f6e\n\u2502   \u2514\u2500\u2500 ProductEntityConfiguration.cs   # \u4ea7\u54c1\u5b9e\u4f53\u914d\u7f6e\n\u251c\u2500\u2500 Migrations/                         # \u6570\u636e\u5e93\u8fc1\u79fb\n\u2502   \u2514\u2500\u2500 20240101000000_InitialCreate.cs\n\u251c\u2500\u2500 ApplicationDbContext.cs             # \u6570\u636e\u5e93\u4e0a\u4e0b\u6587\n\u251c\u2500\u2500 DesignTimeDbContextFactory.cs       # \u8bbe\u8ba1\u65f6\u5de5\u5382\n\u2514\u2500\u2500 GlobalUsings.cs                     # \u5168\u5c40using\u5f15\u7528\n</code></pre>"},{"location":"best-practices/project-structure/#_9","title":"\u804c\u8d23\u8bf4\u660e","text":"<p>Repositories\uff08\u4ed3\u50a8\uff09: - \u5c01\u88c5\u6570\u636e\u8bbf\u95ee\u903b\u8f91 - \u63a5\u53e3\u548c\u5b9e\u73b0\u5728\u540c\u4e00\u6587\u4ef6 - \u63d0\u4f9b\u4e1a\u52a1\u5bfc\u5411\u7684\u67e5\u8be2\u65b9\u6cd5</p> <p>EntityConfigurations\uff08\u5b9e\u4f53\u914d\u7f6e\uff09: - EF Core\u7684\u5b9e\u4f53\u6620\u5c04\u914d\u7f6e - \u8868\u540d\u3001\u5b57\u6bb5\u3001\u5173\u7cfb\u914d\u7f6e - \u7d22\u5f15\u548c\u7ea6\u675f\u5b9a\u4e49</p> <p>ApplicationDbContext: - \u7ba1\u7406\u6240\u6709DbSet - \u914d\u7f6e\u5b9e\u4f53\u6620\u5c04 - \u5904\u7406\u9886\u57df\u4e8b\u4ef6\u53d1\u5e03</p>"},{"location":"best-practices/project-structure/#web","title":"Web\u5c42\uff08\u8868\u73b0\u5c42\uff09\u5982\u4f55\u7ec4\u7ec7\uff1f","text":""},{"location":"best-practices/project-structure/#_10","title":"\u76ee\u5f55\u7ed3\u6784","text":"<pre><code>MyProject.Web/\n\u251c\u2500\u2500 Application/                        # \u5e94\u7528\u670d\u52a1\u5c42\n\u2502   \u251c\u2500\u2500 Commands/                       # \u547d\u4ee4\n\u2502   \u2502   \u251c\u2500\u2500 User/\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 CreateUserCommand.cs\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 UpdateUserCommand.cs\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 DeleteUserCommand.cs\n\u2502   \u2502   \u251c\u2500\u2500 Order/\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 CreateOrderCommand.cs\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 PayOrderCommand.cs\n\u2502   \u2502   \u2514\u2500\u2500 Product/\n\u2502   \u2502       \u2514\u2500\u2500 CreateProductCommand.cs\n\u2502   \u251c\u2500\u2500 Queries/                        # \u67e5\u8be2\n\u2502   \u2502   \u251c\u2500\u2500 User/\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 GetUserQuery.cs\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 GetUserListQuery.cs\n\u2502   \u2502   \u251c\u2500\u2500 Order/\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 GetOrderQuery.cs\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 GetOrderListQuery.cs\n\u2502   \u2502   \u2514\u2500\u2500 Product/\n\u2502   \u2502       \u2514\u2500\u2500 GetProductListQuery.cs\n\u2502   \u251c\u2500\u2500 DomainEventHandlers/            # \u9886\u57df\u4e8b\u4ef6\u5904\u7406\u5668\n\u2502   \u2502   \u251c\u2500\u2500 UserCreatedDomainEventHandlerForNotification.cs\n\u2502   \u2502   \u2514\u2500\u2500 OrderPaidDomainEventHandlerForDelivery.cs\n\u2502   \u251c\u2500\u2500 IntegrationEvents/              # \u96c6\u6210\u4e8b\u4ef6\n\u2502   \u2502   \u251c\u2500\u2500 UserCreatedIntegrationEvent.cs\n\u2502   \u2502   \u2514\u2500\u2500 OrderCreatedIntegrationEvent.cs\n\u2502   \u251c\u2500\u2500 IntegrationEventHandlers/       # \u96c6\u6210\u4e8b\u4ef6\u5904\u7406\u5668\n\u2502   \u2502   \u2514\u2500\u2500 PaymentCompletedIntegrationEventHandler.cs\n\u2502   \u2514\u2500\u2500 Dtos/                           # \u6570\u636e\u4f20\u8f93\u5bf9\u8c61\uff08\u53ef\u9009\uff09\n\u2502       \u2514\u2500\u2500 UserDto.cs\n\u251c\u2500\u2500 Endpoints/                          # FastEndpoints\u7aef\u70b9\n\u2502   \u251c\u2500\u2500 User/\n\u2502   \u2502   \u251c\u2500\u2500 CreateUserEndpoint.cs\n\u2502   \u2502   \u251c\u2500\u2500 UpdateUserEndpoint.cs\n\u2502   \u2502   \u2514\u2500\u2500 GetUserEndpoint.cs\n\u2502   \u2514\u2500\u2500 Order/\n\u2502       \u251c\u2500\u2500 CreateOrderEndpoint.cs\n\u2502       \u2514\u2500\u2500 GetOrderEndpoint.cs\n\u251c\u2500\u2500 Middlewares/                        # \u4e2d\u95f4\u4ef6\n\u2502   \u2514\u2500\u2500 ExceptionHandlingMiddleware.cs\n\u251c\u2500\u2500 Program.cs                          # \u5e94\u7528\u7a0b\u5e8f\u5165\u53e3\n\u251c\u2500\u2500 appsettings.json                    # \u914d\u7f6e\u6587\u4ef6\n\u2514\u2500\u2500 GlobalUsings.cs                     # \u5168\u5c40using\u5f15\u7528\n</code></pre>"},{"location":"best-practices/project-structure/#_11","title":"\u804c\u8d23\u8bf4\u660e","text":"<p>Commands\uff08\u547d\u4ee4\uff09: - \u8868\u793a\u4fee\u6539\u7cfb\u7edf\u72b6\u6001\u7684\u64cd\u4f5c - \u5305\u542b\u547d\u4ee4\u3001\u9a8c\u8bc1\u5668\u548c\u5904\u7406\u5668 - \u6309\u529f\u80fd\u6a21\u5757\u7ec4\u7ec7</p> <p>Queries\uff08\u67e5\u8be2\uff09: - \u8868\u793a\u8bfb\u53d6\u6570\u636e\u7684\u64cd\u4f5c - \u76f4\u63a5\u8bbf\u95eeDbContext - \u8fd4\u56deDTO\u800c\u975e\u5b9e\u4f53</p> <p>DomainEventHandlers\uff08\u9886\u57df\u4e8b\u4ef6\u5904\u7406\u5668\uff09: - \u5904\u7406\u9886\u57df\u4e8b\u4ef6 - \u5b9e\u73b0\u8de8\u805a\u5408\u534f\u4f5c - \u53ef\u4ee5\u6709\u591a\u4e2a\u5904\u7406\u5668\u5904\u7406\u540c\u4e00\u4e8b\u4ef6</p> <p>IntegrationEvents\uff08\u96c6\u6210\u4e8b\u4ef6\uff09: - \u8de8\u670d\u52a1\u901a\u4fe1\u7684\u4e8b\u4ef6 - \u4e0d\u5305\u542b\u9886\u57df\u5bf9\u8c61\u5f15\u7528</p> <p>Endpoints\uff08\u7aef\u70b9\uff09: - RESTful API\u7aef\u70b9 - \u4f7f\u7528FastEndpoints\u6846\u67b6 - \u8d1f\u8d23HTTP\u8bf7\u6c42/\u54cd\u5e94\u5904\u7406</p>"},{"location":"best-practices/project-structure/#test","title":"Test\u5c42\uff08\u6d4b\u8bd5\u9879\u76ee\uff09\u5982\u4f55\u7ec4\u7ec7\uff1f","text":""},{"location":"best-practices/project-structure/#_12","title":"\u76ee\u5f55\u7ed3\u6784","text":"<pre><code>test/\n\u251c\u2500\u2500 MyProject.Domain.UnitTests/         # \u9886\u57df\u5c42\u5355\u5143\u6d4b\u8bd5\n\u2502   \u251c\u2500\u2500 UserTests.cs                    # \u7528\u6237\u805a\u5408\u6d4b\u8bd5\n\u2502   \u251c\u2500\u2500 OrderTests.cs                   # \u8ba2\u5355\u805a\u5408\u6d4b\u8bd5\n\u2502   \u2514\u2500\u2500 ProductTests.cs                 # \u4ea7\u54c1\u805a\u5408\u6d4b\u8bd5\n\u251c\u2500\u2500 MyProject.Infrastructure.UnitTests/ # \u57fa\u7840\u8bbe\u65bd\u5c42\u6d4b\u8bd5\n\u2502   \u251c\u2500\u2500 UserRepositoryTests.cs\n\u2502   \u2514\u2500\u2500 OrderRepositoryTests.cs\n\u2514\u2500\u2500 MyProject.Web.UnitTests/           # Web\u5c42\u5355\u5143\u6d4b\u8bd5\n    \u251c\u2500\u2500 Commands/\n    \u2502   \u2514\u2500\u2500 CreateUserCommandHandlerTests.cs\n    \u251c\u2500\u2500 Queries/\n    \u2502   \u2514\u2500\u2500 GetUserQueryHandlerTests.cs\n    \u2514\u2500\u2500 Endpoints/\n        \u2514\u2500\u2500 CreateUserEndpointTests.cs\n</code></pre>"},{"location":"best-practices/project-structure/#_13","title":"\u5982\u4f55\u547d\u540d\u6587\u4ef6\u548c\u547d\u540d\u7a7a\u95f4\uff1f","text":""},{"location":"best-practices/project-structure/#_14","title":"\u6587\u4ef6\u547d\u540d","text":"<ul> <li>\u805a\u5408\u6839: <code>{EntityName}.cs</code>\uff08\u5982 <code>User.cs</code>, <code>Order.cs</code>\uff09</li> <li>\u5f3a\u7c7b\u578bID: \u4e0e\u805a\u5408\u6839\u5728\u540c\u4e00\u6587\u4ef6\u4e2d</li> <li>\u9886\u57df\u4e8b\u4ef6: <code>{Entity}{Action}DomainEvent.cs</code>\uff08\u5982 <code>UserCreatedDomainEvent</code>\uff09</li> <li>\u547d\u4ee4: <code>{Action}{Entity}Command.cs</code>\uff08\u5982 <code>CreateUserCommand.cs</code>\uff09</li> <li>\u67e5\u8be2: <code>{Action}{Entity}Query.cs</code>\uff08\u5982 <code>GetUserListQuery.cs</code>\uff09</li> <li>\u4ed3\u50a8: <code>{Entity}Repository.cs</code>\uff08\u5982 <code>UserRepository.cs</code>\uff09</li> <li>\u5b9e\u4f53\u914d\u7f6e: <code>{Entity}EntityConfiguration.cs</code></li> </ul>"},{"location":"best-practices/project-structure/#_15","title":"\u547d\u540d\u7a7a\u95f4\u5e94\u8be5\u600e\u4e48\u7ec4\u7ec7\uff1f","text":"<pre><code>// Domain\u5c42\nMyProject.Domain.AggregatesModel.UserAggregate\nMyProject.Domain.DomainEvents\n\n// Infrastructure\u5c42\nMyProject.Infrastructure.Repositories\nMyProject.Infrastructure.EntityConfigurations\n\n// Web\u5c42\nMyProject.Web.Application.Commands.User\nMyProject.Web.Application.Queries.User\nMyProject.Web.Application.DomainEventHandlers\nMyProject.Web.Endpoints.User\n</code></pre>"},{"location":"best-practices/project-structure/#_16","title":"\u5982\u4f55\u8fdb\u884c\u6a21\u5757\u5316\u7ec4\u7ec7\uff1f","text":"<p>\u5bf9\u4e8e\u5927\u578b\u9879\u76ee\uff0c\u53ef\u4ee5\u6309\u4e1a\u52a1\u6a21\u5757\u7ec4\u7ec7\uff1a</p> <pre><code>MyProject.Web/\n\u251c\u2500\u2500 Application/\n\u2502   \u251c\u2500\u2500 User/                          # \u7528\u6237\u6a21\u5757\n\u2502   \u2502   \u251c\u2500\u2500 Commands/\n\u2502   \u2502   \u251c\u2500\u2500 Queries/\n\u2502   \u2502   \u2514\u2500\u2500 DomainEventHandlers/\n\u2502   \u251c\u2500\u2500 Order/                         # \u8ba2\u5355\u6a21\u5757\n\u2502   \u2502   \u251c\u2500\u2500 Commands/\n\u2502   \u2502   \u251c\u2500\u2500 Queries/\n\u2502   \u2502   \u2514\u2500\u2500 DomainEventHandlers/\n\u2502   \u2514\u2500\u2500 Product/                       # \u4ea7\u54c1\u6a21\u5757\n\u2502       \u251c\u2500\u2500 Commands/\n\u2502       \u2514\u2500\u2500 Queries/\n</code></pre>"},{"location":"best-practices/project-structure/#_17","title":"\u9879\u76ee\u7ed3\u6784\u6709\u54ea\u4e9b\u6700\u4f73\u5b9e\u8df5\uff1f","text":""},{"location":"best-practices/project-structure/#1","title":"1. \u4fdd\u6301\u5c42\u6b21\u6e05\u6670","text":"<ul> <li>\u4e25\u683c\u9075\u5b88\u4f9d\u8d56\u65b9\u5411</li> <li>\u907f\u514d\u5faa\u73af\u4f9d\u8d56</li> <li>Domain\u5c42\u4fdd\u6301\u7eaf\u51c0\uff0c\u4e0d\u4f9d\u8d56\u5916\u90e8\u6846\u67b6</li> </ul>"},{"location":"best-practices/project-structure/#2","title":"2. \u6309\u529f\u80fd\u7ec4\u7ec7","text":"<ul> <li>\u76f8\u5173\u7684\u4ee3\u7801\u653e\u5728\u4e00\u8d77</li> <li>\u6309\u4e1a\u52a1\u6a21\u5757\u800c\u975e\u6280\u672f\u5c42\u6b21\u7ec4\u7ec7</li> <li>\u964d\u4f4e\u8ba4\u77e5\u8d1f\u62c5</li> </ul>"},{"location":"best-practices/project-structure/#3","title":"3. \u4fdd\u6301\u4e00\u81f4\u6027","text":"<ul> <li>\u7edf\u4e00\u7684\u547d\u540d\u7ea6\u5b9a</li> <li>\u7edf\u4e00\u7684\u6587\u4ef6\u7ec4\u7ec7\u65b9\u5f0f</li> <li>\u56e2\u961f\u6210\u5458\u6613\u4e8e\u7406\u89e3\u548c\u5bfc\u822a</li> </ul>"},{"location":"best-practices/project-structure/#4","title":"4. \u9002\u5ea6\u5206\u79bb","text":"<ul> <li>\u4e0d\u8981\u8fc7\u5ea6\u7ec6\u5206</li> <li>\u907f\u514d\u4e00\u4e2a\u6587\u4ef6\u4e00\u4e2a\u7c7b\uff08\u9664\u975e\u5fc5\u8981\uff09</li> <li>\u76f8\u5173\u7684\u5c0f\u7c7b\u53ef\u4ee5\u653e\u5728\u4e00\u4e2a\u6587\u4ef6\u4e2d</li> </ul>"},{"location":"best-practices/project-structure/#5-globalusings","title":"5. \u4f7f\u7528GlobalUsings","text":"<ul> <li>\u51cf\u5c11\u91cd\u590d\u7684using\u8bed\u53e5</li> <li>\u63d0\u9ad8\u4ee3\u7801\u53ef\u8bfb\u6027</li> <li>\u5728\u6bcf\u4e2a\u9879\u76ee\u4e2d\u5b9a\u4e49GlobalUsings.cs</li> </ul>"},{"location":"best-practices/project-structure/#_18","title":"\u9879\u76ee\u7ed3\u6784\u5e38\u89c1\u95ee\u9898\u6709\u54ea\u4e9b\uff1f","text":""},{"location":"best-practices/project-structure/#q-infrastructuredomain","title":"Q: \u4e3a\u4ec0\u4e48\u4ed3\u50a8\u653e\u5728Infrastructure\u800c\u4e0d\u662fDomain\uff1f","text":"<p>A: \u867d\u7136\u4ed3\u50a8\u63a5\u53e3\u5728\u6982\u5ff5\u4e0a\u5c5e\u4e8eDomain\uff0c\u4f46\u5728\u5b9e\u8df5\u4e2d\uff0c\u5c06\u63a5\u53e3\u548c\u5b9e\u73b0\u90fd\u653e\u5728Infrastructure\u5c42\u53ef\u4ee5\u7b80\u5316\u4f9d\u8d56\u5173\u7cfb\uff0c\u56e0\u4e3a\u4ed3\u50a8\u7684\u5b9e\u73b0\u603b\u662f\u4f9d\u8d56\u5177\u4f53\u7684\u6301\u4e45\u5316\u6280\u672f\uff08\u5982EF Core\uff09\u3002</p>"},{"location":"best-practices/project-structure/#q","title":"Q: \u4ec0\u4e48\u65f6\u5019\u5e94\u8be5\u521b\u5efa\u65b0\u7684\u805a\u5408\uff1f","text":"<p>A: \u5f53\u4e00\u7ec4\u5b9e\u4f53\uff1a 1. \u6709\u660e\u786e\u7684\u4e1a\u52a1\u8fb9\u754c 2. \u9700\u8981\u4fdd\u8bc1\u4e8b\u52a1\u4e00\u81f4\u6027 3. \u53ef\u4ee5\u72ec\u7acb\u5b58\u5728\u548c\u6f14\u5316</p>"},{"location":"best-practices/project-structure/#q_1","title":"Q: \u5982\u4f55\u5904\u7406\u8de8\u805a\u5408\u7684\u67e5\u8be2\uff1f","text":"<p>A: \u5728\u67e5\u8be2\u5904\u7406\u5668\u4e2d\u76f4\u63a5\u4f7f\u7528DbContext\u8fdb\u884c\u8de8\u805a\u5408\u67e5\u8be2\uff0c\u8fd9\u662f\u8bfb\u6a21\u578b\uff0c\u4e0d\u9700\u8981\u7ecf\u8fc7\u805a\u5408\u6839\u3002</p>"},{"location":"best-practices/project-structure/#q-dto","title":"Q: \u5e94\u8be5\u5728\u54ea\u91cc\u653e\u7f6eDTO\uff1f","text":"<p>A: DTO\u53ef\u4ee5\u548c\u67e5\u8be2\u6216\u547d\u4ee4\u653e\u5728\u4e00\u8d77\uff0c\u4e5f\u53ef\u4ee5\u653e\u5728\u72ec\u7acb\u7684Dtos\u6587\u4ef6\u5939\u4e2d\u3002\u63a8\u8350\u4e0e\u67e5\u8be2\u653e\u5728\u4e00\u8d77\uff0c\u56e0\u4e3a\u5b83\u4eec\u901a\u5e38\u662f\u4e3a\u67e5\u8be2\u670d\u52a1\u7684\u3002</p>"},{"location":"best-practices/project-structure/#_19","title":"\u5728\u54ea\u91cc\u53ef\u4ee5\u627e\u5230\u76f8\u5173\u6587\u6863\uff1f","text":"<ul> <li>\u805a\u5408\u5f00\u53d1\u6307\u5357</li> <li>\u547d\u4ee4\u5f00\u53d1\u6307\u5357</li> <li>\u67e5\u8be2\u5f00\u53d1\u6307\u5357</li> <li>\u4ed3\u50a8\u5f00\u53d1\u6307\u5357</li> <li>\u547d\u540d\u89c4\u8303</li> </ul>"},{"location":"best-practices/testing-strategy/","title":"\u6d4b\u8bd5\u7b56\u7565\u6700\u4f73\u5b9e\u8df5","text":""},{"location":"best-practices/testing-strategy/#_2","title":"\u6982\u8ff0","text":"<p>\u5355\u5143\u6d4b\u8bd5\u786e\u4fdd\u9886\u57df\u6a21\u578b\u7684\u6b63\u786e\u6027\u548c\u4e1a\u52a1\u89c4\u5219\u7684\u6709\u6548\u6027\u3002\u672c\u6587\u6863\u63cf\u8ff0\u4e86\u5728DDD\u548cClean Architecture\u9879\u76ee\u4e2d\u7684\u6d4b\u8bd5\u7b56\u7565\u548c\u6700\u4f73\u5b9e\u8df5\u3002</p>"},{"location":"best-practices/testing-strategy/#_3","title":"\u6d4b\u8bd5\u91d1\u5b57\u5854","text":"<pre><code>       /\\\n      /  \\  E2E Tests (\u5c11\u91cf)\n     /____\\\n    /      \\  Integration Tests (\u9002\u91cf)\n   /________\\\n  /          \\  Unit Tests (\u5927\u91cf)\n /____________\\\n</code></pre> <ul> <li>\u5355\u5143\u6d4b\u8bd5\uff0870%\uff09: \u6d4b\u8bd5\u805a\u5408\u3001\u5b9e\u4f53\u3001\u503c\u5bf9\u8c61\u3001\u9886\u57df\u670d\u52a1</li> <li>\u96c6\u6210\u6d4b\u8bd5\uff0820%\uff09: \u6d4b\u8bd5\u4ed3\u50a8\u3001\u6570\u636e\u5e93\u4ea4\u4e92\u3001\u5916\u90e8\u670d\u52a1</li> <li>\u7aef\u5230\u7aef\u6d4b\u8bd5\uff0810%\uff09: \u6d4b\u8bd5\u5b8c\u6574\u7684\u7528\u6237\u573a\u666f</li> </ul>"},{"location":"best-practices/testing-strategy/#_4","title":"\u6d4b\u8bd5\u9879\u76ee\u7ed3\u6784","text":""},{"location":"best-practices/testing-strategy/#_5","title":"\u63a8\u8350\u7ed3\u6784","text":"<pre><code>test/\n\u251c\u2500\u2500 MyProject.Domain.UnitTests/         # \u9886\u57df\u5c42\u5355\u5143\u6d4b\u8bd5\n\u2502   \u251c\u2500\u2500 AggregatesModel/\n\u2502   \u2502   \u251c\u2500\u2500 UserAggregate/\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 UserTests.cs\n\u2502   \u2502   \u2514\u2500\u2500 OrderAggregate/\n\u2502   \u2502       \u2514\u2500\u2500 OrderTests.cs\n\u2502   \u251c\u2500\u2500 DomainServices/\n\u2502   \u2502   \u2514\u2500\u2500 PricingServiceTests.cs\n\u2502   \u2514\u2500\u2500 TestHelpers/\n\u2502       \u2514\u2500\u2500 TestDataFactory.cs\n\u251c\u2500\u2500 MyProject.Infrastructure.UnitTests/ # \u57fa\u7840\u8bbe\u65bd\u5c42\u6d4b\u8bd5\n\u2502   \u251c\u2500\u2500 Repositories/\n\u2502   \u2502   \u2514\u2500\u2500 UserRepositoryTests.cs\n\u2502   \u2514\u2500\u2500 TestHelpers/\n\u2502       \u2514\u2500\u2500 DbContextFactory.cs\n\u2514\u2500\u2500 MyProject.Web.UnitTests/           # Web\u5c42\u6d4b\u8bd5\n    \u251c\u2500\u2500 Commands/\n    \u2502   \u2514\u2500\u2500 CreateUserCommandHandlerTests.cs\n    \u251c\u2500\u2500 Queries/\n    \u2502   \u2514\u2500\u2500 GetUserQueryHandlerTests.cs\n    \u2514\u2500\u2500 Endpoints/\n        \u2514\u2500\u2500 UserEndpointsTests.cs\n</code></pre>"},{"location":"best-practices/testing-strategy/#_6","title":"\u5355\u5143\u6d4b\u8bd5\u6700\u4f73\u5b9e\u8df5","text":""},{"location":"best-practices/testing-strategy/#aaa","title":"AAA\u6a21\u5f0f","text":"<p>\u6240\u6709\u6d4b\u8bd5\u5e94\u9075\u5faa Arrange-Act-Assert \u6a21\u5f0f\uff1a</p> <pre><code>[Fact]\npublic void User_Constructor_ShouldCreateValidUser()\n{\n    // Arrange - \u51c6\u5907\u6d4b\u8bd5\u6570\u636e\n    var name = \"\u5f20\u4e09\";\n    var email = \"zhangsan@example.com\";\n\n    // Act - \u6267\u884c\u88ab\u6d4b\u8bd5\u7684\u64cd\u4f5c\n    var user = new User(name, email);\n\n    // Assert - \u9a8c\u8bc1\u7ed3\u679c\n    Assert.Equal(name, user.Name);\n    Assert.Equal(email, user.Email);\n    Assert.False(user.IsDeleted);\n}\n</code></pre>"},{"location":"best-practices/testing-strategy/#_7","title":"\u6d4b\u8bd5\u547d\u540d\u7ea6\u5b9a","text":"<p>\u6d4b\u8bd5\u65b9\u6cd5\u540d\u5e94\u8be5\u6e05\u6670\u8868\u8fbe\u6d4b\u8bd5\u610f\u56fe\uff1a</p> <p>\u683c\u5f0f: <code>{MethodName}_{Scenario}_{ExpectedBehavior}</code></p> <pre><code>// \u2705 \u597d\u7684\u547d\u540d\n[Fact]\npublic void ChangeEmail_WithValidEmail_ShouldUpdateEmail()\n\n[Fact]\npublic void ChangeEmail_WithSameEmail_ShouldNotPublishEvent()\n\n[Fact]\npublic void ChangeEmail_WithInvalidEmail_ShouldThrowException()\n\n// \u274c \u4e0d\u597d\u7684\u547d\u540d\n[Fact]\npublic void TestChangeEmail()\n\n[Fact]\npublic void Test1()\n</code></pre>"},{"location":"best-practices/testing-strategy/#_8","title":"\u4e00\u4e2a\u6d4b\u8bd5\u4e00\u4e2a\u65ad\u8a00","text":"<p>\u6bcf\u4e2a\u6d4b\u8bd5\u5e94\u8be5\u4e13\u6ce8\u4e8e\u9a8c\u8bc1\u4e00\u4e2a\u884c\u4e3a\uff1a</p> <pre><code>// \u2705 \u597d\u7684\u505a\u6cd5\n[Fact]\npublic void User_Constructor_ShouldSetName()\n{\n    var user = new User(\"\u5f20\u4e09\", \"test@example.com\");\n    Assert.Equal(\"\u5f20\u4e09\", user.Name);\n}\n\n[Fact]\npublic void User_Constructor_ShouldSetEmail()\n{\n    var user = new User(\"\u5f20\u4e09\", \"test@example.com\");\n    Assert.Equal(\"test@example.com\", user.Email);\n}\n\n// \u274c \u4e0d\u597d\u7684\u505a\u6cd5 - \u6d4b\u8bd5\u592a\u591a\u4e1c\u897f\n[Fact]\npublic void User_Constructor_ShouldSetAllProperties()\n{\n    var user = new User(\"\u5f20\u4e09\", \"test@example.com\");\n    Assert.Equal(\"\u5f20\u4e09\", user.Name);\n    Assert.Equal(\"test@example.com\", user.Email);\n    Assert.False(user.IsDeleted);\n    Assert.NotNull(user.CreateTime);\n    Assert.True(user.IsActive);\n}\n</code></pre>"},{"location":"best-practices/testing-strategy/#_9","title":"\u6d4b\u8bd5\u805a\u5408\u6839","text":""},{"location":"best-practices/testing-strategy/#_10","title":"\u6d4b\u8bd5\u521b\u5efa","text":"<pre><code>public class UserTests\n{\n    [Fact]\n    public void User_Constructor_ShouldCreateValidUser()\n    {\n        // Arrange\n        var name = \"\u5f20\u4e09\";\n        var email = \"zhangsan@example.com\";\n\n        // Act\n        var user = new User(name, email);\n\n        // Assert\n        Assert.Equal(name, user.Name);\n        Assert.Equal(email, user.Email);\n        Assert.False(user.IsDeleted);\n        Assert.True(user.CreateTime &lt;= DateTimeOffset.UtcNow);\n\n        // \u9a8c\u8bc1\u9886\u57df\u4e8b\u4ef6\n        var domainEvents = user.GetDomainEvents();\n        Assert.Single(domainEvents);\n        Assert.IsType&lt;UserCreatedDomainEvent&gt;(domainEvents.First());\n    }\n\n    [Theory]\n    [InlineData(\"\")]\n    [InlineData(\"   \")]\n    [InlineData(null)]\n    public void User_Constructor_WithInvalidName_ShouldThrowException(string? name)\n    {\n        // Arrange\n        var email = \"test@example.com\";\n\n        // Act &amp; Assert\n        Assert.Throws&lt;KnownException&gt;(() =&gt; new User(name!, email));\n    }\n}\n</code></pre>"},{"location":"best-practices/testing-strategy/#_11","title":"\u6d4b\u8bd5\u4e1a\u52a1\u89c4\u5219","text":"<pre><code>[Fact]\npublic void ChangeEmail_WithValidEmail_ShouldUpdateEmail()\n{\n    // Arrange\n    var user = new User(\"\u5f20\u4e09\", \"old@example.com\");\n    var newEmail = \"new@example.com\";\n\n    // Act\n    user.ChangeEmail(newEmail);\n\n    // Assert\n    Assert.Equal(newEmail, user.Email);\n}\n\n[Fact]\npublic void ChangeEmail_WithSameEmail_ShouldNotPublishEvent()\n{\n    // Arrange\n    var email = \"test@example.com\";\n    var user = new User(\"\u5f20\u4e09\", email);\n    user.ClearDomainEvents(); // \u6e05\u9664\u6784\u9020\u4e8b\u4ef6\n\n    // Act\n    user.ChangeEmail(email); // \u4f7f\u7528\u76f8\u540c\u90ae\u7bb1\n\n    // Assert\n    Assert.Empty(user.GetDomainEvents()); // \u4e0d\u5e94\u53d1\u5e03\u4e8b\u4ef6\n}\n\n[Fact]\npublic void Delete_OnDeletedUser_ShouldThrowException()\n{\n    // Arrange\n    var user = new User(\"\u5f20\u4e09\", \"test@example.com\");\n    user.Delete();\n\n    // Act &amp; Assert\n    Assert.Throws&lt;KnownException&gt;(() =&gt; user.Delete());\n}\n</code></pre>"},{"location":"best-practices/testing-strategy/#_12","title":"\u6d4b\u8bd5\u9886\u57df\u4e8b\u4ef6","text":"<pre><code>[Fact]\npublic void User_BusinessOperations_ShouldPublishCorrectEvents()\n{\n    // Arrange\n    var user = new User(\"\u5f20\u4e09\", \"old@example.com\");\n    user.ClearDomainEvents(); // \u6e05\u9664\u6784\u9020\u51fd\u6570\u4e8b\u4ef6\n\n    // Act\n    user.ChangeEmail(\"new@example.com\");\n    user.ChangeName(\"\u674e\u56db\");\n\n    // Assert\n    var events = user.GetDomainEvents();\n    Assert.Equal(2, events.Count);\n\n    var emailEvent = events.OfType&lt;UserEmailChangedDomainEvent&gt;().Single();\n    Assert.Equal(user, emailEvent.User);\n\n    var nameEvent = events.OfType&lt;UserNameChangedDomainEvent&gt;().Single();\n    Assert.Equal(user, nameEvent.User);\n}\n</code></pre>"},{"location":"best-practices/testing-strategy/#_13","title":"\u6d4b\u8bd5\u547d\u4ee4\u5904\u7406\u5668","text":""},{"location":"best-practices/testing-strategy/#mock","title":"\u4f7f\u7528Mock\u8fdb\u884c\u6d4b\u8bd5","text":"<pre><code>public class CreateUserCommandHandlerTests\n{\n    private readonly Mock&lt;IUserRepository&gt; _mockUserRepository;\n    private readonly CreateUserCommandHandler _handler;\n\n    public CreateUserCommandHandlerTests()\n    {\n        _mockUserRepository = new Mock&lt;IUserRepository&gt;();\n        _handler = new CreateUserCommandHandler(_mockUserRepository.Object);\n    }\n\n    [Fact]\n    public async Task Handle_WithValidCommand_ShouldCreateUser()\n    {\n        // Arrange\n        var command = new CreateUserCommand(\"\u5f20\u4e09\", \"test@example.com\");\n        _mockUserRepository\n            .Setup(r =&gt; r.EmailExistsAsync(command.Email, It.IsAny&lt;CancellationToken&gt;()))\n            .ReturnsAsync(false);\n\n        // Act\n        var userId = await _handler.Handle(command, CancellationToken.None);\n\n        // Assert\n        Assert.NotNull(userId);\n        _mockUserRepository.Verify(\n            r =&gt; r.AddAsync(It.IsAny&lt;User&gt;(), It.IsAny&lt;CancellationToken&gt;()), \n            Times.Once);\n    }\n\n    [Fact]\n    public async Task Handle_WithExistingEmail_ShouldThrowException()\n    {\n        // Arrange\n        var command = new CreateUserCommand(\"\u5f20\u4e09\", \"existing@example.com\");\n        _mockUserRepository\n            .Setup(r =&gt; r.EmailExistsAsync(command.Email, It.IsAny&lt;CancellationToken&gt;()))\n            .ReturnsAsync(true);\n\n        // Act &amp; Assert\n        await Assert.ThrowsAsync&lt;KnownException&gt;(\n            () =&gt; _handler.Handle(command, CancellationToken.None));\n    }\n}\n</code></pre>"},{"location":"best-practices/testing-strategy/#_14","title":"\u6d4b\u8bd5\u67e5\u8be2\u5904\u7406\u5668","text":""},{"location":"best-practices/testing-strategy/#_15","title":"\u4f7f\u7528\u5185\u5b58\u6570\u636e\u5e93","text":"<pre><code>public class GetUserQueryHandlerTests : IDisposable\n{\n    private readonly ApplicationDbContext _context;\n    private readonly GetUserQueryHandler _handler;\n\n    public GetUserQueryHandlerTests()\n    {\n        var options = new DbContextOptionsBuilder&lt;ApplicationDbContext&gt;()\n            .UseInMemoryDatabase(databaseName: Guid.NewGuid().ToString())\n            .Options;\n        _context = new ApplicationDbContext(options, Mock.Of&lt;IMediator&gt;());\n        _handler = new GetUserQueryHandler(_context);\n    }\n\n    [Fact]\n    public async Task Handle_WithExistingUser_ShouldReturnUser()\n    {\n        // Arrange\n        var user = new User(\"\u5f20\u4e09\", \"test@example.com\");\n        _context.Users.Add(user);\n        await _context.SaveChangesAsync();\n\n        var query = new GetUserQuery(user.Id);\n\n        // Act\n        var result = await _handler.Handle(query, CancellationToken.None);\n\n        // Assert\n        Assert.NotNull(result);\n        Assert.Equal(user.Id, result.Id);\n        Assert.Equal(user.Name, result.Name);\n    }\n\n    [Fact]\n    public async Task Handle_WithNonExistingUser_ShouldThrowException()\n    {\n        // Arrange\n        var query = new GetUserQuery(new UserId(999));\n\n        // Act &amp; Assert\n        await Assert.ThrowsAsync&lt;KnownException&gt;(\n            () =&gt; _handler.Handle(query, CancellationToken.None));\n    }\n\n    public void Dispose()\n    {\n        _context.Dispose();\n    }\n}\n</code></pre>"},{"location":"best-practices/testing-strategy/#_16","title":"\u6d4b\u8bd5\u6570\u636e\u51c6\u5907","text":""},{"location":"best-practices/testing-strategy/#_17","title":"\u4f7f\u7528\u5de5\u5382\u65b9\u6cd5","text":"<pre><code>public static class TestDataFactory\n{\n    public static User CreateValidUser(\n        string name = \"\u6d4b\u8bd5\u7528\u6237\", \n        string email = \"test@example.com\")\n    {\n        return new User(name, email);\n    }\n\n    public static Order CreateValidOrder(\n        string customerName = \"\u6d4b\u8bd5\u5ba2\u6237\")\n    {\n        var order = new Order(customerName);\n        order.AddItem(\"\u4ea7\u54c11\", 100m, 1);\n        return order;\n    }\n\n    public static UserId CreateUserId(long value = 123)\n    {\n        return new UserId(value);\n    }\n}\n\n// \u5728\u6d4b\u8bd5\u4e2d\u4f7f\u7528\n[Fact]\npublic void Test_WithUser()\n{\n    var user = TestDataFactory.CreateValidUser();\n    // \u4f7f\u7528 user \u8fdb\u884c\u6d4b\u8bd5\n}\n</code></pre>"},{"location":"best-practices/testing-strategy/#builder","title":"\u4f7f\u7528Builder\u6a21\u5f0f","text":"<pre><code>public class UserBuilder\n{\n    private string _name = \"\u9ed8\u8ba4\u7528\u6237\";\n    private string _email = \"default@example.com\";\n\n    public UserBuilder WithName(string name)\n    {\n        _name = name;\n        return this;\n    }\n\n    public UserBuilder WithEmail(string email)\n    {\n        _email = email;\n        return this;\n    }\n\n    public User Build()\n    {\n        return new User(_name, _email);\n    }\n}\n\n// \u5728\u6d4b\u8bd5\u4e2d\u4f7f\u7528\n[Fact]\npublic void Test_WithCustomUser()\n{\n    var user = new UserBuilder()\n        .WithName(\"\u5f20\u4e09\")\n        .WithEmail(\"zhangsan@example.com\")\n        .Build();\n    // \u4f7f\u7528 user \u8fdb\u884c\u6d4b\u8bd5\n}\n</code></pre>"},{"location":"best-practices/testing-strategy/#_18","title":"\u65f6\u95f4\u76f8\u5173\u6d4b\u8bd5","text":"<p>\u5904\u7406\u65f6\u95f4\u654f\u611f\u7684\u6d4b\u8bd5\u65f6\uff1a</p> <pre><code>[Fact]\npublic void UpdateEmail_ShouldUpdateTimestamp()\n{\n    // Arrange\n    var user = new User(\"\u5f20\u4e09\", \"old@example.com\");\n    var originalUpdateTime = user.UpdateTime;\n\n    // \u786e\u4fdd\u65f6\u95f4\u5dee\u5f02\n    Thread.Sleep(1);\n\n    // Act\n    user.UpdateEmail(\"new@example.com\");\n\n    // Assert\n    Assert.Equal(\"new@example.com\", user.Email);\n    Assert.True(user.UpdateTime &gt;= originalUpdateTime); // \u4f7f\u7528 &gt;= \u800c\u4e0d\u662f &gt;\n}\n</code></pre>"},{"location":"best-practices/testing-strategy/#_19","title":"\u6d4b\u8bd5\u8986\u76d6\u7387\u76ee\u6807","text":"<ul> <li>Domain\u5c42: 90%+ \u8986\u76d6\u7387\uff08\u6838\u5fc3\u4e1a\u52a1\u903b\u8f91\uff09</li> <li>Application\u5c42: 70%+ \u8986\u76d6\u7387\uff08\u547d\u4ee4\u3001\u67e5\u8be2\u5904\u7406\u5668\uff09</li> <li>Infrastructure\u5c42: 50%+ \u8986\u76d6\u7387\uff08\u4ed3\u50a8\u5b9e\u73b0\uff09</li> <li>Endpoints\u5c42: 60%+ \u8986\u76d6\u7387\uff08API\u7aef\u70b9\uff09</li> </ul>"},{"location":"best-practices/testing-strategy/#_20","title":"\u5e38\u89c1\u6d4b\u8bd5\u6a21\u5f0f","text":""},{"location":"best-practices/testing-strategy/#1","title":"1. \u6d4b\u8bd5\u4e0d\u53d8\u91cf","text":"<p>\u786e\u4fdd\u805a\u5408\u6839\u7684\u4e1a\u52a1\u89c4\u5219\u59cb\u7ec8\u6ee1\u8db3\uff1a</p> <pre><code>[Fact]\npublic void Order_TotalAmount_ShouldEqualSumOfItems()\n{\n    var order = new Order(\"\u5ba2\u6237\");\n    order.AddItem(\"\u4ea7\u54c11\", 100m, 2); // 200\n    order.AddItem(\"\u4ea7\u54c12\", 50m, 3);  // 150\n\n    Assert.Equal(350m, order.TotalAmount);\n}\n</code></pre>"},{"location":"best-practices/testing-strategy/#2","title":"2. \u6d4b\u8bd5\u72b6\u6001\u8f6c\u6362","text":"<p>\u9a8c\u8bc1\u72b6\u6001\u53d8\u5316\u7684\u6b63\u786e\u6027\uff1a</p> <pre><code>[Fact]\npublic void Order_Confirm_ShouldChangeStatusToPending()\n{\n    var order = new Order(\"\u5ba2\u6237\");\n    Assert.Equal(OrderStatus.Draft, order.Status);\n\n    order.Confirm();\n    Assert.Equal(OrderStatus.Pending, order.Status);\n}\n</code></pre>"},{"location":"best-practices/testing-strategy/#3","title":"3. \u6d4b\u8bd5\u8fb9\u754c\u6761\u4ef6","text":"<p>\u6d4b\u8bd5\u8f93\u5165\u7684\u8fb9\u754c\u503c\uff1a</p> <pre><code>[Theory]\n[InlineData(0)]\n[InlineData(-1)]\n[InlineData(-100)]\npublic void Product_SetPrice_WithNegativeOrZero_ShouldThrowException(decimal price)\n{\n    var product = new Product(\"\u4ea7\u54c1\", 100m);\n    Assert.Throws&lt;KnownException&gt;(() =&gt; product.SetPrice(price));\n}\n</code></pre>"},{"location":"best-practices/testing-strategy/#4","title":"4. \u6d4b\u8bd5\u5f02\u5e38\u573a\u666f","text":"<p>\u786e\u4fdd\u5f02\u5e38\u60c5\u51b5\u5f97\u5230\u6b63\u786e\u5904\u7406\uff1a</p> <pre><code>[Fact]\npublic void Order_Pay_WithUnconfirmedOrder_ShouldThrowException()\n{\n    var order = new Order(\"\u5ba2\u6237\");\n    Assert.Throws&lt;KnownException&gt;(() =&gt; order.Pay(100m, \"\u652f\u4ed8\u5b9d\"));\n}\n</code></pre>"},{"location":"best-practices/testing-strategy/#5","title":"5. \u6d4b\u8bd5\u4e8b\u4ef6\u53d1\u5e03","text":"<p>\u9a8c\u8bc1\u9886\u57df\u4e8b\u4ef6\u5728\u6b63\u786e\u65f6\u673a\u53d1\u5e03\uff1a</p> <pre><code>[Fact]\npublic void Order_Confirm_ShouldPublishOrderConfirmedEvent()\n{\n    var order = new Order(\"\u5ba2\u6237\");\n    order.ClearDomainEvents();\n\n    order.Confirm();\n\n    var events = order.GetDomainEvents();\n    Assert.Single(events);\n    Assert.IsType&lt;OrderConfirmedDomainEvent&gt;(events.First());\n}\n</code></pre>"},{"location":"best-practices/testing-strategy/#_21","title":"\u6d4b\u8bd5\u5de5\u5177\u63a8\u8350","text":""},{"location":"best-practices/testing-strategy/#_22","title":"\u5355\u5143\u6d4b\u8bd5\u6846\u67b6","text":"<ul> <li>xUnit: \u63a8\u8350\u7684.NET\u6d4b\u8bd5\u6846\u67b6</li> <li>NUnit: \u53e6\u4e00\u4e2a\u6d41\u884c\u9009\u62e9</li> </ul>"},{"location":"best-practices/testing-strategy/#mock_1","title":"Mock\u6846\u67b6","text":"<ul> <li>Moq: \u8f7b\u91cf\u7ea7mock\u6846\u67b6</li> <li>NSubstitute: \u66f4\u7b80\u6d01\u7684\u8bed\u6cd5</li> </ul>"},{"location":"best-practices/testing-strategy/#_23","title":"\u65ad\u8a00\u5e93","text":"<ul> <li>FluentAssertions: \u6d41\u7545\u7684\u65ad\u8a00\u8bed\u6cd5</li> <li>Shouldly: \u66f4\u81ea\u7136\u7684\u65ad\u8a00\u8868\u8fbe</li> </ul>"},{"location":"best-practices/testing-strategy/#_24","title":"\u4ee3\u7801\u8986\u76d6\u7387","text":"<ul> <li>Coverlet: .NET Core\u8986\u76d6\u7387\u5de5\u5177</li> <li>ReportGenerator: \u751f\u6210\u8986\u76d6\u7387\u62a5\u544a</li> </ul>"},{"location":"best-practices/testing-strategy/#_25","title":"\u6700\u4f73\u5b9e\u8df5\u603b\u7ed3","text":"<ol> <li>\u6d4b\u8bd5\u91d1\u5b57\u5854: \u5927\u91cf\u5355\u5143\u6d4b\u8bd5\uff0c\u9002\u91cf\u96c6\u6210\u6d4b\u8bd5\uff0c\u5c11\u91cfE2E\u6d4b\u8bd5</li> <li>AAA\u6a21\u5f0f: \u6240\u6709\u6d4b\u8bd5\u9075\u5faaArrange-Act-Assert\u6a21\u5f0f</li> <li>\u6e05\u6670\u547d\u540d: \u6d4b\u8bd5\u540d\u79f0\u5e94\u8be5\u8868\u8fbe\u6d4b\u8bd5\u610f\u56fe</li> <li>\u5355\u4e00\u804c\u8d23: \u6bcf\u4e2a\u6d4b\u8bd5\u53ea\u6d4b\u8bd5\u4e00\u4e2a\u884c\u4e3a</li> <li>\u72ec\u7acb\u6027: \u6d4b\u8bd5\u4e4b\u95f4\u5e94\u8be5\u76f8\u4e92\u72ec\u7acb</li> <li>\u53ef\u91cd\u590d: \u6d4b\u8bd5\u7ed3\u679c\u5e94\u8be5\u662f\u786e\u5b9a\u7684\u548c\u53ef\u91cd\u590d\u7684</li> <li>\u5feb\u901f\u6267\u884c: \u5355\u5143\u6d4b\u8bd5\u5e94\u8be5\u5feb\u901f\u8fd0\u884c</li> <li>\u6709\u610f\u4e49: \u6d4b\u8bd5\u5e94\u8be5\u9a8c\u8bc1\u771f\u5b9e\u7684\u4e1a\u52a1\u573a\u666f</li> </ol>"},{"location":"best-practices/testing-strategy/#_26","title":"\u76f8\u5173\u6587\u6863","text":"<ul> <li>\u5355\u5143\u6d4b\u8bd5\u5f00\u53d1\u6307\u5357</li> <li>\u805a\u5408\u5f00\u53d1\u6307\u5357</li> <li>\u547d\u4ee4\u5f00\u53d1\u6307\u5357</li> <li>\u67e5\u8be2\u5f00\u53d1\u6307\u5357</li> </ul>"},{"location":"core-concepts/aggregate-root/","title":"\u805a\u5408\u6839 (Aggregate Root)","text":"<p>\u805a\u5408\u6839\u662fDDD\u4e2d\u7684\u91cd\u8981\u6982\u5ff5\uff0c\u5b83\u662f\u805a\u5408\u7684\u5165\u53e3\u70b9\uff0c\u8d1f\u8d23\u7ef4\u62a4\u805a\u5408\u5185\u7684\u6570\u636e\u4e00\u81f4\u6027\u3002</p>"},{"location":"core-concepts/aggregate-root/#_1","title":"\u4ec0\u4e48\u662f\u805a\u5408\u6839","text":"<p>\u805a\u5408\u6839\u662f\u805a\u5408\u7684\u6839\u5b9e\u4f53\uff0c\u6240\u6709\u5bf9\u805a\u5408\u7684\u8bbf\u95ee\u548c\u4fee\u6539\u90fd\u5fc5\u987b\u901a\u8fc7\u805a\u5408\u6839\u3002</p>"},{"location":"core-concepts/aggregate-root/#_2","title":"\u4e3b\u8981\u804c\u8d23","text":"<ol> <li>\u7ef4\u62a4\u4e0d\u53d8\u5f0f: \u786e\u4fdd\u805a\u5408\u5185\u7684\u4e1a\u52a1\u89c4\u5219</li> <li>\u63a7\u5236\u8bbf\u95ee: \u4f5c\u4e3a\u805a\u5408\u7684\u552f\u4e00\u5165\u53e3</li> <li>\u7ba1\u7406\u751f\u547d\u5468\u671f: \u8d1f\u8d23\u521b\u5efa\u548c\u5220\u9664\u805a\u5408\u5185\u7684\u5bf9\u8c61</li> <li>\u53d1\u5e03\u9886\u57df\u4e8b\u4ef6: \u5f53\u91cd\u8981\u4e1a\u52a1\u53d8\u5316\u53d1\u751f\u65f6</li> </ol>"},{"location":"core-concepts/aggregate-root/#_3","title":"\u8bbe\u8ba1\u539f\u5219","text":"<ul> <li>\u805a\u5408\u5e94\u8be5\u5c3d\u53ef\u80fd\u5c0f</li> <li>\u901a\u8fc7ID\u5f15\u7528\u5176\u4ed6\u805a\u5408</li> <li>\u5728\u4e8b\u52a1\u8fb9\u754c\u5185\u66f4\u65b0\u5355\u4e2a\u805a\u5408</li> <li>\u4f7f\u7528\u6700\u7ec8\u4e00\u81f4\u6027\u5904\u7406\u591a\u4e2a\u805a\u5408</li> </ul> <p>(\u66f4\u591a\u5185\u5bb9\u5f85\u8865\u5145)</p>"},{"location":"core-concepts/bounded-context/","title":"\u9650\u754c\u4e0a\u4e0b\u6587 (Bounded Context)","text":""},{"location":"core-concepts/bounded-context/#_1","title":"\u4ec0\u4e48\u662f\u9650\u754c\u4e0a\u4e0b\u6587","text":"<p>\u9650\u754c\u4e0a\u4e0b\u6587\u662fDDD\u6218\u7565\u8bbe\u8ba1\u7684\u6838\u5fc3\u6982\u5ff5\uff0c\u5b83\u5b9a\u4e49\u4e86\u4e00\u4e2a\u660e\u786e\u7684\u8fb9\u754c\uff0c\u5728\u8fd9\u4e2a\u8fb9\u754c\u5185\uff1a</p> <ul> <li>\u7edf\u4e00\u8bed\u8a00\u662f\u4e00\u81f4\u7684: \u76f8\u540c\u7684\u672f\u8bed\u6709\u76f8\u540c\u7684\u542b\u4e49</li> <li>\u6a21\u578b\u662f\u5185\u805a\u7684: \u76f8\u5173\u7684\u6982\u5ff5\u7ec4\u7ec7\u5728\u4e00\u8d77</li> <li>\u89c4\u5219\u662f\u5b8c\u6574\u7684: \u5305\u542b\u5b8c\u6574\u7684\u4e1a\u52a1\u89c4\u5219</li> </ul>"},{"location":"core-concepts/bounded-context/#_2","title":"\u4e3a\u4ec0\u4e48\u9700\u8981\u9650\u754c\u4e0a\u4e0b\u6587","text":"<p>\u5728\u5927\u578b\u7cfb\u7edf\u4e2d\uff0c\u4e0d\u540c\u7684\u56e2\u961f\u548c\u4e1a\u52a1\u9886\u57df\u5bf9\u76f8\u540c\u6982\u5ff5\u53ef\u80fd\u6709\u4e0d\u540c\u7684\u7406\u89e3\uff1a</p> <pre><code>\u8ba2\u5355\u4e0a\u4e0b\u6587\u4e2d\u7684\"\u8ba2\u5355\":\n- \u8ba2\u5355\u53f7\u3001\u5ba2\u6237\u3001\u5546\u54c1\u6e05\u5355\u3001\u603b\u91d1\u989d\n- \u53ef\u4ee5\u63d0\u4ea4\u3001\u652f\u4ed8\u3001\u53d1\u8d27\n\n\u8d22\u52a1\u4e0a\u4e0b\u6587\u4e2d\u7684\"\u8ba2\u5355\":\n- \u53d1\u7968\u53f7\u3001\u5e94\u6536\u8d26\u6b3e\u3001\u6536\u6b3e\u72b6\u6001\n- \u53ef\u4ee5\u5f00\u7968\u3001\u6536\u6b3e\u3001\u5bf9\u8d26\n\n\u7269\u6d41\u4e0a\u4e0b\u6587\u4e2d\u7684\"\u8ba2\u5355\":\n- \u8fd0\u5355\u53f7\u3001\u6536\u8d27\u5730\u5740\u3001\u5305\u88f9\u91cd\u91cf\n- \u53ef\u4ee5\u62e3\u8d27\u3001\u6253\u5305\u3001\u914d\u9001\n</code></pre> <p>\u901a\u8fc7\u9650\u754c\u4e0a\u4e0b\u6587\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u4e0d\u540c\u7684\u4e0a\u4e0b\u6587\u4e2d\u5bf9\"\u8ba2\u5355\"\u6709\u4e0d\u540c\u7684\u6a21\u578b\u548c\u5b9e\u73b0\u3002</p>"},{"location":"core-concepts/bounded-context/#_3","title":"\u8bc6\u522b\u9650\u754c\u4e0a\u4e0b\u6587","text":""},{"location":"core-concepts/bounded-context/#1","title":"\u65b9\u6cd51: \u901a\u8fc7\u4e1a\u52a1\u80fd\u529b","text":"<p>\u6839\u636e\u7ec4\u7ec7\u7684\u4e1a\u52a1\u80fd\u529b\u5212\u5206\uff1a</p> <ul> <li>\u9500\u552e\u4e0a\u4e0b\u6587 (Sales Context)</li> <li>\u5e93\u5b58\u4e0a\u4e0b\u6587 (Inventory Context)</li> <li>\u914d\u9001\u4e0a\u4e0b\u6587 (Shipping Context)</li> <li>\u8d22\u52a1\u4e0a\u4e0b\u6587 (Finance Context)</li> </ul>"},{"location":"core-concepts/bounded-context/#2","title":"\u65b9\u6cd52: \u901a\u8fc7\u56e2\u961f\u7ed3\u6784","text":"<p>\u6309\u7167\u5eb7\u5a01\u5b9a\u5f8b\uff0c\u7cfb\u7edf\u67b6\u6784\u5f80\u5f80\u53cd\u6620\u7ec4\u7ec7\u7ed3\u6784\uff1a</p> <pre><code>\u7535\u5546\u7cfb\u7edf\n\u251c\u2500\u2500 \u524d\u53f0\u56e2\u961f \u2192 \u8d2d\u7269\u4e0a\u4e0b\u6587\n\u251c\u2500\u2500 \u8ba2\u5355\u56e2\u961f \u2192 \u8ba2\u5355\u4e0a\u4e0b\u6587\n\u251c\u2500\u2500 \u4ed3\u50a8\u56e2\u961f \u2192 \u4ed3\u50a8\u4e0a\u4e0b\u6587\n\u2514\u2500\u2500 \u8d22\u52a1\u56e2\u961f \u2192 \u8d22\u52a1\u4e0a\u4e0b\u6587\n</code></pre>"},{"location":"core-concepts/bounded-context/#3","title":"\u65b9\u6cd53: \u901a\u8fc7\u4e8b\u4ef6\u98ce\u66b4","text":"<p>\u4f7f\u7528Event Storming\u8bc6\u522b\u9650\u754c\u4e0a\u4e0b\u6587\u7684\u8fb9\u754c\uff1a</p> <ol> <li>\u8bc6\u522b\u6240\u6709\u9886\u57df\u4e8b\u4ef6</li> <li>\u5c06\u76f8\u5173\u4e8b\u4ef6\u805a\u7c7b</li> <li>\u4e3a\u6bcf\u4e2a\u805a\u7c7b\u5b9a\u4e49\u4e0a\u4e0b\u6587\u8fb9\u754c</li> </ol>"},{"location":"core-concepts/bounded-context/#context-map","title":"\u4e0a\u4e0b\u6587\u6620\u5c04 (Context Map)","text":"<p>\u4e0a\u4e0b\u6587\u6620\u5c04\u63cf\u8ff0\u4e0d\u540c\u9650\u754c\u4e0a\u4e0b\u6587\u4e4b\u95f4\u7684\u5173\u7cfb\uff1a</p>"},{"location":"core-concepts/bounded-context/#1-shared-kernel","title":"1. \u5171\u4eab\u5185\u6838 (Shared Kernel)","text":"<p>\u4e24\u4e2a\u4e0a\u4e0b\u6587\u5171\u4eab\u90e8\u5206\u9886\u57df\u6a21\u578b\u3002</p> <pre><code>\u8ba2\u5355\u4e0a\u4e0b\u6587 \u2190\u2192 \u5e93\u5b58\u4e0a\u4e0b\u6587\n  \u5171\u4eab: Product\u5b9e\u4f53\n</code></pre> <p>\u4f18\u70b9: \u51cf\u5c11\u91cd\u590d \u7f3a\u70b9: \u589e\u52a0\u8026\u5408\uff0c\u9700\u8981\u534f\u8c03\u53d8\u66f4</p>"},{"location":"core-concepts/bounded-context/#2-customer-supplier","title":"2. \u5ba2\u6237-\u4f9b\u5e94\u5546 (Customer-Supplier)","text":"<p>\u4e0b\u6e38\u4e0a\u4e0b\u6587\u4f9d\u8d56\u4e0a\u6e38\u4e0a\u4e0b\u6587\u3002</p> <pre><code>\u8ba2\u5355\u4e0a\u4e0b\u6587 (\u4e0a\u6e38) \u2192 \u914d\u9001\u4e0a\u4e0b\u6587 (\u4e0b\u6e38)\n</code></pre> <p>\u7279\u70b9:  - \u4e0b\u6e38\u662f\u5ba2\u6237\uff0c\u63d0\u51fa\u9700\u6c42 - \u4e0a\u6e38\u662f\u4f9b\u5e94\u5546\uff0c\u63d0\u4f9b\u670d\u52a1 - \u9700\u8981\u534f\u5546\u63a5\u53e3</p>"},{"location":"core-concepts/bounded-context/#3-anti-corruption-layer-acl","title":"3. \u9632\u8150\u5c42 (Anti-Corruption Layer, ACL)","text":"<p>\u4f7f\u7528\u9002\u914d\u5668\u9694\u79bb\u5916\u90e8\u7cfb\u7edf\u3002</p> <pre><code>// \u9632\u8150\u5c42\uff1a\u5c06\u5916\u90e8\u652f\u4ed8\u7cfb\u7edf\u7684\u6a21\u578b\u8f6c\u6362\u4e3a\u5185\u90e8\u6a21\u578b\npublic class PaymentGatewayAdapter\n{\n    private readonly ExternalPaymentClient _client;\n\n    public async Task&lt;PaymentResult&gt; ProcessPayment(Payment payment)\n    {\n        // \u8f6c\u6362\u5185\u90e8\u6a21\u578b\u5230\u5916\u90e8\u6a21\u578b\n        var externalRequest = MapToExternal(payment);\n\n        // \u8c03\u7528\u5916\u90e8\u7cfb\u7edf\n        var externalResponse = await _client.Pay(externalRequest);\n\n        // \u8f6c\u6362\u5916\u90e8\u54cd\u5e94\u5230\u5185\u90e8\u6a21\u578b\n        return MapToInternal(externalResponse);\n    }\n}\n</code></pre>"},{"location":"core-concepts/bounded-context/#4-conformist","title":"4. \u9075\u5faa\u8005 (Conformist)","text":"<p>\u4e0b\u6e38\u5b8c\u5168\u9075\u5faa\u4e0a\u6e38\u7684\u6a21\u578b\u3002</p> <pre><code>\u5185\u90e8\u8ba2\u5355\u7cfb\u7edf \u2192 \u7b2c\u4e09\u65b9ERP\u7cfb\u7edf (\u9075\u5faa)\n</code></pre> <p>\u9002\u7528\u573a\u666f: \u5916\u90e8\u7cfb\u7edf\u5f3a\u5927\u4f46\u65e0\u6cd5\u4fee\u6539</p>"},{"location":"core-concepts/bounded-context/#5-open-host-service","title":"5. \u5f00\u653e\u4e3b\u673a\u670d\u52a1 (Open Host Service)","text":"<p>\u5b9a\u4e49\u6807\u51c6\u534f\u8bae\u4f9b\u591a\u4e2a\u4e0b\u6e38\u4f7f\u7528\u3002</p> <pre><code>// RESTful API\u4f5c\u4e3a\u5f00\u653e\u4e3b\u673a\u670d\u52a1\n[ApiController]\n[Route(\"api/orders\")]\npublic class OrdersApiController\n{\n    [HttpGet(\"{id}\")]\n    public async Task&lt;OrderDto&gt; GetOrder(Guid id)\n    {\n        // \u63d0\u4f9b\u6807\u51c6\u7684Order\u8868\u793a\n    }\n}\n</code></pre>"},{"location":"core-concepts/bounded-context/#6-published-language","title":"6. \u53d1\u5e03\u8bed\u8a00 (Published Language)","text":"<p>\u4f7f\u7528\u6807\u51c6\u5316\u7684\u6570\u636e\u683c\u5f0f\u4ea4\u6362\u4fe1\u606f\u3002</p> <pre><code>// \u4f7f\u7528\u6807\u51c6\u7684\u8ba2\u5355JSON\u683c\u5f0f\n{\n  \"orderId\": \"ORD-2024-001\",\n  \"orderDate\": \"2024-01-01T10:00:00Z\",\n  \"items\": [...]\n}\n</code></pre>"},{"location":"core-concepts/bounded-context/#7-separate-ways","title":"7. \u5404\u884c\u5176\u9053 (Separate Ways)","text":"<p>\u4e24\u4e2a\u4e0a\u4e0b\u6587\u5b8c\u5168\u72ec\u7acb\uff0c\u6ca1\u6709\u96c6\u6210\u3002</p> <pre><code>\u5185\u90e8CRM\u7cfb\u7edf    \u5916\u90e8\u8425\u9500\u7cfb\u7edf\n    (\u72ec\u7acb)          (\u72ec\u7acb)\n</code></pre>"},{"location":"core-concepts/bounded-context/#8-big-ball-of-mud","title":"8. \u5927\u6ce5\u7403 (Big Ball of Mud)","text":"<p>\u65e0\u8fb9\u754c\u7684\u6df7\u4e71\u7cfb\u7edf\uff08\u5e94\u8be5\u907f\u514d\uff09\u3002</p>"},{"location":"core-concepts/bounded-context/#_4","title":"\u9650\u754c\u4e0a\u4e0b\u6587\u7684\u5b9e\u73b0","text":""},{"location":"core-concepts/bounded-context/#_5","title":"\u7269\u7406\u8fb9\u754c","text":"<p>\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u65b9\u5f0f\u5b9e\u73b0\u7269\u7406\u8fb9\u754c\uff1a</p>"},{"location":"core-concepts/bounded-context/#1_1","title":"1. \u5fae\u670d\u52a1","text":"<pre><code>\u8ba2\u5355\u670d\u52a1 (Order Service)\n  \u251c\u2500\u2500 OrderAPI\n  \u251c\u2500\u2500 OrderDB\n  \u2514\u2500\u2500 \u72ec\u7acb\u90e8\u7f72\n\n\u5e93\u5b58\u670d\u52a1 (Inventory Service)\n  \u251c\u2500\u2500 InventoryAPI\n  \u251c\u2500\u2500 InventoryDB\n  \u2514\u2500\u2500 \u72ec\u7acb\u90e8\u7f72\n</code></pre>"},{"location":"core-concepts/bounded-context/#2_1","title":"2. \u6a21\u5757","text":"<p>\u5728\u5355\u4f53\u5e94\u7528\u4e2d\u901a\u8fc7\u6a21\u5757\u5212\u5206\uff1a</p> <pre><code>MyApp/\n\u251c\u2500\u2500 Modules/\n\u2502   \u251c\u2500\u2500 Sales/          # \u9500\u552e\u4e0a\u4e0b\u6587\n\u2502   \u251c\u2500\u2500 Inventory/      # \u5e93\u5b58\u4e0a\u4e0b\u6587\n\u2502   \u2514\u2500\u2500 Shipping/       # \u914d\u9001\u4e0a\u4e0b\u6587\n</code></pre>"},{"location":"core-concepts/bounded-context/#3_1","title":"3. \u4ee3\u7801\u7ed3\u6784","text":"<pre><code>namespace MyCompany.ECommerce.Sales          // \u9500\u552e\u4e0a\u4e0b\u6587\nnamespace MyCompany.ECommerce.Inventory     // \u5e93\u5b58\u4e0a\u4e0b\u6587\nnamespace MyCompany.ECommerce.Shipping      // \u914d\u9001\u4e0a\u4e0b\u6587\n</code></pre>"},{"location":"core-concepts/bounded-context/#_6","title":"\u96c6\u6210\u6a21\u5f0f","text":""},{"location":"core-concepts/bounded-context/#1-rest-api","title":"1. REST API","text":"<pre><code>// \u8ba2\u5355\u4e0a\u4e0b\u6587\u8c03\u7528\u5e93\u5b58\u4e0a\u4e0b\u6587\npublic class InventoryClient\n{\n    private readonly HttpClient _httpClient;\n\n    public async Task&lt;bool&gt; CheckStock(ProductId productId, int quantity)\n    {\n        var response = await _httpClient.GetAsync(\n            $\"api/inventory/products/{productId}/stock\");\n\n        var stock = await response.Content.ReadAsAsync&lt;StockInfo&gt;();\n        return stock.Available &gt;= quantity;\n    }\n}\n</code></pre>"},{"location":"core-concepts/bounded-context/#2_2","title":"2. \u6d88\u606f\u961f\u5217","text":"<pre><code>// \u8ba2\u5355\u4e0a\u4e0b\u6587\u53d1\u5e03\u4e8b\u4ef6\npublic class OrderService\n{\n    private readonly IEventBus _eventBus;\n\n    public async Task SubmitOrder(Order order)\n    {\n        order.Submit();\n\n        // \u53d1\u5e03\u96c6\u6210\u4e8b\u4ef6\n        await _eventBus.Publish(new OrderSubmittedIntegrationEvent\n        {\n            OrderId = order.Id,\n            Items = order.Items.Select(i =&gt; new OrderItemDto(...))\n        });\n    }\n}\n\n// \u5e93\u5b58\u4e0a\u4e0b\u6587\u8ba2\u9605\u4e8b\u4ef6\npublic class OrderSubmittedEventHandler : IIntegrationEventHandler&lt;OrderSubmittedIntegrationEvent&gt;\n{\n    public async Task Handle(OrderSubmittedIntegrationEvent @event)\n    {\n        // \u6263\u51cf\u5e93\u5b58\n        await _inventoryService.ReserveStock(@event.Items);\n    }\n}\n</code></pre>"},{"location":"core-concepts/bounded-context/#_7","title":"\u5b9e\u8df5\u5efa\u8bae","text":""},{"location":"core-concepts/bounded-context/#1_2","title":"1. \u4ece\u7c97\u7c92\u5ea6\u5f00\u59cb","text":"<p>\u521d\u671f\u53ef\u4ee5\u6709\u8f83\u5927\u7684\u4e0a\u4e0b\u6587\uff0c\u968f\u7740\u7406\u89e3\u6df1\u5165\u518d\u62c6\u5206\u3002</p>"},{"location":"core-concepts/bounded-context/#2_3","title":"2. \u6839\u636e\u53d8\u5316\u901f\u7387\u5212\u5206","text":"<p>\u53d8\u5316\u9891\u7e41\u7684\u90e8\u5206\u5e94\u8be5\u72ec\u7acb\u51fa\u6765\u3002</p>"},{"location":"core-concepts/bounded-context/#3_2","title":"3. \u8003\u8651\u56e2\u961f\u7ed3\u6784","text":"<p>\u4e0a\u4e0b\u6587\u8fb9\u754c\u5e94\u8be5\u4e0e\u56e2\u961f\u8fb9\u754c\u5bf9\u9f50\u3002</p>"},{"location":"core-concepts/bounded-context/#4","title":"4. \u660e\u786e\u96c6\u6210\u65b9\u5f0f","text":"<p>\u5728\u4e0a\u4e0b\u6587\u6620\u5c04\u4e2d\u660e\u786e\u96c6\u6210\u6a21\u5f0f\u548c\u8d23\u4efb\u3002</p>"},{"location":"core-concepts/bounded-context/#5","title":"5. \u6301\u7eed\u6f14\u8fdb","text":"<p>\u968f\u7740\u4e1a\u52a1\u53d1\u5c55\uff0c\u5b9a\u671f\u5ba1\u89c6\u548c\u8c03\u6574\u4e0a\u4e0b\u6587\u8fb9\u754c\u3002</p>"},{"location":"core-concepts/bounded-context/#_8","title":"\u6848\u4f8b\uff1a\u7535\u5546\u7cfb\u7edf","text":"<pre><code>\u7535\u5546\u7cfb\u7edf\u7684\u9650\u754c\u4e0a\u4e0b\u6587\u5212\u5206\uff1a\n\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510       \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502   \u9500\u552e\u4e0a\u4e0b\u6587   \u2502\u2500\u2500\u2500\u2500\u2500\u2500\u2192\u2502   \u5e93\u5b58\u4e0a\u4e0b\u6587   \u2502\n\u2502   (Sales)    \u2502       \u2502  (Inventory) \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518       \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n      \u2193                       \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510       \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502   \u8ba2\u5355\u4e0a\u4e0b\u6587   \u2502\u2500\u2500\u2500\u2500\u2500\u2500\u2192\u2502   \u914d\u9001\u4e0a\u4e0b\u6587   \u2502\n\u2502   (Order)    \u2502       \u2502  (Shipping)  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518       \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n      \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502   \u652f\u4ed8\u4e0a\u4e0b\u6587   \u2502\n\u2502  (Payment)   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n\u5173\u7cfb\u8bf4\u660e\uff1a\n- \u9500\u552e \u2192 \u5e93\u5b58: \u68c0\u67e5\u5e93\u5b58\uff08\u5ba2\u6237-\u4f9b\u5e94\u5546\uff09\n- \u8ba2\u5355 \u2192 \u914d\u9001: \u521b\u5efa\u8fd0\u5355\uff08\u5ba2\u6237-\u4f9b\u5e94\u5546\uff09\n- \u8ba2\u5355 \u2192 \u652f\u4ed8: \u5904\u7406\u652f\u4ed8\uff08\u5f00\u653e\u4e3b\u673a\u670d\u52a1\uff09\n</code></pre>"},{"location":"core-concepts/bounded-context/#_9","title":"\u4e0b\u4e00\u6b65","text":"<ul> <li>\u805a\u5408\u6839 - \u4e0a\u4e0b\u6587\u5185\u7684\u6570\u636e\u4e00\u81f4\u6027\u8fb9\u754c</li> <li>\u9886\u57df\u4e8b\u4ef6 - \u4e0a\u4e0b\u6587\u95f4\u7684\u89e3\u8026\u901a\u4fe1</li> <li>\u4e8b\u4ef6\u9a71\u52a8\u67b6\u6784 - \u8de8\u4e0a\u4e0b\u6587\u96c6\u6210</li> </ul>"},{"location":"core-concepts/domain-events/","title":"\u9886\u57df\u4e8b\u4ef6 (Domain Events)","text":"<p>\u9886\u57df\u4e8b\u4ef6\u8868\u793a\u5728\u9886\u57df\u4e2d\u53d1\u751f\u7684\u91cd\u8981\u4e1a\u52a1\u4e8b\u4ef6\u3002</p>"},{"location":"core-concepts/domain-events/#_1","title":"\u7279\u70b9","text":"<ul> <li>\u8fc7\u53bb\u5f0f\u547d\u540d\uff08\u5df2\u53d1\u751f\u7684\u4e8b\u60c5\uff09</li> <li>\u4e0d\u53ef\u53d8</li> <li>\u5305\u542b\u4e8b\u4ef6\u53d1\u751f\u7684\u4e0a\u4e0b\u6587\u4fe1\u606f</li> </ul> <p>(\u66f4\u591a\u5185\u5bb9\u5f85\u8865\u5145)</p>"},{"location":"core-concepts/domain-model/","title":"\u9886\u57df\u6a21\u578b","text":""},{"location":"core-concepts/domain-model/#_2","title":"\u4ec0\u4e48\u662f\u9886\u57df\u6a21\u578b","text":"<p>\u9886\u57df\u6a21\u578b(Domain Model)\u662f\u5bf9\u4e1a\u52a1\u9886\u57df\u7684\u62bd\u8c61\u8868\u8fbe\uff0c\u5b83\u5c06\u73b0\u5b9e\u4e16\u754c\u7684\u4e1a\u52a1\u6982\u5ff5\u3001\u89c4\u5219\u548c\u6d41\u7a0b\u7528\u4ee3\u7801\u7684\u5f62\u5f0f\u8868\u8fbe\u51fa\u6765\u3002\u9886\u57df\u6a21\u578b\u662fDDD\u7684\u6838\u5fc3\uff0c\u5b83\u5e94\u8be5\uff1a</p> <ul> <li>\u53cd\u6620\u4e1a\u52a1\u6982\u5ff5: \u4f7f\u7528\u4e1a\u52a1\u9886\u57df\u7684\u8bed\u8a00\u548c\u6982\u5ff5</li> <li>\u5305\u542b\u4e1a\u52a1\u89c4\u5219: \u5c01\u88c5\u4e1a\u52a1\u903b\u8f91\u548c\u7ea6\u675f</li> <li>\u72ec\u7acb\u4e8e\u6280\u672f: \u4e0d\u4f9d\u8d56\u7279\u5b9a\u7684\u6280\u672f\u5b9e\u73b0</li> <li>\u6613\u4e8e\u7406\u89e3: \u4ee3\u7801\u5373\u6587\u6863\uff0c\u6e05\u6670\u8868\u8fbe\u4e1a\u52a1\u610f\u56fe</li> </ul>"},{"location":"core-concepts/domain-model/#_3","title":"\u9886\u57df\u6a21\u578b\u7684\u7ec4\u6210","text":"<p>\u4e00\u4e2a\u5b8c\u6574\u7684\u9886\u57df\u6a21\u578b\u901a\u5e38\u5305\u542b\u4ee5\u4e0b\u5143\u7d20\uff1a</p>"},{"location":"core-concepts/domain-model/#1-entity","title":"1. \u5b9e\u4f53 (Entity)","text":"<p>\u5177\u6709\u552f\u4e00\u6807\u8bc6\u7684\u5bf9\u8c61\uff0c\u5373\u4f7f\u5c5e\u6027\u76f8\u540c\uff0c\u4e0d\u540c\u7684\u5b9e\u4f53\u4e5f\u662f\u4e0d\u540c\u7684\u5bf9\u8c61\u3002</p> <pre><code>public class Customer : Entity&lt;CustomerId&gt;\n{\n    public string Name { get; private set; }\n    public Email Email { get; private set; }\n    public CustomerStatus Status { get; private set; }\n\n    public void Activate()\n    {\n        if (Status == CustomerStatus.Active)\n            throw new DomainException(\"Customer is already active\");\n\n        Status = CustomerStatus.Active;\n    }\n}\n</code></pre>"},{"location":"core-concepts/domain-model/#2-value-object","title":"2. \u503c\u5bf9\u8c61 (Value Object)","text":"<p>\u6ca1\u6709\u552f\u4e00\u6807\u8bc6\uff0c\u53ea\u5173\u6ce8\u5c5e\u6027\u503c\u7684\u5bf9\u8c61\u3002\u503c\u5bf9\u8c61\u662f\u4e0d\u53ef\u53d8\u7684\u3002</p> <pre><code>public record Email\n{\n    public string Value { get; }\n\n    public Email(string value)\n    {\n        if (string.IsNullOrWhiteSpace(value))\n            throw new ArgumentException(\"Email cannot be empty\");\n\n        if (!IsValidEmail(value))\n            throw new ArgumentException(\"Invalid email format\");\n\n        Value = value;\n    }\n\n    private static bool IsValidEmail(string email)\n    {\n        // \u90ae\u7bb1\u9a8c\u8bc1\u903b\u8f91\n        return Regex.IsMatch(email, @\"^[^@\\s]+@[^@\\s]+\\.[^@\\s]+$\");\n    }\n}\n</code></pre>"},{"location":"core-concepts/domain-model/#3-aggregate","title":"3. \u805a\u5408 (Aggregate)","text":"<p>\u4e00\u7ec4\u76f8\u5173\u5bf9\u8c61\u7684\u96c6\u5408\uff0c\u4f5c\u4e3a\u6570\u636e\u4fee\u6539\u7684\u5355\u5143\u3002\u805a\u5408\u786e\u4fdd\u4e86\u4e1a\u52a1\u4e0d\u53d8\u5f0f(Invariant)\u3002</p> <pre><code>public class Order : AggregateRoot&lt;OrderId&gt;\n{\n    private readonly List&lt;OrderLine&gt; _lines = new();\n    public IReadOnlyCollection&lt;OrderLine&gt; Lines =&gt; _lines.AsReadOnly();\n\n    public Money TotalAmount =&gt; Money.Sum(_lines.Select(l =&gt; l.Amount));\n\n    public void AddLine(ProductId productId, Quantity quantity, Money unitPrice)\n    {\n        // \u4e1a\u52a1\u89c4\u5219\uff1a\u4e0d\u80fd\u6dfb\u52a0\u91cd\u590d\u4ea7\u54c1\n        if (_lines.Any(l =&gt; l.ProductId == productId))\n            throw new DomainException(\"Product already exists in order\");\n\n        var line = new OrderLine(productId, quantity, unitPrice);\n        _lines.Add(line);\n    }\n}\n</code></pre>"},{"location":"core-concepts/domain-model/#4-domain-service","title":"4. \u9886\u57df\u670d\u52a1 (Domain Service)","text":"<p>\u4e0d\u5c5e\u4e8e\u4efb\u4f55\u5b9e\u4f53\u6216\u503c\u5bf9\u8c61\u7684\u4e1a\u52a1\u903b\u8f91\u3002</p> <pre><code>public class PriceCalculationService\n{\n    public Money CalculateOrderTotal(Order order, Customer customer)\n    {\n        var subtotal = order.TotalAmount;\n        var discount = customer.VipLevel.GetDiscount();\n\n        return subtotal * (1 - discount);\n    }\n}\n</code></pre>"},{"location":"core-concepts/domain-model/#_4","title":"\u8bbe\u8ba1\u539f\u5219","text":""},{"location":"core-concepts/domain-model/#1-vs","title":"1. \u5145\u8840\u6a21\u578b vs \u8d2b\u8840\u6a21\u578b","text":"<p>\u274c \u8d2b\u8840\u6a21\u578b (Anemic Model) - \u5e94\u8be5\u907f\u514d</p> <pre><code>// \u9519\u8bef\u793a\u4f8b\uff1a\u53ea\u6709\u6570\u636e\uff0c\u6ca1\u6709\u884c\u4e3a\npublic class Order\n{\n    public Guid Id { get; set; }\n    public string Status { get; set; }\n    public List&lt;OrderLine&gt; Lines { get; set; }\n}\n\n// \u4e1a\u52a1\u903b\u8f91\u5206\u6563\u5728\u670d\u52a1\u4e2d\npublic class OrderService\n{\n    public void Submit(Order order)\n    {\n        if (order.Status != \"Draft\")\n            throw new Exception(\"Invalid status\");\n        order.Status = \"Submitted\";\n    }\n}\n</code></pre> <p>\u2705 \u5145\u8840\u6a21\u578b (Rich Model) - \u63a8\u8350</p> <pre><code>// \u6b63\u786e\u793a\u4f8b\uff1a\u5c01\u88c5\u6570\u636e\u548c\u884c\u4e3a\npublic class Order : AggregateRoot&lt;OrderId&gt;\n{\n    public OrderStatus Status { get; private set; }\n    private readonly List&lt;OrderLine&gt; _lines = new();\n\n    public void Submit()\n    {\n        if (Status != OrderStatus.Draft)\n            throw new DomainException(\"Only draft orders can be submitted\");\n\n        Status = OrderStatus.Submitted;\n        RaiseDomainEvent(new OrderSubmittedEvent(Id));\n    }\n}\n</code></pre>"},{"location":"core-concepts/domain-model/#2","title":"2. \u7edf\u4e00\u8bed\u8a00","text":"<p>\u4f7f\u7528\u4e1a\u52a1\u9886\u57df\u7684\u672f\u8bed\u547d\u540d\u7c7b\u3001\u65b9\u6cd5\u548c\u5c5e\u6027\u3002</p> <pre><code>// \u2705 \u597d\u7684\u547d\u540d\npublic class Invoice\n{\n    public void Issue() { }\n    public void Cancel() { }\n    public void MarkAsPaid() { }\n}\n\n// \u274c \u5dee\u7684\u547d\u540d\npublic class Invoice\n{\n    public void Process() { }  // \u592a\u6a21\u7cca\n    public void Delete() { }   // \u4e0d\u662f\u4e1a\u52a1\u672f\u8bed\n    public void SetStatus(int status) { }  // \u66b4\u9732\u5b9e\u73b0\u7ec6\u8282\n}\n</code></pre>"},{"location":"core-concepts/domain-model/#3","title":"3. \u5c01\u88c5","text":"<p>\u9690\u85cf\u5185\u90e8\u72b6\u6001\uff0c\u53ea\u66b4\u9732\u5fc5\u8981\u7684\u884c\u4e3a\u3002</p> <pre><code>public class BankAccount\n{\n    public Money Balance { get; private set; }\n\n    // \u2705 \u63d0\u4f9b\u4e1a\u52a1\u65b9\u6cd5\n    public void Deposit(Money amount)\n    {\n        if (amount.Value &lt;= 0)\n            throw new DomainException(\"Deposit amount must be positive\");\n\n        Balance = Balance.Add(amount);\n    }\n\n    // \u274c \u4e0d\u8981\u66b4\u9732setter\n    // public void SetBalance(Money balance) { }\n}\n</code></pre>"},{"location":"core-concepts/domain-model/#4-invariant","title":"4. \u4e0d\u53d8\u5f0f (Invariant)","text":"<p>\u786e\u4fdd\u9886\u57df\u5bf9\u8c61\u59cb\u7ec8\u5904\u4e8e\u6709\u6548\u72b6\u6001\u3002</p> <pre><code>public class ShoppingCart\n{\n    private readonly List&lt;CartItem&gt; _items = new();\n    public IReadOnlyCollection&lt;CartItem&gt; Items =&gt; _items.AsReadOnly();\n\n    // \u4e0d\u53d8\u5f0f\uff1a\u8d2d\u7269\u8f66\u6700\u591a10\u4e2a\u5546\u54c1\n    private const int MaxItems = 10;\n\n    public void AddItem(ProductId productId, int quantity)\n    {\n        if (_items.Count &gt;= MaxItems)\n            throw new DomainException($\"Cart cannot have more than {MaxItems} items\");\n\n        // \u5176\u4ed6\u4e1a\u52a1\u903b\u8f91...\n    }\n}\n</code></pre>"},{"location":"core-concepts/domain-model/#_5","title":"\u9886\u57df\u6a21\u578b\u7684\u751f\u547d\u5468\u671f","text":""},{"location":"core-concepts/domain-model/#1","title":"1. \u521b\u5efa","text":"<p>\u4f7f\u7528\u5de5\u5382\u65b9\u6cd5\u6216\u6784\u9020\u51fd\u6570\u521b\u5efa\u5bf9\u8c61\uff0c\u786e\u4fdd\u5bf9\u8c61\u521b\u5efa\u65f6\u5c31\u662f\u6709\u6548\u7684\u3002</p> <pre><code>public class Order\n{\n    // \u79c1\u6709\u6784\u9020\u51fd\u6570\n    private Order(CustomerId customerId)\n    {\n        Id = OrderId.New();\n        CustomerId = customerId;\n        Status = OrderStatus.Draft;\n        CreatedAt = DateTime.UtcNow;\n    }\n\n    // \u5de5\u5382\u65b9\u6cd5\n    public static Order CreateFor(Customer customer)\n    {\n        if (!customer.IsActive)\n            throw new DomainException(\"Cannot create order for inactive customer\");\n\n        return new Order(customer.Id);\n    }\n}\n</code></pre>"},{"location":"core-concepts/domain-model/#2_1","title":"2. \u4fee\u6539","text":"<p>\u901a\u8fc7\u9886\u57df\u65b9\u6cd5\u4fee\u6539\u72b6\u6001\uff0c\u800c\u4e0d\u662f\u76f4\u63a5\u4fee\u6539\u5c5e\u6027\u3002</p> <pre><code>// \u2705 \u901a\u8fc7\u65b9\u6cd5\u4fee\u6539\norder.Submit();\norder.AddItem(productId, quantity);\norder.ApplyDiscount(discountCode);\n\n// \u274c \u4e0d\u8981\u76f4\u63a5\u4fee\u6539\n// order.Status = OrderStatus.Submitted;\n</code></pre>"},{"location":"core-concepts/domain-model/#3_1","title":"3. \u5220\u9664","text":"<p>\u6839\u636e\u4e1a\u52a1\u9700\u6c42\u51b3\u5b9a\u662f\u7269\u7406\u5220\u9664\u8fd8\u662f\u903b\u8f91\u5220\u9664\u3002</p> <pre><code>public class Customer\n{\n    public bool IsDeleted { get; private set; }\n\n    public void Delete()\n    {\n        if (HasActiveOrders())\n            throw new DomainException(\"Cannot delete customer with active orders\");\n\n        IsDeleted = true;\n        RaiseDomainEvent(new CustomerDeletedEvent(Id));\n    }\n}\n</code></pre>"},{"location":"core-concepts/domain-model/#_6","title":"\u5b9e\u8df5\u5efa\u8bae","text":""},{"location":"core-concepts/domain-model/#1_1","title":"1. \u4ece\u4e1a\u52a1\u51fa\u53d1","text":"<p>\u4e0e\u9886\u57df\u4e13\u5bb6\u6c9f\u901a\uff0c\u7406\u89e3\u4e1a\u52a1\u6982\u5ff5\u548c\u89c4\u5219\uff0c\u7136\u540e\u518d\u7f16\u5199\u4ee3\u7801\u3002</p>"},{"location":"core-concepts/domain-model/#2_2","title":"2. \u8fed\u4ee3\u6f14\u8fdb","text":"<p>\u9886\u57df\u6a21\u578b\u4e0d\u662f\u4e00\u6b21\u6027\u8bbe\u8ba1\u5b8c\u6210\u7684\uff0c\u8981\u6839\u636e\u5bf9\u4e1a\u52a1\u7684\u7406\u89e3\u4e0d\u65ad\u8fed\u4ee3\u6539\u8fdb\u3002</p>"},{"location":"core-concepts/domain-model/#3_2","title":"3. \u5355\u5143\u6d4b\u8bd5","text":"<p>\u4e3a\u9886\u57df\u6a21\u578b\u7f16\u5199\u5145\u5206\u7684\u5355\u5143\u6d4b\u8bd5\uff0c\u786e\u4fdd\u4e1a\u52a1\u89c4\u5219\u6b63\u786e\u5b9e\u73b0\u3002</p> <pre><code>[Test]\npublic void Submit_DraftOrder_ShouldChangeStatusToSubmitted()\n{\n    // Arrange\n    var order = Order.CreateFor(customer);\n\n    // Act\n    order.Submit();\n\n    // Assert\n    Assert.Equal(OrderStatus.Submitted, order.Status);\n}\n\n[Test]\npublic void Submit_AlreadySubmittedOrder_ShouldThrowException()\n{\n    // Arrange\n    var order = Order.CreateFor(customer);\n    order.Submit();\n\n    // Act &amp; Assert\n    Assert.Throws&lt;DomainException&gt;(() =&gt; order.Submit());\n}\n</code></pre>"},{"location":"core-concepts/domain-model/#4","title":"4. \u4fdd\u6301\u7b80\u5355","text":"<p>\u4e0d\u8981\u8fc7\u5ea6\u8bbe\u8ba1\uff0c\u4ece\u7b80\u5355\u5f00\u59cb\uff0c\u6839\u636e\u9700\u8981\u9010\u6b65\u589e\u52a0\u590d\u6742\u5ea6\u3002</p>"},{"location":"core-concepts/domain-model/#_7","title":"\u5e38\u89c1\u9519\u8bef","text":""},{"location":"core-concepts/domain-model/#1_2","title":"\u274c 1. \u8d2b\u8840\u6a21\u578b","text":"<p>\u9886\u57df\u5bf9\u8c61\u53ea\u6709getter/setter\uff0c\u6ca1\u6709\u4e1a\u52a1\u884c\u4e3a\u3002</p>"},{"location":"core-concepts/domain-model/#2_3","title":"\u274c 2. \u6280\u672f\u6cc4\u9732","text":"<p>\u5728\u9886\u57df\u6a21\u578b\u4e2d\u5f15\u7528\u57fa\u7840\u8bbe\u65bd\u7ec6\u8282\uff08\u5982\u6570\u636e\u5e93\u3001HTTP\u7b49\uff09\u3002</p>"},{"location":"core-concepts/domain-model/#3_3","title":"\u274c 3. \u8fc7\u5ea6\u62bd\u8c61","text":"<p>\u4e3a\u4e86\"\u7075\u6d3b\u6027\"\u800c\u5f15\u5165\u4e0d\u5fc5\u8981\u7684\u62bd\u8c61\u5c42\u3002</p>"},{"location":"core-concepts/domain-model/#4_1","title":"\u274c 4. \u5ffd\u89c6\u4e0d\u53d8\u5f0f","text":"<p>\u5141\u8bb8\u5bf9\u8c61\u8fdb\u5165\u65e0\u6548\u72b6\u6001\u3002</p>"},{"location":"core-concepts/domain-model/#_8","title":"\u4e0b\u4e00\u6b65","text":"<ul> <li>\u9650\u754c\u4e0a\u4e0b\u6587 - \u4e86\u89e3\u5982\u4f55\u5212\u5206\u9886\u57df\u8fb9\u754c</li> <li>\u805a\u5408\u6839 - \u6df1\u5165\u7406\u89e3\u805a\u5408\u8bbe\u8ba1</li> <li>\u5b9e\u4f53\u4e0e\u503c\u5bf9\u8c61 - \u533a\u5206\u4e24\u79cd\u9886\u57df\u5bf9\u8c61</li> <li>\u9886\u57df\u4e8b\u4ef6 - \u4f7f\u7528\u4e8b\u4ef6\u89e3\u8026\u4e1a\u52a1\u6d41\u7a0b</li> </ul>"},{"location":"core-concepts/entity-value-object/","title":"\u5b9e\u4f53\u4e0e\u503c\u5bf9\u8c61","text":""},{"location":"core-concepts/entity-value-object/#entity","title":"\u5b9e\u4f53 (Entity)","text":"<p>\u5b9e\u4f53\u662f\u5177\u6709\u552f\u4e00\u6807\u8bc6\u7684\u9886\u57df\u5bf9\u8c61\u3002</p>"},{"location":"core-concepts/entity-value-object/#value-object","title":"\u503c\u5bf9\u8c61 (Value Object)","text":"<p>\u503c\u5bf9\u8c61\u662f\u6ca1\u6709\u552f\u4e00\u6807\u8bc6\uff0c\u53ea\u5173\u6ce8\u5c5e\u6027\u7684\u4e0d\u53ef\u53d8\u5bf9\u8c61\u3002</p> <p>(\u66f4\u591a\u5185\u5bb9\u5f85\u8865\u5145)</p>"},{"location":"core-concepts/repository-pattern/","title":"\u4ed3\u50a8\u6a21\u5f0f (Repository Pattern)","text":"<p>\u4ed3\u50a8\u6a21\u5f0f\u63d0\u4f9b\u4e86\u4e00\u4e2a\u96c6\u5408\u5f0f\u7684\u63a5\u53e3\u6765\u8bbf\u95ee\u805a\u5408\u6839\u3002</p>"},{"location":"core-concepts/repository-pattern/#_1","title":"\u76ee\u7684","text":"<ul> <li>\u5c01\u88c5\u6570\u636e\u8bbf\u95ee\u903b\u8f91</li> <li>\u63d0\u4f9b\u9886\u57df\u6a21\u578b\u4e0e\u6570\u636e\u6620\u5c04\u4e4b\u95f4\u7684\u4e2d\u4ecb</li> <li>\u652f\u6301\u5355\u5143\u6d4b\u8bd5</li> </ul> <p>(\u66f4\u591a\u5185\u5bb9\u5f85\u8865\u5145)</p>"},{"location":"development-guide/aggregate-development/","title":"\u805a\u5408\u4e0e\u5f3a\u7c7b\u578bID\u5f00\u53d1\u6307\u5357","text":""},{"location":"development-guide/aggregate-development/#_1","title":"\u4ec0\u4e48\u662f\u805a\u5408\u6839\uff1f","text":"<p>\u805a\u5408\u6839\u662f DDD \u4e2d\u7684\u6838\u5fc3\u6982\u5ff5\uff0c\u4ee3\u8868\u4e00\u7ec4\u76f8\u5173\u5bf9\u8c61\u7684\u6839\u5b9e\u4f53\uff0c\u8d1f\u8d23\u7ef4\u62a4\u4e1a\u52a1\u89c4\u5219\u548c\u6570\u636e\u4e00\u81f4\u6027\u3002\u5728\u672c\u6a21\u677f\u4e2d\uff0c\u6240\u6709\u805a\u5408\u6839\u90fd\u7ee7\u627f\u81ea <code>Entity&lt;TId&gt;</code> \u5e76\u5b9e\u73b0 <code>IAggregateRoot</code> \u63a5\u53e3\u3002\u540c\u65f6\uff0c\u672c\u6a21\u677f\u4f7f\u7528\u5f3a\u7c7b\u578bID\u63d0\u4f9b\u7c7b\u578b\u5b89\u5168\uff0c\u907f\u514d\u4e86\u4e0d\u540c\u5b9e\u4f53ID\u4e4b\u95f4\u7684\u6df7\u6dc6\u3002</p>"},{"location":"development-guide/aggregate-development/#_2","title":"\u805a\u5408\u6839\u6587\u4ef6\u5e94\u8be5\u653e\u5728\u54ea\u91cc\uff1f","text":"<p>\u805a\u5408\u6839\u6587\u4ef6\u5e94\u9075\u5faa\u4ee5\u4e0b\u7ec4\u7ec7\u89c4\u5219\uff1a</p> <ul> <li>\u5e94\u653e\u7f6e\u5728 <code>src/{ProjectName}.Domain/AggregatesModel/{AggregateName}Aggregate/</code> \u76ee\u5f55\u4e0b</li> <li>\u4f8b\u5982 <code>src/MyProject.Domain/AggregatesModel/UserAggregate/User.cs</code></li> <li>\u6bcf\u4e2a\u805a\u5408\u5728\u72ec\u7acb\u6587\u4ef6\u5939\u4e2d</li> <li>\u805a\u5408\u6839\u7c7b\u540d\u4e0e\u6587\u4ef6\u540d\u4e00\u81f4</li> <li>\u5f3a\u7c7b\u578bID\u4e0e\u805a\u5408\u6839\u5b9a\u4e49\u5728\u540c\u4e00\u6587\u4ef6\u4e2d</li> </ul>"},{"location":"development-guide/aggregate-development/#id_1","title":"\u5982\u4f55\u5b9a\u4e49\u5f3a\u7c7b\u578bID\uff1f","text":"<p>\u5f3a\u7c7b\u578bID\u7684\u5b9a\u4e49\u5e94\u9075\u5faa\u4ee5\u4e0b\u89c4\u5219\uff1a</p> <ul> <li>\u4f7f\u7528 <code>IInt64StronglyTypedId</code> \u6216 <code>IGuidStronglyTypedId</code> \u63a5\u53e3</li> <li>\u4f7f\u7528 <code>partial record</code> \u58f0\u660e\uff0c\u8ba9\u6846\u67b6\u751f\u6210\u5177\u4f53\u5b9e\u73b0</li> <li>\u5fc5\u987b\u662fpublic\u7c7b\u578b</li> <li>\u4e0e\u805a\u5408/\u5b9e\u4f53\u5728\u540c\u4e00\u4e2a\u6587\u4ef6\u4e2d\u5b9a\u4e49</li> <li>\u547d\u540d\u683c\u5f0f\u4e3a <code>{EntityName}Id</code></li> </ul>"},{"location":"development-guide/aggregate-development/#_3","title":"\u5982\u4f55\u5b9a\u4e49\u805a\u5408\u6839\uff1f","text":"<p>\u805a\u5408\u6839\u7684\u5b9a\u4e49\u5e94\u9075\u5faa\u4ee5\u4e0b\u89c4\u5219\uff1a</p> <ul> <li>\u805a\u5408\u5185\u5fc5\u987b\u6709\u4e00\u4e2a\u4e14\u53ea\u6709\u4e00\u4e2a\u805a\u5408\u6839</li> <li>\u547d\u540d\u4e0d\u9700\u8981\u5e26\u540e\u7f00Aggregate</li> <li>\u5fc5\u987b\u7ee7\u627f <code>Entity&lt;TId&gt;</code> \u5e76\u5b9e\u73b0 <code>IAggregateRoot</code> \u63a5\u53e3</li> <li>\u5fc5\u987b\u4f7f\u7528\u5f3a\u7c7b\u578bID\uff0c\u63a8\u8350\u4f7f\u7528 <code>IGuidStronglyTypedId</code></li> <li>\u5fc5\u987b\u6709 protected \u65e0\u53c2\u6784\u9020\u5668\u4f9b EF Core \u4f7f\u7528</li> <li>\u72b6\u6001\u6539\u53d8\u65f6\u53d1\u5e03\u9886\u57df\u4e8b\u4ef6\uff0c\u4f7f\u7528 <code>this.AddDomainEvent()</code></li> <li>\u6240\u6709\u5c5e\u6027\u4f7f\u7528 <code>private set</code>,\u5e76\u663e\u793a\u8bbe\u7f6e\u9ed8\u8ba4\u503c</li> <li>\u65e0\u9700\u624b\u52a8\u8bbe\u7f6eID\u7684\u503c</li> <li>RowVersion \u5c5e\u6027\u7528\u4e8e\u4e50\u89c2\u5e76\u53d1\u63a7\u5236</li> </ul>"},{"location":"development-guide/aggregate-development/#_4","title":"\u5982\u4f55\u5b9a\u4e49\u5b50\u5b9e\u4f53\uff1f","text":"<p>\u5b50\u5b9e\u4f53\u7684\u5b9a\u4e49\u5e94\u9075\u5faa\u4ee5\u4e0b\u89c4\u5219\uff1a</p> <ul> <li>\u5fc5\u987b\u662f <code>public</code> \u7c7b</li> <li>\u5fc5\u987b\u6709\u4e00\u4e2a\u65e0\u53c2\u6784\u9020\u5668</li> <li>\u5fc5\u987b\u6709\u4e00\u4e2a\u5f3a\u7c7b\u578bID\uff0c\u63a8\u8350\u4f7f\u7528 <code>IGuidStronglyTypedId</code></li> <li>\u5fc5\u987b\u7ee7\u627f\u81ea <code>Entity&lt;TId&gt;</code>\uff0c\u5e76\u5b9e\u73b0 <code>IEntity</code> \u63a5\u53e3</li> <li>\u805a\u5408\u5185\u5141\u8bb8\u591a\u4e2a\u5b50\u5b9e\u4f53</li> </ul>"},{"location":"development-guide/aggregate-development/#_5","title":"\u5982\u4f55\u7f16\u5199\u805a\u5408\u6839\u4ee3\u7801\u793a\u4f8b\uff1f","text":""},{"location":"development-guide/aggregate-development/#_6","title":"\u57fa\u672c\u805a\u5408\u6839\u793a\u4f8b","text":"<p>\u6587\u4ef6: <code>src/MyProject.Domain/AggregatesModel/UserAggregate/User.cs</code></p> <pre><code>using MyProject.Domain.DomainEvents; // \u5fc5\u9700\uff1a\u5f15\u7528\u9886\u57df\u4e8b\u4ef6\n\nnamespace MyProject.Domain.AggregatesModel.UserAggregate;\n\n// \u5f3a\u7c7b\u578bID\u5b9a\u4e49 - \u4e0e\u805a\u5408\u6839\u5728\u540c\u4e00\u6587\u4ef6\u4e2d\npublic partial record UserId : IGuidStronglyTypedId;\n\npublic class User : Entity&lt;UserId&gt;, IAggregateRoot\n{\n    protected User() { }\n\n    public User(string name, string email)\n    {\n        // \u4e0d\u624b\u52a8\u8bbe\u7f6eID\uff0c\u7531EF Core\u503c\u751f\u6210\u5668\u81ea\u52a8\u751f\u6210\n        Name = name;\n        Email = email;\n        this.AddDomainEvent(new UserCreatedDomainEvent(this));\n    }\n\n    #region Properties\n\n    public string Name { get; private set; } = string.Empty;\n    public string Email { get; private set; } = string.Empty;\n    public RowVersion RowVersion { get; private set; } = new RowVersion(0);\n\n    #endregion\n\n    #region Methods\n\n    public void ChangeEmail(string email)\n    {\n        Email = email;\n        this.AddDomainEvent(new UserEmailChangedDomainEvent(this));\n    }\n\n    #endregion\n}\n</code></pre>"},{"location":"development-guide/aggregate-development/#_7","title":"\u5982\u4f55\u7f16\u5199\u5e26\u6709\u5b50\u5b9e\u4f53\u7684\u805a\u5408\uff1f","text":"<p>\u6587\u4ef6: <code>src/MyProject.Domain/AggregatesModel/OrderAggregate/Order.cs</code></p> <pre><code>using MyProject.Domain.DomainEvents;\n\nnamespace MyProject.Domain.AggregatesModel.OrderAggregate;\n\n// \u8ba2\u5355ID\npublic partial record OrderId : IGuidStronglyTypedId;\n\n// \u8ba2\u5355\u9879ID\npublic partial record OrderItemId : IGuidStronglyTypedId;\n\n// \u8ba2\u5355\u805a\u5408\u6839\npublic class Order : Entity&lt;OrderId&gt;, IAggregateRoot\n{\n    protected Order() { }\n\n    private readonly List&lt;OrderItem&gt; _orderItems = new();\n\n    public Order(string customerName)\n    {\n        CustomerName = customerName;\n        OrderStatus = OrderStatus.Pending;\n        this.AddDomainEvent(new OrderCreatedDomainEvent(this));\n    }\n\n    #region Properties\n\n    public string CustomerName { get; private set; } = string.Empty;\n    public OrderStatus OrderStatus { get; private set; }\n    public IReadOnlyCollection&lt;OrderItem&gt; OrderItems =&gt; _orderItems.AsReadOnly();\n    public RowVersion RowVersion { get; private set; } = new RowVersion(0);\n\n    #endregion\n\n    #region Methods\n\n    public void AddItem(string productName, decimal price, int quantity)\n    {\n        var orderItem = new OrderItem(productName, price, quantity);\n        _orderItems.Add(orderItem);\n        this.AddDomainEvent(new OrderItemAddedDomainEvent(this, orderItem));\n    }\n\n    public void Confirm()\n    {\n        if (OrderStatus != OrderStatus.Pending)\n        {\n            throw new KnownException(\"\u53ea\u6709\u5f85\u786e\u8ba4\u7684\u8ba2\u5355\u624d\u80fd\u88ab\u786e\u8ba4\");\n        }\n\n        OrderStatus = OrderStatus.Confirmed;\n        this.AddDomainEvent(new OrderConfirmedDomainEvent(this));\n    }\n\n    #endregion\n}\n\n// \u8ba2\u5355\u9879 - \u5b50\u5b9e\u4f53\npublic class OrderItem : Entity&lt;OrderItemId&gt;, IEntity\n{\n    protected OrderItem() { }\n\n    public OrderItem(string productName, decimal price, int quantity)\n    {\n        ProductName = productName;\n        Price = price;\n        Quantity = quantity;\n    }\n\n    public string ProductName { get; private set; } = string.Empty;\n    public decimal Price { get; private set; }\n    public int Quantity { get; private set; }\n}\n\n// \u8ba2\u5355\u72b6\u6001\u679a\u4e3e\npublic enum OrderStatus\n{\n    Pending,\n    Confirmed,\n    Shipped,\n    Completed,\n    Cancelled\n}\n</code></pre>"},{"location":"development-guide/aggregate-development/#_8","title":"\u9047\u5230\u9886\u57df\u4e8b\u4ef6\u5f15\u7528\u9519\u8bef\u600e\u4e48\u529e\uff1f","text":""},{"location":"development-guide/aggregate-development/#_9","title":"\u9886\u57df\u4e8b\u4ef6\u5f15\u7528\u9519\u8bef","text":"<p>\u9519\u8bef: <code>\u672a\u80fd\u627e\u5230\u7c7b\u578b\u6216\u547d\u540d\u7a7a\u95f4\u540d\"UserCreatedDomainEvent\"</code></p> <p>\u539f\u56e0: \u7f3a\u5c11\u5bf9\u9886\u57df\u4e8b\u4ef6\u547d\u540d\u7a7a\u95f4\u7684\u5f15\u7528</p> <p>\u89e3\u51b3: \u5728\u805a\u5408\u6839\u6587\u4ef6\u9876\u90e8\u6dfb\u52a0 <code>using {ProjectName}.Domain.DomainEvents;</code></p>"},{"location":"development-guide/aggregate-development/#id_2","title":"\u4e3a\u4ec0\u4e48\u4f1a\u51fa\u73b0ID\u624b\u52a8\u8d4b\u503c\u9519\u8bef\uff1f","text":"<p>\u9519\u8bef: \u624b\u52a8\u5728\u6784\u9020\u51fd\u6570\u4e2d\u8bbe\u7f6eID\u503c</p> <p>\u539f\u56e0: \u8fdd\u53cd\u4e86\u6846\u67b6\u8bbe\u8ba1\u539f\u5219</p> <p>\u89e3\u51b3: \u79fb\u9664ID\u8d4b\u503c\u4ee3\u7801\uff0c\u8ba9EF Core\u503c\u751f\u6210\u5668\u81ea\u52a8\u751f\u6210</p>"},{"location":"development-guide/aggregate-development/#_10","title":"\u4e3a\u4ec0\u4e48\u4f1a\u51fa\u73b0\u7f3a\u5c11\u65e0\u53c2\u6784\u9020\u5668\u7684\u9519\u8bef\uff1f","text":"<p>\u9519\u8bef: EF Core\u65e0\u6cd5\u5b9e\u4f8b\u5316\u5b9e\u4f53</p> <p>\u539f\u56e0: \u7f3a\u5c11protected\u65e0\u53c2\u6784\u9020\u5668</p> <p>\u89e3\u51b3: \u6dfb\u52a0 <code>protected EntityName() { }</code> \u6784\u9020\u5668</p>"},{"location":"development-guide/aggregate-development/#_11","title":"\u805a\u5408\u5f00\u53d1\u6709\u54ea\u4e9b\u6700\u4f73\u5b9e\u8df5\uff1f","text":"<ol> <li>\u4e1a\u52a1\u903b\u8f91\u5c01\u88c5: \u5c06\u6240\u6709\u4e1a\u52a1\u903b\u8f91\u653e\u5728\u805a\u5408\u6839\u7684\u65b9\u6cd5\u4e2d\uff0c\u800c\u4e0d\u662f\u5728\u5916\u90e8\u64cd\u4f5c\u5c5e\u6027</li> <li>\u4e0d\u53d8\u6027\u4fdd\u62a4: \u4f7f\u7528 <code>private set</code> \u786e\u4fdd\u53ea\u80fd\u901a\u8fc7\u4e1a\u52a1\u65b9\u6cd5\u4fee\u6539\u72b6\u6001</li> <li>\u9886\u57df\u4e8b\u4ef6\u53d1\u5e03: \u5728\u6bcf\u4e2a\u91cd\u8981\u7684\u72b6\u6001\u53d8\u66f4\u65f6\u53d1\u5e03\u9886\u57df\u4e8b\u4ef6</li> <li>\u5f3a\u7c7b\u578bID: \u59cb\u7ec8\u4f7f\u7528\u5f3a\u7c7b\u578bID\uff0c\u907f\u514dID\u7c7b\u578b\u6df7\u6dc6</li> <li>\u8fb9\u754c\u660e\u786e: \u6bcf\u4e2a\u805a\u5408\u5e94\u8be5\u6709\u660e\u786e\u7684\u4e1a\u52a1\u8fb9\u754c\uff0c\u907f\u514d\u8fc7\u5927\u7684\u805a\u5408</li> <li>\u5b50\u5b9e\u4f53\u7ba1\u7406: \u5b50\u5b9e\u4f53\u5e94\u8be5\u901a\u8fc7\u805a\u5408\u6839\u7684\u65b9\u6cd5\u6765\u6dfb\u52a0\u3001\u4fee\u6539\u548c\u5220\u9664</li> </ol>"},{"location":"development-guide/aggregate-development/#_12","title":"\u5728\u54ea\u91cc\u53ef\u4ee5\u627e\u5230\u76f8\u5173\u6587\u6863\uff1f","text":"<ul> <li>\u9886\u57df\u4e8b\u4ef6\u5f00\u53d1\u6307\u5357</li> <li>\u5b9e\u4f53\u914d\u7f6e\u6307\u5357</li> <li>\u4ed3\u50a8\u5f00\u53d1\u6307\u5357</li> </ul>"},{"location":"development-guide/command-development/","title":"\u547d\u4ee4\u5f00\u53d1\u6307\u5357","text":""},{"location":"development-guide/command-development/#_2","title":"\u4ec0\u4e48\u662f\u547d\u4ee4\uff1f","text":"<p>\u547d\u4ee4\u8868\u793a\u7528\u6237\u60f3\u8981\u6267\u884c\u7684\u64cd\u4f5c\uff0c\u9075\u5faa CQRS \u6a21\u5f0f\u3002\u672c\u6a21\u677f\u4f7f\u7528 MediatR \u5e93\u5b9e\u73b0\u547d\u4ee4\u5904\u7406\uff0c\u6240\u6709\u547d\u4ee4\u5904\u7406\u5668\u4f1a\u88ab\u6846\u67b6\u81ea\u52a8\u6ce8\u518c\u3002</p>"},{"location":"development-guide/command-development/#_3","title":"\u547d\u4ee4\u6587\u4ef6\u5e94\u8be5\u653e\u5728\u54ea\u91cc\uff1f","text":"<p>\u7c7b\u6587\u4ef6\u547d\u540d\u5e94\u9075\u5faa\u4ee5\u4e0b\u89c4\u5219\uff1a</p> <ul> <li>\u5e94\u653e\u7f6e\u5728 <code>src/{ProjectName}.Web/Application/Commands/{Module}/</code> \u76ee\u5f55\u4e0b</li> <li>\u547d\u4ee4\u6587\u4ef6\u540d\u683c\u5f0f\u4e3a <code>{Action}{Entity}Command.cs</code></li> <li>\u540c\u4e00\u4e2a\u547d\u4ee4\u53ca\u5176\u5bf9\u5e94\u7684\u9a8c\u8bc1\u5668\u548c\u5904\u7406\u5668\u5b9a\u4e49\u5728\u540c\u4e00\u6587\u4ef6\u4e2d</li> <li>\u4e0d\u540c\u7684\u547d\u4ee4\u653e\u5728\u4e0d\u540c\u6587\u4ef6\u4e2d</li> </ul>"},{"location":"development-guide/command-development/#_4","title":"\u5982\u4f55\u5b9a\u4e49\u547d\u4ee4\uff1f","text":"<p>\u547d\u4ee4\u7684\u5b9a\u4e49\u5e94\u9075\u5faa\u4ee5\u4e0b\u89c4\u5219\uff1a</p> <ul> <li>\u65e0\u8fd4\u56de\u503c\u547d\u4ee4\u5b9e\u73b0 <code>ICommand</code> \u63a5\u53e3</li> <li>\u6709\u8fd4\u56de\u503c\u547d\u4ee4\u5b9e\u73b0 <code>ICommand&lt;TResponse&gt;</code> \u63a5\u53e3</li> <li>\u5fc5\u987b\u4e3a\u6bcf\u4e2a\u547d\u4ee4\u521b\u5efa\u9a8c\u8bc1\u5668\uff0c\u7ee7\u627f <code>AbstractValidator&lt;TCommand&gt;</code></li> <li>\u547d\u4ee4\u5904\u7406\u5668\u5b9e\u73b0\u5bf9\u5e94\u7684 <code>ICommandHandler</code> \u63a5\u53e3</li> <li>\u4f7f\u7528 <code>record</code> \u7c7b\u578b\u5b9a\u4e49\u547d\u4ee4</li> <li>\u6846\u67b6\u81ea\u52a8\u6ce8\u518c\u547d\u4ee4\u5904\u7406\u5668</li> </ul>"},{"location":"development-guide/command-development/#_5","title":"\u547d\u4ee4\u5904\u7406\u5668\u6709\u54ea\u4e9b\u6700\u4f73\u5b9e\u8df5\uff1f","text":""},{"location":"development-guide/command-development/#_6","title":"\u5982\u4f55\u7ba1\u7406\u4e8b\u52a1\uff1f","text":"<ul> <li>\u4e0d\u8981\u624b\u52a8\u8c03\u7528SaveChanges: \u6846\u67b6\u4f1a\u81ea\u52a8\u5728\u547d\u4ee4\u5904\u7406\u5b8c\u6210\u540e\u8c03\u7528SaveChanges</li> <li>\u4f9d\u8d56UnitOfWork\u6a21\u5f0f: \u8ba9\u6846\u67b6\u7ba1\u7406\u4e8b\u52a1\u8fb9\u754c</li> </ul>"},{"location":"development-guide/command-development/#_7","title":"\u5982\u4f55\u4f7f\u7528\u4ed3\u50a8\u65b9\u6cd5\uff1f","text":"<ul> <li>\u4ec5\u7528\u4e8e\u4e1a\u52a1\u64cd\u4f5c: \u4ed3\u50a8\u65b9\u6cd5\u53ea\u5728\u9700\u8981\u83b7\u53d6\u805a\u5408\u6839\u8fdb\u884c\u4e1a\u52a1\u64cd\u4f5c\u65f6\u4f7f\u7528</li> <li>\u4f18\u5148\u4f7f\u7528\u5f02\u6b65\u65b9\u6cd5: \u6240\u6709\u4ed3\u50a8\u64cd\u4f5c\u90fd\u5e94\u4f7f\u7528\u5f02\u6b65\u7248\u672c</li> <li>\u6b63\u786e\u7684\u53d6\u6d88\u4ee4\u724c\u4f20\u9012: \u5c06CancellationToken\u4f20\u9012\u7ed9\u6240\u6709\u5f02\u6b65\u64cd\u4f5c</li> <li>\u4f53\u73b0\u4e1a\u52a1\u610f\u56fe: \u4ed3\u50a8\u65b9\u6cd5\u540d\u5e94\u8be5\u53cd\u6620\u4e1a\u52a1\u573a\u666f\uff0c\u800c\u4e0d\u662f\u901a\u7528\u6570\u636e\u8bbf\u95ee</li> </ul>"},{"location":"development-guide/command-development/#_8","title":"\u6570\u636e\u8bbf\u95ee\u6709\u4ec0\u4e48\u539f\u5219\uff1f","text":"<ul> <li>\u547d\u4ee4\u5904\u7406\u5668\u4f7f\u7528\u4ed3\u50a8\u83b7\u53d6\u805a\u5408\u6839\u8fdb\u884c\u4e1a\u52a1\u64cd\u4f5c</li> <li>\u5982\u679c\u53ea\u662f\u4e3a\u4e86\u68c0\u67e5\u6570\u636e\u5b58\u5728\u6027\uff0c\u8003\u8651\u662f\u5426\u9700\u8981\u5b8c\u6574\u7684\u805a\u5408\u6839</li> <li>\u907f\u514d\u5728\u547d\u4ee4\u5904\u7406\u5668\u4e2d\u8fdb\u884c\u590d\u6742\u7684\u67e5\u8be2\u64cd\u4f5c</li> </ul>"},{"location":"development-guide/command-development/#_9","title":"\u9700\u8981\u5f15\u7528\u54ea\u4e9b\u547d\u540d\u7a7a\u95f4\uff1f","text":"<p>\u547d\u4ee4\u6587\u4ef6\u4e2d\u7684\u5fc5\u8981\u5f15\u7528\u5df2\u5728GlobalUsings.cs\u4e2d\u5b9a\u4e49\uff1a</p> <ul> <li><code>global using FluentValidation;</code> - \u7528\u4e8e\u9a8c\u8bc1\u5668</li> <li><code>global using MediatR;</code> - \u7528\u4e8e\u547d\u4ee4\u5904\u7406\u5668\u63a5\u53e3</li> <li><code>global using NetCorePal.Extensions.Primitives;</code> - \u7528\u4e8eKnownException\u7b49</li> </ul> <p>\u547d\u4ee4\u5904\u7406\u5668\u4e2d\u5e38\u9700\u624b\u52a8\u6dfb\u52a0\u7684\u5f15\u7528\uff1a</p> <ul> <li><code>using {ProjectName}.Domain.AggregatesModel.{Aggregate};</code> - \u805a\u5408\u6839\u5f15\u7528</li> <li><code>using {ProjectName}.Infrastructure.Repositories;</code> - \u4ed3\u50a8\u63a5\u53e3\u5f15\u7528</li> </ul> <p>\u56e0\u6b64\u5728\u547d\u4ee4\u6587\u4ef6\u4e2d\u65e0\u9700\u91cd\u590d\u6dfb\u52a0GlobalUsings\u4e2d\u5df2\u5b9a\u4e49\u7684using\u8bed\u53e5\u3002</p>"},{"location":"development-guide/command-development/#_10","title":"\u5982\u4f55\u7f16\u5199\u521b\u5efa\u547d\u4ee4\uff1f","text":""},{"location":"development-guide/command-development/#_11","title":"\u521b\u5efa\u547d\u4ee4\u793a\u4f8b","text":"<p>\u6587\u4ef6: <code>src/MyProject.Web/Application/Commands/User/CreateUserCommand.cs</code></p> <pre><code>using MyProject.Domain.AggregatesModel.UserAggregate;\nusing MyProject.Infrastructure.Repositories;\n\nnamespace MyProject.Web.Application.Commands.User;\n\npublic record CreateUserCommand(string Name, string Email) : ICommand&lt;UserId&gt;;\n\npublic class CreateUserCommandValidator : AbstractValidator&lt;CreateUserCommand&gt;\n{\n    public CreateUserCommandValidator()\n    {\n        RuleFor(x =&gt; x.Name)\n            .NotEmpty()\n            .WithMessage(\"\u7528\u6237\u540d\u4e0d\u80fd\u4e3a\u7a7a\")\n            .MaximumLength(50)\n            .WithMessage(\"\u7528\u6237\u540d\u4e0d\u80fd\u8d85\u8fc750\u4e2a\u5b57\u7b26\");\n\n        RuleFor(x =&gt; x.Email)\n            .NotEmpty()\n            .WithMessage(\"\u90ae\u7bb1\u4e0d\u80fd\u4e3a\u7a7a\")\n            .EmailAddress()\n            .WithMessage(\"\u90ae\u7bb1\u683c\u5f0f\u4e0d\u6b63\u786e\")\n            .MaximumLength(100)\n            .WithMessage(\"\u90ae\u7bb1\u4e0d\u80fd\u8d85\u8fc7100\u4e2a\u5b57\u7b26\");\n    }\n}\n\npublic class CreateUserCommandHandler(IUserRepository userRepository)\n    : ICommandHandler&lt;CreateUserCommand, UserId&gt;\n{\n    public async Task&lt;UserId&gt; Handle(CreateUserCommand command, CancellationToken cancellationToken)\n    {\n        if (await userRepository.EmailExistsAsync(command.Email, cancellationToken))\n        {\n            throw new KnownException(\"\u90ae\u7bb1\u5df2\u5b58\u5728\");\n        }\n\n        var user = new User(command.Name, command.Email);\n        await userRepository.AddAsync(user, cancellationToken);\n        return user.Id;\n    }\n}\n</code></pre>"},{"location":"development-guide/command-development/#_12","title":"\u5982\u4f55\u7f16\u5199\u66f4\u65b0\u547d\u4ee4\uff1f","text":"<p>\u6587\u4ef6: <code>src/MyProject.Web/Application/Commands/User/UpdateUserEmailCommand.cs</code></p> <pre><code>using MyProject.Domain.AggregatesModel.UserAggregate;\nusing MyProject.Infrastructure.Repositories;\n\nnamespace MyProject.Web.Application.Commands.User;\n\npublic record UpdateUserEmailCommand(UserId UserId, string Email) : ICommand;\n\npublic class UpdateUserEmailCommandValidator : AbstractValidator&lt;UpdateUserEmailCommand&gt;\n{\n    public UpdateUserEmailCommandValidator()\n    {\n        RuleFor(x =&gt; x.UserId)\n            .NotEmpty()\n            .WithMessage(\"\u7528\u6237ID\u4e0d\u80fd\u4e3a\u7a7a\");\n\n        RuleFor(x =&gt; x.Email)\n            .NotEmpty()\n            .WithMessage(\"\u90ae\u7bb1\u4e0d\u80fd\u4e3a\u7a7a\")\n            .EmailAddress()\n            .WithMessage(\"\u90ae\u7bb1\u683c\u5f0f\u4e0d\u6b63\u786e\");\n    }\n}\n\npublic class UpdateUserEmailCommandHandler(IUserRepository userRepository)\n    : ICommandHandler&lt;UpdateUserEmailCommand&gt;\n{\n    public async Task Handle(UpdateUserEmailCommand command, CancellationToken cancellationToken)\n    {\n        var user = await userRepository.GetAsync(command.UserId, cancellationToken) ??\n                   throw new KnownException($\"\u672a\u627e\u5230\u7528\u6237\uff0cUserId = {command.UserId}\");\n\n        if (await userRepository.EmailExistsAsync(command.Email, cancellationToken))\n        {\n            throw new KnownException(\"\u90ae\u7bb1\u5df2\u88ab\u4f7f\u7528\");\n        }\n\n        user.ChangeEmail(command.Email);\n        // \u6846\u67b6\u4f1a\u81ea\u52a8\u8c03\u7528 SaveChanges\n    }\n}\n</code></pre>"},{"location":"development-guide/command-development/#_13","title":"\u5982\u4f55\u7f16\u5199\u5220\u9664\u547d\u4ee4\uff1f","text":"<p>\u6587\u4ef6: <code>src/MyProject.Web/Application/Commands/User/DeleteUserCommand.cs</code></p> <pre><code>using MyProject.Domain.AggregatesModel.UserAggregate;\nusing MyProject.Infrastructure.Repositories;\n\nnamespace MyProject.Web.Application.Commands.User;\n\npublic record DeleteUserCommand(UserId UserId) : ICommand;\n\npublic class DeleteUserCommandValidator : AbstractValidator&lt;DeleteUserCommand&gt;\n{\n    public DeleteUserCommandValidator()\n    {\n        RuleFor(x =&gt; x.UserId)\n            .NotEmpty()\n            .WithMessage(\"\u7528\u6237ID\u4e0d\u80fd\u4e3a\u7a7a\");\n    }\n}\n\npublic class DeleteUserCommandHandler(IUserRepository userRepository)\n    : ICommandHandler&lt;DeleteUserCommand&gt;\n{\n    public async Task Handle(DeleteUserCommand command, CancellationToken cancellationToken)\n    {\n        var user = await userRepository.GetAsync(command.UserId, cancellationToken) ??\n                   throw new KnownException($\"\u672a\u627e\u5230\u7528\u6237\uff0cUserId = {command.UserId}\");\n\n        user.Delete();\n        // \u6846\u67b6\u4f1a\u81ea\u52a8\u8c03\u7528 SaveChanges\n    }\n}\n</code></pre>"},{"location":"development-guide/command-development/#_14","title":"\u547d\u4ee4\u5904\u7406\u5668\u7684\u6b63\u786e\u548c\u9519\u8bef\u5199\u6cd5\u662f\u4ec0\u4e48\uff1f","text":""},{"location":"development-guide/command-development/#_15","title":"\u274c \u9519\u8bef\u7684\u505a\u6cd5","text":"<pre><code>public async Task&lt;UserId&gt; Handle(CreateUserCommand request, CancellationToken cancellationToken)\n{\n    var user = new User(request.Name, request.Email);\n\n    userRepository.Add(user); // \u5e94\u8be5\u4f7f\u7528\u5f02\u6b65\u65b9\u6cd5\n    await userRepository.UnitOfWork.SaveChangesAsync(cancellationToken); // \u4e0d\u5e94\u624b\u52a8\u8c03\u7528\n\n    return user.Id;\n}\n</code></pre>"},{"location":"development-guide/command-development/#_16","title":"\u2705 \u6b63\u786e\u7684\u505a\u6cd5","text":"<pre><code>public async Task&lt;UserId&gt; Handle(CreateUserCommand request, CancellationToken cancellationToken)\n{\n    var user = new User(request.Name, request.Email);\n\n    await userRepository.AddAsync(user, cancellationToken); // \u4f7f\u7528\u5f02\u6b65\u65b9\u6cd5\n    // \u6846\u67b6\u4f1a\u81ea\u52a8\u8c03\u7528SaveChanges\n\n    return user.Id;\n}\n</code></pre>"},{"location":"development-guide/command-development/#_17","title":"\u9a8c\u8bc1\u5668\u6709\u54ea\u4e9b\u6700\u4f73\u5b9e\u8df5\uff1f","text":""},{"location":"development-guide/command-development/#_18","title":"\u5982\u4f55\u7f16\u5199\u57fa\u672c\u9a8c\u8bc1\u89c4\u5219\uff1f","text":"<pre><code>public class CreateOrderCommandValidator : AbstractValidator&lt;CreateOrderCommand&gt;\n{\n    public CreateOrderCommandValidator()\n    {\n        // \u5fc5\u586b\u9a8c\u8bc1\n        RuleFor(x =&gt; x.CustomerName)\n            .NotEmpty()\n            .WithMessage(\"\u5ba2\u6237\u540d\u79f0\u4e0d\u80fd\u4e3a\u7a7a\");\n\n        // \u957f\u5ea6\u9a8c\u8bc1\n        RuleFor(x =&gt; x.CustomerName)\n            .MaximumLength(100)\n            .WithMessage(\"\u5ba2\u6237\u540d\u79f0\u4e0d\u80fd\u8d85\u8fc7100\u4e2a\u5b57\u7b26\");\n\n        // \u8303\u56f4\u9a8c\u8bc1\n        RuleFor(x =&gt; x.Quantity)\n            .GreaterThan(0)\n            .WithMessage(\"\u6570\u91cf\u5fc5\u987b\u5927\u4e8e0\")\n            .LessThanOrEqualTo(1000)\n            .WithMessage(\"\u6570\u91cf\u4e0d\u80fd\u8d85\u8fc71000\");\n\n        // \u6b63\u5219\u8868\u8fbe\u5f0f\u9a8c\u8bc1\n        RuleFor(x =&gt; x.Phone)\n            .Matches(@\"^1[3-9]\\d{9}$\")\n            .WithMessage(\"\u624b\u673a\u53f7\u683c\u5f0f\u4e0d\u6b63\u786e\");\n\n        // \u81ea\u5b9a\u4e49\u9a8c\u8bc1\n        RuleFor(x =&gt; x.Email)\n            .Must(BeUniqueEmail)\n            .WithMessage(\"\u90ae\u7bb1\u5df2\u5b58\u5728\");\n    }\n\n    private bool BeUniqueEmail(string email)\n    {\n        // \u5b9e\u73b0\u552f\u4e00\u6027\u68c0\u67e5\u903b\u8f91\n        return true;\n    }\n}\n</code></pre>"},{"location":"development-guide/command-development/#_19","title":"\u5982\u4f55\u9a8c\u8bc1\u590d\u6742\u5bf9\u8c61\uff1f","text":"<pre><code>public record CreateOrderCommand(\n    string CustomerName,\n    List&lt;OrderItemDto&gt; Items) : ICommand&lt;OrderId&gt;;\n\npublic record OrderItemDto(string ProductName, decimal Price, int Quantity);\n\npublic class CreateOrderCommandValidator : AbstractValidator&lt;CreateOrderCommand&gt;\n{\n    public CreateOrderCommandValidator()\n    {\n        RuleFor(x =&gt; x.CustomerName)\n            .NotEmpty()\n            .WithMessage(\"\u5ba2\u6237\u540d\u79f0\u4e0d\u80fd\u4e3a\u7a7a\");\n\n        // \u9a8c\u8bc1\u96c6\u5408\n        RuleFor(x =&gt; x.Items)\n            .NotEmpty()\n            .WithMessage(\"\u8ba2\u5355\u9879\u4e0d\u80fd\u4e3a\u7a7a\");\n\n        // \u9a8c\u8bc1\u96c6\u5408\u4e2d\u7684\u6bcf\u4e00\u9879\n        RuleForEach(x =&gt; x.Items)\n            .SetValidator(new OrderItemDtoValidator());\n    }\n}\n\npublic class OrderItemDtoValidator : AbstractValidator&lt;OrderItemDto&gt;\n{\n    public OrderItemDtoValidator()\n    {\n        RuleFor(x =&gt; x.ProductName)\n            .NotEmpty()\n            .WithMessage(\"\u4ea7\u54c1\u540d\u79f0\u4e0d\u80fd\u4e3a\u7a7a\");\n\n        RuleFor(x =&gt; x.Price)\n            .GreaterThan(0)\n            .WithMessage(\"\u4ef7\u683c\u5fc5\u987b\u5927\u4e8e0\");\n\n        RuleFor(x =&gt; x.Quantity)\n            .GreaterThan(0)\n            .WithMessage(\"\u6570\u91cf\u5fc5\u987b\u5927\u4e8e0\");\n    }\n}\n</code></pre>"},{"location":"development-guide/command-development/#_20","title":"\u5982\u4f55\u5904\u7406\u5f02\u5e38\uff1f","text":""},{"location":"development-guide/command-development/#knownexception","title":"\u5982\u4f55\u4f7f\u7528KnownException\uff1f","text":"<p>\u5728\u9700\u8981\u629b\u51fa\u4e1a\u52a1\u5f02\u5e38\u7684\u5730\u65b9\uff0c\u5fc5\u987b\u4f7f\u7528 <code>KnownException</code> \u800c\u4e0d\u662f\u666e\u901a\u7684 <code>Exception</code>\uff1a</p> <p>\u6b63\u786e\u793a\u4f8b\uff1a</p> <pre><code>// \u5728\u805a\u5408\u6839\u4e2d\npublic void OrderPaid()\n{\n    if (Paid)\n    {\n        throw new KnownException(\"\u8ba2\u5355\u5df2\u652f\u4ed8\");\n    }\n    // \u4e1a\u52a1\u903b\u8f91...\n}\n\n// \u5728\u547d\u4ee4\u5904\u7406\u5668\u4e2d\npublic async Task&lt;OrderId&gt; Handle(OrderPaidCommand request, CancellationToken cancellationToken)\n{\n    var order = await orderRepository.GetAsync(request.OrderId, cancellationToken) ??\n                throw new KnownException($\"\u672a\u627e\u5230\u8ba2\u5355\uff0cOrderId = {request.OrderId}\");\n    order.OrderPaid();\n    return order.Id;\n}\n</code></pre> <p>\u6846\u67b6\u96c6\u6210\uff1a</p> <ul> <li><code>KnownException</code> \u4f1a\u88ab\u6846\u67b6\u81ea\u52a8\u8f6c\u6362\u4e3a\u5408\u9002\u7684HTTP\u72b6\u6001\u7801</li> <li>\u5f02\u5e38\u6d88\u606f\u4f1a\u76f4\u63a5\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef</li> <li>\u652f\u6301\u672c\u5730\u5316\u548c\u9519\u8bef\u7801\u5b9a\u5236</li> </ul>"},{"location":"development-guide/command-development/#_21","title":"\u9047\u5230\u5e38\u89c1\u9519\u8bef\u600e\u4e48\u529e\uff1f","text":""},{"location":"development-guide/command-development/#_22","title":"\u4e3a\u4ec0\u4e48\u9a8c\u8bc1\u5668\u672a\u751f\u6548\uff1f","text":"<p>\u9519\u8bef: \u9a8c\u8bc1\u5668\u5b9a\u4e49\u4e86\u4f46\u6ca1\u6709\u6267\u884c</p> <p>\u539f\u56e0: \u9a8c\u8bc1\u5668\u7c7b\u540d\u4e0d\u7b26\u5408\u7ea6\u5b9a\u6216\u672a\u7ee7\u627f\u6b63\u786e\u7684\u57fa\u7c7b</p> <p>\u89e3\u51b3:  - \u786e\u4fdd\u9a8c\u8bc1\u5668\u7ee7\u627f <code>AbstractValidator&lt;TCommand&gt;</code> - \u9a8c\u8bc1\u5668\u7c7b\u540d\u5e94\u4e3a <code>{CommandName}Validator</code></p>"},{"location":"development-guide/command-development/#savechanges","title":"\u4e3a\u4ec0\u4e48\u4f1a\u51fa\u73b0SaveChanges\u76f8\u5173\u9519\u8bef\uff1f","text":"<p>\u9519\u8bef: \u624b\u52a8\u8c03\u7528SaveChanges\u5bfc\u81f4\u7684\u95ee\u9898</p> <p>\u539f\u56e0: \u6253\u7834\u4e86\u6846\u67b6\u7684\u4e8b\u52a1\u7ba1\u7406\u673a\u5236</p> <p>\u89e3\u51b3: \u79fb\u9664\u6240\u6709\u624b\u52a8\u7684SaveChanges\u8c03\u7528\uff0c\u8ba9\u6846\u67b6\u81ea\u52a8\u5904\u7406</p>"},{"location":"development-guide/command-development/#_23","title":"\u4e3a\u4ec0\u4e48\u627e\u4e0d\u5230\u4ed3\u50a8\u65b9\u6cd5\uff1f","text":"<p>\u9519\u8bef: \u627e\u4e0d\u5230\u4ed3\u50a8\u4e2d\u5b9a\u4e49\u7684\u7279\u5b9a\u65b9\u6cd5</p> <p>\u539f\u56e0: \u4ed3\u50a8\u63a5\u53e3\u4e2d\u672a\u5b9a\u4e49\u9700\u8981\u7684\u65b9\u6cd5</p> <p>\u89e3\u51b3: \u5728\u4ed3\u50a8\u63a5\u53e3\u4e2d\u6dfb\u52a0\u9700\u8981\u7684\u65b9\u6cd5\u5b9a\u4e49</p>"},{"location":"development-guide/command-development/#_24","title":"\u547d\u4ee4\u5f00\u53d1\u6709\u54ea\u4e9b\u6700\u4f73\u5b9e\u8df5\uff1f","text":"<ol> <li>\u5355\u4e00\u804c\u8d23: \u6bcf\u4e2a\u547d\u4ee4\u53ea\u505a\u4e00\u4ef6\u4e8b\u60c5</li> <li>\u9a8c\u8bc1\u5b8c\u6574: \u4e3a\u6bcf\u4e2a\u547d\u4ee4\u63d0\u4f9b\u5b8c\u6574\u7684\u9a8c\u8bc1\u89c4\u5219</li> <li>\u5f02\u6b65\u4f18\u5148: \u6240\u6709IO\u64cd\u4f5c\u90fd\u4f7f\u7528\u5f02\u6b65\u65b9\u6cd5</li> <li>\u5f02\u5e38\u5904\u7406: \u4f7f\u7528KnownException\u5904\u7406\u4e1a\u52a1\u5f02\u5e38</li> <li>\u53d6\u6d88\u4ee4\u724c: \u6b63\u786e\u4f20\u9012\u548c\u4f7f\u7528CancellationToken</li> <li>\u547d\u540d\u6e05\u6670: \u547d\u4ee4\u540d\u79f0\u5e94\u8be5\u6e05\u695a\u8868\u8fbe\u4e1a\u52a1\u610f\u56fe</li> </ol>"},{"location":"development-guide/command-development/#_25","title":"\u5728\u54ea\u91cc\u53ef\u4ee5\u627e\u5230\u76f8\u5173\u6587\u6863\uff1f","text":"<ul> <li>\u805a\u5408\u5f00\u53d1\u6307\u5357</li> <li>\u4ed3\u50a8\u5f00\u53d1\u6307\u5357</li> <li>\u9886\u57df\u4e8b\u4ef6\u5904\u7406\u5668\u5f00\u53d1\u6307\u5357</li> <li>Endpoint\u5f00\u53d1\u6307\u5357</li> </ul>"},{"location":"development-guide/domain-event-development/","title":"\u9886\u57df\u4e8b\u4ef6\u5f00\u53d1\u6307\u5357","text":""},{"location":"development-guide/domain-event-development/#_2","title":"\u4ec0\u4e48\u662f\u9886\u57df\u4e8b\u4ef6\uff1f","text":"<p>\u9886\u57df\u4e8b\u4ef6\u8868\u793a\u5728\u4e1a\u52a1\u9886\u57df\u4e2d\u53d1\u751f\u7684\u91cd\u8981\u4e8b\u60c5\uff0c\u7528\u4e8e\u5b9e\u73b0\u805a\u5408\u4e4b\u95f4\u7684\u534f\u4f5c\u901a\u4fe1\u3002\u5f53\u805a\u5408\u6839\u7684\u72b6\u6001\u53d1\u751f\u53d8\u5316\u65f6\uff0c\u5e94\u8be5\u53d1\u5e03\u76f8\u5e94\u7684\u9886\u57df\u4e8b\u4ef6\u3002</p>"},{"location":"development-guide/domain-event-development/#_3","title":"\u9886\u57df\u4e8b\u4ef6\u6587\u4ef6\u5e94\u8be5\u653e\u5728\u54ea\u91cc\uff1f","text":"<p>\u7c7b\u6587\u4ef6\u547d\u540d\u5e94\u9075\u5faa\u4ee5\u4e0b\u89c4\u5219\uff1a</p> <ul> <li>\u5e94\u653e\u7f6e\u5728 <code>src/{ProjectName}.Domain/DomainEvents/</code> \u76ee\u5f55\u4e0b</li> <li>\u4e3a\u6bcf\u4e2a\u805a\u5408\u6dfb\u52a0\u4e00\u4e2a\u9886\u57df\u4e8b\u4ef6\u6587\u4ef6</li> <li>\u6587\u4ef6\u540d\u683c\u5f0f\u4e3a <code>{Aggregate}DomainEvents.cs</code></li> <li>\u4e00\u4e2a\u9886\u57df\u4e8b\u4ef6\u6587\u4ef6\u4e2d\u53ef\u4ee5\u5305\u542b\u591a\u4e2a\u9886\u57df\u4e8b\u4ef6</li> </ul>"},{"location":"development-guide/domain-event-development/#_4","title":"\u5982\u4f55\u5b9a\u4e49\u9886\u57df\u4e8b\u4ef6\uff1f","text":"<p>\u9886\u57df\u4e8b\u4ef6\u7684\u5b9a\u4e49\u5e94\u9075\u5faa\u4ee5\u4e0b\u89c4\u5219\uff1a</p> <ul> <li>\u5fc5\u987b\u4f7f\u7528 <code>record</code> \u7c7b\u578b</li> <li>\u5fc5\u987b\u6807\u8bb0\u63a5\u53e3<code>IDomainEvent</code>\uff0c\u65e0\u9700\u989d\u5916\u5b9e\u73b0</li> <li>\u65e0\u989d\u5916\u4fe1\u606f\u4f20\u9012\u9700\u6c42\u65f6\uff0c\u5c06\u805a\u5408\u4f5c\u4e3a\u6784\u9020\u51fd\u6570\u53c2\u6570</li> <li>\u4f7f\u7528\u8fc7\u53bb\u5f0f\u52a8\u8bcd\u63cf\u8ff0\u5df2\u53d1\u751f\u7684\u4e8b\u60c5</li> <li>\u683c\u5f0f\uff1a<code>{Entity}{Action}DomainEvent</code></li> <li>\u4f8b\u5982\uff1a<code>UserCreatedDomainEvent</code>\u3001<code>OrderPaidDomainEvent</code>\u3001<code>ProductUpdatedDomainEvent</code></li> </ul>"},{"location":"development-guide/domain-event-development/#_5","title":"\u4ec0\u4e48\u65f6\u5019\u5e94\u8be5\u53d1\u5e03\u9886\u57df\u4e8b\u4ef6\uff1f","text":"<p>\u9886\u57df\u4e8b\u4ef6\u5e94\u8be5\u5728\u4ee5\u4e0b\u65f6\u673a\u53d1\u5e03\uff1a</p> <ol> <li>\u521b\u5efa\u805a\u5408\u65f6: \u53d1\u5e03 <code>{Entity}CreatedDomainEvent</code></li> <li>\u91cd\u8981\u72b6\u6001\u53d8\u66f4: \u5982\u8ba2\u5355\u652f\u4ed8\u3001\u8ba2\u5355\u53d1\u8d27\u7b49</li> <li>\u4e1a\u52a1\u89c4\u5219\u6267\u884c: \u5982\u7528\u6237\u6fc0\u6d3b\u3001\u4ea7\u54c1\u4e0a\u67b6\u7b49</li> <li>\u805a\u5408\u5220\u9664: \u53d1\u5e03 <code>{Entity}DeletedDomainEvent</code></li> </ol>"},{"location":"development-guide/domain-event-development/#_6","title":"\u5982\u4f55\u7f16\u5199\u57fa\u672c\u9886\u57df\u4e8b\u4ef6\uff1f","text":"<p>\u6587\u4ef6: <code>src/MyProject.Domain/DomainEvents/UserDomainEvents.cs</code></p> <pre><code>using MyProject.Domain.AggregatesModel.UserAggregate;\n\nnamespace MyProject.Domain.DomainEvents;\n\npublic record UserCreatedDomainEvent(User User) : IDomainEvent;\n\npublic record UserEmailChangedDomainEvent(User User) : IDomainEvent;\n\npublic record UserDeletedDomainEvent(User User) : IDomainEvent;\n</code></pre>"},{"location":"development-guide/domain-event-development/#_7","title":"\u5982\u4f55\u7f16\u5199\u5e26\u6709\u989d\u5916\u4fe1\u606f\u7684\u9886\u57df\u4e8b\u4ef6\uff1f","text":"<p>\u6587\u4ef6: <code>src/MyProject.Domain/DomainEvents/OrderDomainEvents.cs</code></p> <pre><code>using MyProject.Domain.AggregatesModel.OrderAggregate;\n\nnamespace MyProject.Domain.DomainEvents;\n\npublic record OrderCreatedDomainEvent(Order Order) : IDomainEvent;\n\npublic record OrderConfirmedDomainEvent(Order Order) : IDomainEvent;\n\npublic record OrderPaidDomainEvent(\n    Order Order, \n    decimal Amount, \n    string PaymentMethod) : IDomainEvent;\n\npublic record OrderShippedDomainEvent(\n    Order Order, \n    string TrackingNumber) : IDomainEvent;\n\npublic record OrderCancelledDomainEvent(\n    Order Order, \n    string Reason) : IDomainEvent;\n\npublic record OrderItemAddedDomainEvent(\n    Order Order, \n    OrderItem Item) : IDomainEvent;\n\npublic record OrderItemRemovedDomainEvent(\n    Order Order, \n    OrderItemId ItemId) : IDomainEvent;\n</code></pre>"},{"location":"development-guide/domain-event-development/#_8","title":"\u5982\u4f55\u7f16\u5199\u590d\u6742\u573a\u666f\u7684\u9886\u57df\u4e8b\u4ef6\uff1f","text":"<p>\u6587\u4ef6: <code>src/MyProject.Domain/DomainEvents/ProductDomainEvents.cs</code></p> <pre><code>using MyProject.Domain.AggregatesModel.ProductAggregate;\n\nnamespace MyProject.Domain.DomainEvents;\n\npublic record ProductCreatedDomainEvent(Product Product) : IDomainEvent;\n\npublic record ProductPriceChangedDomainEvent(\n    Product Product, \n    decimal OldPrice, \n    decimal NewPrice) : IDomainEvent;\n\npublic record ProductStockChangedDomainEvent(\n    Product Product, \n    int OldStock, \n    int NewStock, \n    string Reason) : IDomainEvent;\n\npublic record ProductPublishedDomainEvent(Product Product) : IDomainEvent;\n\npublic record ProductUnpublishedDomainEvent(Product Product) : IDomainEvent;\n</code></pre>"},{"location":"development-guide/domain-event-development/#_9","title":"\u5982\u4f55\u5728\u805a\u5408\u4e2d\u53d1\u5e03\u9886\u57df\u4e8b\u4ef6\uff1f","text":""},{"location":"development-guide/domain-event-development/#_10","title":"\u57fa\u672c\u53d1\u5e03\u65b9\u5f0f","text":"<pre><code>public class User : Entity&lt;UserId&gt;, IAggregateRoot\n{\n    protected User() { }\n\n    public User(string name, string email)\n    {\n        Name = name;\n        Email = email;\n        // \u5728\u6784\u9020\u51fd\u6570\u4e2d\u53d1\u5e03\u521b\u5efa\u4e8b\u4ef6\n        this.AddDomainEvent(new UserCreatedDomainEvent(this));\n    }\n\n    public void ChangeEmail(string email)\n    {\n        if (Email == email)\n        {\n            return; // \u6ca1\u6709\u53d8\u5316\u65f6\u4e0d\u53d1\u5e03\u4e8b\u4ef6\n        }\n\n        Email = email;\n        // \u72b6\u6001\u53d8\u66f4\u65f6\u53d1\u5e03\u4e8b\u4ef6\n        this.AddDomainEvent(new UserEmailChangedDomainEvent(this));\n    }\n\n    public void Delete()\n    {\n        if (IsDeleted)\n        {\n            throw new KnownException(\"\u7528\u6237\u5df2\u88ab\u5220\u9664\");\n        }\n\n        IsDeleted = true;\n        // \u5220\u9664\u65f6\u53d1\u5e03\u4e8b\u4ef6\n        this.AddDomainEvent(new UserDeletedDomainEvent(this));\n    }\n}\n</code></pre>"},{"location":"development-guide/domain-event-development/#_11","title":"\u5982\u4f55\u53d1\u5e03\u5e26\u6709\u989d\u5916\u4fe1\u606f\u7684\u4e8b\u4ef6\uff1f","text":"<pre><code>public class Order : Entity&lt;OrderId&gt;, IAggregateRoot\n{\n    protected Order() { }\n\n    public void Pay(decimal amount, string paymentMethod)\n    {\n        if (OrderStatus != OrderStatus.Confirmed)\n        {\n            throw new KnownException(\"\u53ea\u6709\u5df2\u786e\u8ba4\u7684\u8ba2\u5355\u624d\u80fd\u652f\u4ed8\");\n        }\n\n        if (amount != TotalAmount)\n        {\n            throw new KnownException(\"\u652f\u4ed8\u91d1\u989d\u4e0d\u6b63\u786e\");\n        }\n\n        OrderStatus = OrderStatus.Paid;\n        PaidAt = DateTimeOffset.UtcNow;\n\n        // \u53d1\u5e03\u652f\u4ed8\u4e8b\u4ef6\uff0c\u5305\u542b\u652f\u4ed8\u91d1\u989d\u548c\u652f\u4ed8\u65b9\u5f0f\n        this.AddDomainEvent(new OrderPaidDomainEvent(this, amount, paymentMethod));\n    }\n\n    public void Ship(string trackingNumber)\n    {\n        if (OrderStatus != OrderStatus.Paid)\n        {\n            throw new KnownException(\"\u53ea\u6709\u5df2\u652f\u4ed8\u7684\u8ba2\u5355\u624d\u80fd\u53d1\u8d27\");\n        }\n\n        OrderStatus = OrderStatus.Shipped;\n        ShippedAt = DateTimeOffset.UtcNow;\n        TrackingNumber = trackingNumber;\n\n        // \u53d1\u5e03\u53d1\u8d27\u4e8b\u4ef6\uff0c\u5305\u542b\u7269\u6d41\u5355\u53f7\n        this.AddDomainEvent(new OrderShippedDomainEvent(this, trackingNumber));\n    }\n\n    public void Cancel(string reason)\n    {\n        if (OrderStatus == OrderStatus.Completed)\n        {\n            throw new KnownException(\"\u5df2\u5b8c\u6210\u7684\u8ba2\u5355\u4e0d\u80fd\u53d6\u6d88\");\n        }\n\n        OrderStatus = OrderStatus.Cancelled;\n        CancelledAt = DateTimeOffset.UtcNow;\n        CancelReason = reason;\n\n        // \u53d1\u5e03\u53d6\u6d88\u4e8b\u4ef6\uff0c\u5305\u542b\u53d6\u6d88\u539f\u56e0\n        this.AddDomainEvent(new OrderCancelledDomainEvent(this, reason));\n    }\n}\n</code></pre>"},{"location":"development-guide/domain-event-development/#_12","title":"\u5982\u4f55\u5728\u590d\u6742\u4e1a\u52a1\u573a\u666f\u4e2d\u53d1\u5e03\u4e8b\u4ef6\uff1f","text":"<pre><code>public class Product : Entity&lt;ProductId&gt;, IAggregateRoot\n{\n    protected Product() { }\n\n    public void ChangePrice(decimal newPrice)\n    {\n        if (newPrice &lt;= 0)\n        {\n            throw new KnownException(\"\u4ef7\u683c\u5fc5\u987b\u5927\u4e8e0\");\n        }\n\n        if (Price == newPrice)\n        {\n            return; // \u4ef7\u683c\u6ca1\u6709\u53d8\u5316\n        }\n\n        var oldPrice = Price;\n        Price = newPrice;\n\n        // \u53d1\u5e03\u4ef7\u683c\u53d8\u66f4\u4e8b\u4ef6\uff0c\u5305\u542b\u65b0\u65e7\u4ef7\u683c\n        this.AddDomainEvent(new ProductPriceChangedDomainEvent(this, oldPrice, newPrice));\n    }\n\n    public void IncreaseStock(int quantity, string reason)\n    {\n        if (quantity &lt;= 0)\n        {\n            throw new KnownException(\"\u589e\u52a0\u6570\u91cf\u5fc5\u987b\u5927\u4e8e0\");\n        }\n\n        var oldStock = Stock;\n        Stock += quantity;\n\n        // \u53d1\u5e03\u5e93\u5b58\u53d8\u66f4\u4e8b\u4ef6\n        this.AddDomainEvent(new ProductStockChangedDomainEvent(\n            this, \n            oldStock, \n            Stock, \n            $\"\u589e\u52a0\u5e93\u5b58: {reason}\"));\n    }\n\n    public void DecreaseStock(int quantity, string reason)\n    {\n        if (quantity &lt;= 0)\n        {\n            throw new KnownException(\"\u51cf\u5c11\u6570\u91cf\u5fc5\u987b\u5927\u4e8e0\");\n        }\n\n        if (Stock &lt; quantity)\n        {\n            throw new KnownException(\"\u5e93\u5b58\u4e0d\u8db3\");\n        }\n\n        var oldStock = Stock;\n        Stock -= quantity;\n\n        // \u53d1\u5e03\u5e93\u5b58\u53d8\u66f4\u4e8b\u4ef6\n        this.AddDomainEvent(new ProductStockChangedDomainEvent(\n            this, \n            oldStock, \n            Stock, \n            $\"\u51cf\u5c11\u5e93\u5b58: {reason}\"));\n    }\n\n    public void Publish()\n    {\n        if (IsPublished)\n        {\n            return;\n        }\n\n        IsPublished = true;\n        PublishedAt = DateTimeOffset.UtcNow;\n\n        this.AddDomainEvent(new ProductPublishedDomainEvent(this));\n    }\n\n    public void Unpublish()\n    {\n        if (!IsPublished)\n        {\n            return;\n        }\n\n        IsPublished = false;\n\n        this.AddDomainEvent(new ProductUnpublishedDomainEvent(this));\n    }\n}\n</code></pre>"},{"location":"development-guide/domain-event-development/#_13","title":"\u5982\u4f55\u547d\u540d\u9886\u57df\u4e8b\u4ef6\uff1f","text":""},{"location":"development-guide/domain-event-development/#_14","title":"\u6807\u51c6\u547d\u540d\u683c\u5f0f","text":"<p>\u9886\u57df\u4e8b\u4ef6\u5e94\u8be5\u4f7f\u7528\u8fc7\u53bb\u5f0f\u52a8\u8bcd\uff0c\u8868\u793a\u5df2\u7ecf\u53d1\u751f\u7684\u4e8b\u60c5\uff1a</p> <ul> <li>\u2705 <code>UserCreatedDomainEvent</code> - \u7528\u6237\u5df2\u521b\u5efa</li> <li>\u2705 <code>OrderPaidDomainEvent</code> - \u8ba2\u5355\u5df2\u652f\u4ed8</li> <li>\u2705 <code>ProductPublishedDomainEvent</code> - \u4ea7\u54c1\u5df2\u53d1\u5e03</li> <li>\u274c <code>CreateUserDomainEvent</code> - \u4e0d\u5e94\u4f7f\u7528\u52a8\u8bcd\u539f\u5f62</li> <li>\u274c <code>PayingOrderDomainEvent</code> - \u4e0d\u5e94\u4f7f\u7528\u8fdb\u884c\u65f6</li> </ul>"},{"location":"development-guide/domain-event-development/#_15","title":"\u5e38\u7528\u52a8\u8bcd\u6709\u54ea\u4e9b\uff1f","text":"<ul> <li>Created - \u521b\u5efa</li> <li>Updated - \u66f4\u65b0</li> <li>Deleted - \u5220\u9664</li> <li>Changed - \u53d8\u66f4</li> <li>Confirmed - \u786e\u8ba4</li> <li>Cancelled - \u53d6\u6d88</li> <li>Paid - \u652f\u4ed8</li> <li>Shipped - \u53d1\u8d27</li> <li>Completed - \u5b8c\u6210</li> <li>Published - \u53d1\u5e03</li> <li>Activated - \u6fc0\u6d3b</li> <li>Deactivated - \u505c\u7528</li> </ul>"},{"location":"development-guide/domain-event-development/#_16","title":"\u9886\u57df\u4e8b\u4ef6\u5982\u4f55\u88ab\u5904\u7406\uff1f","text":"<p>\u9886\u57df\u4e8b\u4ef6\u53d1\u5e03\u540e\uff0c\u4f1a\u88ab\u76f8\u5e94\u7684\u9886\u57df\u4e8b\u4ef6\u5904\u7406\u5668\u5904\u7406\u3002\u5173\u4e8e\u5982\u4f55\u7f16\u5199\u9886\u57df\u4e8b\u4ef6\u5904\u7406\u5668\uff0c\u8bf7\u53c2\u8003\u9886\u57df\u4e8b\u4ef6\u5904\u7406\u5668\u5f00\u53d1\u6307\u5357\u3002</p>"},{"location":"development-guide/domain-event-development/#_17","title":"\u9886\u57df\u4e8b\u4ef6\u6709\u54ea\u4e9b\u6700\u4f73\u5b9e\u8df5\uff1f","text":""},{"location":"development-guide/domain-event-development/#1","title":"1. \u4e8b\u4ef6\u7c92\u5ea6","text":"<ul> <li>\u9002\u4e2d\u7c92\u5ea6: \u4e8b\u4ef6\u5e94\u8be5\u4ee3\u8868\u6709\u610f\u4e49\u7684\u4e1a\u52a1\u884c\u4e3a</li> <li>\u907f\u514d\u8fc7\u7ec6: \u4e0d\u8981\u4e3a\u6bcf\u4e2a\u5c5e\u6027\u53d8\u66f4\u90fd\u521b\u5efa\u4e8b\u4ef6</li> <li>\u907f\u514d\u8fc7\u7c97: \u4e00\u4e2a\u4e8b\u4ef6\u4e0d\u5e94\u5305\u542b\u592a\u591a\u4e0d\u76f8\u5173\u7684\u4fe1\u606f</li> </ul>"},{"location":"development-guide/domain-event-development/#2","title":"2. \u4e8b\u4ef6\u4e0d\u53d8\u6027","text":"<ul> <li>\u4f7f\u7528record\u7c7b\u578b: \u786e\u4fdd\u4e8b\u4ef6\u4e0d\u53ef\u53d8</li> <li>\u4f20\u9012\u5fc5\u8981\u4fe1\u606f: \u5305\u542b\u5904\u7406\u4e8b\u4ef6\u6240\u9700\u7684\u6240\u6709\u4fe1\u606f</li> <li>\u907f\u514d\u61d2\u52a0\u8f7d: \u4e8b\u4ef6\u4e2d\u4e0d\u5e94\u5305\u542b\u9700\u8981\u5ef6\u8fdf\u52a0\u8f7d\u7684\u5bfc\u822a\u5c5e\u6027</li> </ul>"},{"location":"development-guide/domain-event-development/#3","title":"3. \u4e8b\u4ef6\u65f6\u5e8f","text":"<ul> <li>\u660e\u786e\u987a\u5e8f: \u4e8b\u4ef6\u5e94\u8be5\u6309\u7167\u4e1a\u52a1\u903b\u8f91\u7684\u987a\u5e8f\u53d1\u5e03</li> <li>\u56e0\u679c\u5173\u7cfb: \u786e\u4fdd\u4e8b\u4ef6\u4e4b\u95f4\u7684\u56e0\u679c\u5173\u7cfb\u6b63\u786e</li> <li>\u5e42\u7b49\u5904\u7406: \u4e8b\u4ef6\u5904\u7406\u5668\u5e94\u8be5\u80fd\u591f\u5904\u7406\u91cd\u590d\u7684\u4e8b\u4ef6</li> </ul>"},{"location":"development-guide/domain-event-development/#4","title":"4. \u4e8b\u4ef6\u8bbe\u8ba1","text":"<pre><code>// \u2705 \u597d\u7684\u8bbe\u8ba1 - \u5305\u542b\u5fc5\u8981\u4fe1\u606f\npublic record OrderPaidDomainEvent(\n    Order Order, \n    decimal Amount, \n    string PaymentMethod, \n    DateTimeOffset PaidAt) : IDomainEvent;\n\n// \u274c \u4e0d\u597d\u7684\u8bbe\u8ba1 - \u4fe1\u606f\u4e0d\u8db3\npublic record OrderPaidDomainEvent(Order Order) : IDomainEvent;\n\n// \u274c \u4e0d\u597d\u7684\u8bbe\u8ba1 - \u5305\u542b\u61d2\u52a0\u8f7d\u5c5e\u6027\npublic record OrderPaidDomainEvent(\n    Order Order, // Order.Customer \u53ef\u80fd\u672a\u52a0\u8f7d\n    Customer Customer) : IDomainEvent;\n</code></pre>"},{"location":"development-guide/domain-event-development/#_18","title":"\u9047\u5230\u5e38\u89c1\u95ee\u9898\u600e\u4e48\u529e\uff1f","text":""},{"location":"development-guide/domain-event-development/#_19","title":"\u4e3a\u4ec0\u4e48\u4e8b\u4ef6\u672a\u53d1\u5e03\uff1f","text":"<p>\u95ee\u9898: \u805a\u5408\u72b6\u6001\u53d8\u66f4\u4e86\u4f46\u4e8b\u4ef6\u672a\u53d1\u5e03</p> <p>\u539f\u56e0: \u5fd8\u8bb0\u8c03\u7528 <code>this.AddDomainEvent()</code></p> <p>\u89e3\u51b3: \u5728\u6240\u6709\u91cd\u8981\u7684\u72b6\u6001\u53d8\u66f4\u65b9\u6cd5\u4e2d\u6dfb\u52a0\u4e8b\u4ef6\u53d1\u5e03\u4ee3\u7801</p>"},{"location":"development-guide/domain-event-development/#_20","title":"\u4e3a\u4ec0\u4e48\u4e8b\u4ef6\u91cd\u590d\u53d1\u5e03\uff1f","text":"<p>\u95ee\u9898: \u540c\u4e00\u4e2a\u4e8b\u4ef6\u88ab\u53d1\u5e03\u591a\u6b21</p> <p>\u539f\u56e0: \u5728\u591a\u4e2a\u5730\u65b9\u91cd\u590d\u8c03\u7528\u4e86 <code>AddDomainEvent</code></p> <p>\u89e3\u51b3: \u786e\u4fdd\u6bcf\u4e2a\u4e1a\u52a1\u64cd\u4f5c\u53ea\u53d1\u5e03\u4e00\u6b21\u76f8\u5e94\u7684\u4e8b\u4ef6</p>"},{"location":"development-guide/domain-event-development/#_21","title":"\u4e3a\u4ec0\u4e48\u4e8b\u4ef6\u5904\u7406\u51fa\u73b0\u5f02\u5e38\uff1f","text":"<p>\u95ee\u9898: \u4e8b\u4ef6\u5904\u7406\u5668\u629b\u51fa\u5f02\u5e38\u5bfc\u81f4\u4e8b\u52a1\u56de\u6eda</p> <p>\u539f\u56e0: \u9886\u57df\u4e8b\u4ef6\u5904\u7406\u5668\u4e2d\u7684\u4e1a\u52a1\u903b\u8f91\u6709\u8bef</p> <p>\u89e3\u51b3: \u53c2\u8003\u9886\u57df\u4e8b\u4ef6\u5904\u7406\u5668\u5f00\u53d1\u6307\u5357\u6b63\u786e\u5b9e\u73b0\u4e8b\u4ef6\u5904\u7406</p>"},{"location":"development-guide/domain-event-development/#_22","title":"\u5728\u54ea\u91cc\u53ef\u4ee5\u627e\u5230\u76f8\u5173\u6587\u6863\uff1f","text":"<ul> <li>\u805a\u5408\u5f00\u53d1\u6307\u5357</li> <li>\u9886\u57df\u4e8b\u4ef6\u5904\u7406\u5668\u5f00\u53d1\u6307\u5357</li> <li>\u96c6\u6210\u4e8b\u4ef6\u5f00\u53d1\u6307\u5357</li> </ul>"},{"location":"development-guide/query-development/","title":"\u67e5\u8be2\u5f00\u53d1\u6307\u5357","text":""},{"location":"development-guide/query-development/#_2","title":"\u4ec0\u4e48\u662f\u67e5\u8be2\uff1f","text":"<p>\u67e5\u8be2\u8d1f\u8d23\u6570\u636e\u68c0\u7d22\uff0c\u9075\u5faaCQRS\u6a21\u5f0f\u3002\u67e5\u8be2\u5e94\u8be5\u662f\u65e0\u526f\u4f5c\u7528\u7684\uff0c\u53ea\u8bfb\u53d6\u6570\u636e\u4e0d\u4fee\u6539\u72b6\u6001\u3002\u672c\u6a21\u677f\u4f7f\u7528 MediatR \u5e93\u5b9e\u73b0\u67e5\u8be2\u5904\u7406\uff0c\u6240\u6709\u67e5\u8be2\u5904\u7406\u5668\u4f1a\u88ab\u6846\u67b6\u81ea\u52a8\u6ce8\u518c\u3002</p>"},{"location":"development-guide/query-development/#_3","title":"\u67e5\u8be2\u4e0e\u4ed3\u50a8\u6709\u4ec0\u4e48\u533a\u522b\uff1f","text":"<p>\u67e5\u8be2 vs \u4ed3\u50a8\u7684\u804c\u8d23\u5206\u79bb\uff1a</p> <ul> <li>\u67e5\u8be2\u5904\u7406\u5668\uff1a\u7528\u4e8e\u7eaf\u7cb9\u7684\u6570\u636e\u8bfb\u53d6\uff0c\u5e94\u8be5\u76f4\u63a5\u8bbf\u95eeDbContext</li> <li>\u4ed3\u50a8\u65b9\u6cd5\uff1a\u53ea\u7528\u4e8e\u547d\u4ee4\u5904\u7406\u5668\u4e2d\u9700\u8981\u83b7\u53d6\u805a\u5408\u8fdb\u884c\u4e1a\u52a1\u64cd\u4f5c\u7684\u573a\u666f</li> </ul> <p>\u67e5\u8be2\u8bbe\u8ba1\u6307\u5bfc\uff1a</p> <ul> <li>\u67e5\u8be2\u662f\u4e3a\u4e86\u5c55\u793a\u6570\u636e\uff0c\u4e0d\u6d89\u53ca\u4e1a\u52a1\u903b\u8f91 \u2192 \u76f4\u63a5\u4f7f\u7528DbContext</li> <li>\u67e5\u8be2\u53ef\u4ee5\u8de8\u805a\u5408\u3001\u8de8\u8868\u8fdb\u884c\u590d\u6742\u7684\u6570\u636e\u7ec4\u5408</li> <li>\u67e5\u8be2\u53ef\u4ee5\u4f7f\u7528\u6295\u5f71(Projection)\u548c\u533f\u540d\u7c7b\u578b\u4f18\u5316\u6027\u80fd</li> <li>\u907f\u514d\u5728\u67e5\u8be2\u4e2d\u8c03\u7528\u4ed3\u50a8\u65b9\u6cd5</li> </ul>"},{"location":"development-guide/query-development/#_4","title":"\u67e5\u8be2\u6587\u4ef6\u5e94\u8be5\u653e\u5728\u54ea\u91cc\uff1f","text":"<p>\u7c7b\u6587\u4ef6\u547d\u540d\u5e94\u9075\u5faa\u4ee5\u4e0b\u89c4\u5219\uff1a</p> <ul> <li>\u5e94\u653e\u7f6e\u5728 <code>src/{ProjectName}.Web/Application/Queries/{Module}/</code> \u76ee\u5f55\u4e0b</li> <li>\u67e5\u8be2\u6587\u4ef6\u540d\u683c\u5f0f\u4e3a <code>{Action}{Entity}Query.cs</code></li> <li>\u67e5\u8be2\u3001\u9a8c\u8bc1\u5668\u3001\u5904\u7406\u5668\u548cDTO\u5b9a\u4e49\u5728\u540c\u4e00\u6587\u4ef6\u4e2d</li> </ul>"},{"location":"development-guide/query-development/#_5","title":"\u5982\u4f55\u5b9a\u4e49\u67e5\u8be2\uff1f","text":"<p>\u67e5\u8be2\u7684\u5b9a\u4e49\u5e94\u9075\u5faa\u4ee5\u4e0b\u89c4\u5219\uff1a</p> <ul> <li>\u67e5\u8be2\u5b9e\u73b0 <code>IQuery&lt;TResponse&gt;</code> \u63a5\u53e3</li> <li>\u5fc5\u987b\u4e3a\u6bcf\u4e2a\u67e5\u8be2\u521b\u5efa\u9a8c\u8bc1\u5668\uff0c\u7ee7\u627f <code>AbstractValidator&lt;TQuery&gt;</code></li> <li>\u67e5\u8be2\u5904\u7406\u5668\u5b9e\u73b0 <code>IQueryHandler&lt;TQuery, TResponse&gt;</code> \u63a5\u53e3</li> <li>\u4f7f\u7528 <code>record</code> \u7c7b\u578b\u5b9a\u4e49\u67e5\u8be2\u548cDTO</li> <li>\u76f4\u63a5\u4f7f\u7528ApplicationDbContext\u8fdb\u884c\u6570\u636e\u8bbf\u95ee</li> </ul>"},{"location":"development-guide/query-development/#_6","title":"\u67e5\u8be2\u5904\u7406\u5668\u6709\u54ea\u4e9b\u6700\u4f73\u5b9e\u8df5\uff1f","text":""},{"location":"development-guide/query-development/#_7","title":"\u5982\u4f55\u8bbf\u95ee\u6570\u636e\uff1f","text":"<ul> <li>\u76f4\u63a5\u8bbf\u95eeDbContext: \u67e5\u8be2\u5904\u7406\u5668\u5e94\u76f4\u63a5\u6ce8\u5165\u548c\u4f7f\u7528ApplicationDbContext</li> <li>\u907f\u514d\u4f7f\u7528\u4ed3\u50a8: \u4ed3\u50a8\u65b9\u6cd5\u4ec5\u7528\u4e8e\u547d\u4ee4\u5904\u7406\u5668\u7684\u4e1a\u52a1\u64cd\u4f5c</li> <li>\u4f18\u5316\u67e5\u8be2\u6027\u80fd: \u4f7f\u7528\u6295\u5f71(Select)\u3001\u8fc7\u6ee4(WhereIf)\u3001\u6392\u5e8f(OrderByIf)\u3001\u5206\u9875(ToPagedDataAsync)\u7b49\u4f18\u5316\u6027\u80fd</li> <li>\u5f02\u6b65\u64cd\u4f5c: \u6240\u6709\u6570\u636e\u5e93\u64cd\u4f5c\u90fd\u5e94\u4f7f\u7528\u5f02\u6b65\u7248\u672c</li> <li>\u6b63\u786e\u7684\u53d6\u6d88\u4ee4\u724c\u4f20\u9012: \u5c06CancellationToken\u4f20\u9012\u7ed9\u6240\u6709\u5f02\u6b65\u64cd\u4f5c</li> <li>\u53ea\u8bfb\u64cd\u4f5c: \u67e5\u8be2\u4e0d\u5e94\u4fee\u6539\u4efb\u4f55\u6570\u636e\u72b6\u6001</li> </ul>"},{"location":"development-guide/query-development/#_8","title":"\u6761\u4ef6\u67e5\u8be2\u6709\u4ec0\u4e48\u6700\u4f73\u5b9e\u8df5\uff1f","text":"<ul> <li>\u4f7f\u7528WhereIf: \u6839\u636e\u6761\u4ef6\u52a8\u6001\u6dfb\u52a0\u8fc7\u6ee4\u6761\u4ef6\uff0c\u907f\u514d\u7e41\u7410\u7684if-else\u5224\u65ad</li> <li>\u4f7f\u7528OrderByIf/ThenByIf: \u6839\u636e\u53c2\u6570\u52a8\u6001\u6392\u5e8f\uff0c\u652f\u6301\u591a\u5b57\u6bb5\u6392\u5e8f</li> <li>\u4f7f\u7528ToPagedDataAsync: \u81ea\u52a8\u5904\u7406\u5206\u9875\u903b\u8f91\uff0c\u8fd4\u56de\u5b8c\u6574\u7684\u5206\u9875\u4fe1\u606f</li> <li>\u786e\u4fdd\u9ed8\u8ba4\u6392\u5e8f: \u5728\u52a8\u6001\u6392\u5e8f\u65f6\u59cb\u7ec8\u63d0\u4f9b\u9ed8\u8ba4\u6392\u5e8f\u5b57\u6bb5\uff0c\u786e\u4fdd\u7ed3\u679c\u7a33\u5b9a\u6027</li> </ul>"},{"location":"development-guide/query-development/#_9","title":"\u9700\u8981\u5f15\u7528\u54ea\u4e9b\u547d\u540d\u7a7a\u95f4\uff1f","text":"<p>\u67e5\u8be2\u6587\u4ef6\u4e2d\u7684\u5fc5\u8981\u5f15\u7528\u5df2\u5728GlobalUsings.cs\u4e2d\u5b9a\u4e49\uff1a</p> <ul> <li><code>global using FluentValidation;</code> - \u7528\u4e8e\u9a8c\u8bc1\u5668</li> <li><code>global using MediatR;</code> - \u7528\u4e8e\u67e5\u8be2\u5904\u7406\u5668\u63a5\u53e3</li> <li><code>global using NetCorePal.Extensions.Primitives;</code> - \u7528\u4e8eKnownException\u7b49</li> <li><code>global using NetCorePal.Extensions.AspNetCore;</code> - \u7528\u4e8eToPagedDataAsync\u3001WhereIf\u3001OrderByIf\u7b49\u6269\u5c55\u65b9\u6cd5</li> </ul> <p>\u5206\u9875\u67e5\u8be2\u989d\u5916\u9700\u8981\u7684\u5f15\u7528\uff1a</p> <pre><code>using Microsoft.EntityFrameworkCore; // \u7528\u4e8eEF Core\u6269\u5c55\u65b9\u6cd5(FirstOrDefaultAsync, ToListAsync\u7b49)\n</code></pre>"},{"location":"development-guide/query-development/#_10","title":"\u5982\u4f55\u7f16\u5199\u5355\u4e2a\u5bf9\u8c61\u67e5\u8be2\uff1f","text":""},{"location":"development-guide/query-development/#_11","title":"\u5355\u4e2a\u5bf9\u8c61\u67e5\u8be2\u793a\u4f8b","text":"<p>\u6587\u4ef6: <code>src/MyProject.Web/Application/Queries/User/GetUserQuery.cs</code></p> <pre><code>using MyProject.Domain.AggregatesModel.UserAggregate;\nusing MyProject.Infrastructure;\nusing Microsoft.EntityFrameworkCore; // \u5fc5\u9700\uff1a\u7528\u4e8eEF Core\u6269\u5c55\u65b9\u6cd5\n\nnamespace MyProject.Web.Application.Queries.User;\n\npublic record GetUserQuery(UserId UserId) : IQuery&lt;UserDto&gt;;\n\npublic class GetUserQueryValidator : AbstractValidator&lt;GetUserQuery&gt;\n{\n    public GetUserQueryValidator()\n    {\n        RuleFor(x =&gt; x.UserId)\n            .NotEmpty()\n            .WithMessage(\"\u7528\u6237ID\u4e0d\u80fd\u4e3a\u7a7a\");\n    }\n}\n\npublic class GetUserQueryHandler(ApplicationDbContext context) \n    : IQueryHandler&lt;GetUserQuery, UserDto&gt;\n{\n    public async Task&lt;UserDto&gt; Handle(GetUserQuery request, CancellationToken cancellationToken)\n    {\n        var user = await context.Users\n            .Where(x =&gt; x.Id == request.UserId)\n            .Select(x =&gt; new UserDto(x.Id, x.Name, x.Email))\n            .FirstOrDefaultAsync(cancellationToken) ??\n            throw new KnownException($\"\u672a\u627e\u5230\u7528\u6237\uff0cUserId = {request.UserId}\");\n\n        return user;\n    }\n}\n\npublic record UserDto(UserId Id, string Name, string Email);\n</code></pre>"},{"location":"development-guide/query-development/#_12","title":"\u5982\u4f55\u7f16\u5199\u5206\u9875\u67e5\u8be2\uff1f","text":"<p>\u6587\u4ef6: <code>src/MyProject.Web/Application/Queries/User/GetUserListQuery.cs</code></p> <pre><code>using MyProject.Domain.AggregatesModel.UserAggregate;\nusing MyProject.Infrastructure;\nusing Microsoft.EntityFrameworkCore; // \u5fc5\u9700\uff1a\u7528\u4e8eEF Core\u6269\u5c55\u65b9\u6cd5\n\nnamespace MyProject.Web.Application.Queries.User;\n\npublic record GetUserListQuery(\n    int PageIndex = 1, \n    int PageSize = 20, \n    string? SearchName = null, \n    string? SortBy = null, \n    bool Desc = false) : IQuery&lt;PagedData&lt;UserListItemDto&gt;&gt;;\n\npublic class GetUserListQueryValidator : AbstractValidator&lt;GetUserListQuery&gt;\n{\n    public GetUserListQueryValidator()\n    {\n        RuleFor(x =&gt; x.PageIndex)\n            .GreaterThan(0)\n            .WithMessage(\"\u9875\u7801\u5fc5\u987b\u5927\u4e8e0\");\n\n        RuleFor(x =&gt; x.PageSize)\n            .GreaterThan(0)\n            .LessThanOrEqualTo(100)\n            .WithMessage(\"\u6bcf\u9875\u5927\u5c0f\u5fc5\u987b\u57281-100\u4e4b\u95f4\");\n    }\n}\n\npublic class GetUserListQueryHandler(ApplicationDbContext context) \n    : IQueryHandler&lt;GetUserListQuery, PagedData&lt;UserListItemDto&gt;&gt;\n{\n    public async Task&lt;PagedData&lt;UserListItemDto&gt;&gt; Handle(\n        GetUserListQuery request, \n        CancellationToken cancellationToken)\n    {\n        var query = context.Users.AsQueryable();\n\n        // \u4f7f\u7528 WhereIf \u8fdb\u884c\u6761\u4ef6\u8fc7\u6ee4\n        query = query.WhereIf(\n            !string.IsNullOrWhiteSpace(request.SearchName), \n            x =&gt; x.Name.Contains(request.SearchName!));\n\n        // \u4f7f\u7528 OrderByIf \u8fdb\u884c\u6761\u4ef6\u6392\u5e8f\n        var orderedQuery = query\n            .OrderByIf(request.SortBy == \"name\", x =&gt; x.Name, request.Desc)\n            .ThenByIf(request.SortBy == \"email\", x =&gt; x.Email, request.Desc)\n            .ThenByIf(string.IsNullOrEmpty(request.SortBy), x =&gt; x.Id); // \u9ed8\u8ba4\u6392\u5e8f\n\n        // \u4f7f\u7528 ToPagedDataAsync \u8fdb\u884c\u5206\u9875\n        return await orderedQuery\n            .Select(u =&gt; new UserListItemDto(u.Id, u.Name, u.Email))\n            .ToPagedDataAsync(\n                request.PageIndex, \n                request.PageSize, \n                cancellationToken: cancellationToken);\n    }\n}\n\npublic record UserListItemDto(UserId Id, string Name, string Email);\n</code></pre>"},{"location":"development-guide/query-development/#_13","title":"\u5982\u4f55\u7f16\u5199\u8de8\u805a\u5408\u67e5\u8be2\uff1f","text":"<p>\u6587\u4ef6: <code>src/MyProject.Web/Application/Queries/Order/GetOrderDetailQuery.cs</code></p> <pre><code>using MyProject.Domain.AggregatesModel.OrderAggregate;\nusing MyProject.Infrastructure;\nusing Microsoft.EntityFrameworkCore;\n\nnamespace MyProject.Web.Application.Queries.Order;\n\npublic record GetOrderDetailQuery(OrderId OrderId) : IQuery&lt;OrderDetailDto&gt;;\n\npublic class GetOrderDetailQueryValidator : AbstractValidator&lt;GetOrderDetailQuery&gt;\n{\n    public GetOrderDetailQueryValidator()\n    {\n        RuleFor(x =&gt; x.OrderId)\n            .NotEmpty()\n            .WithMessage(\"\u8ba2\u5355ID\u4e0d\u80fd\u4e3a\u7a7a\");\n    }\n}\n\npublic class GetOrderDetailQueryHandler(ApplicationDbContext context) \n    : IQueryHandler&lt;GetOrderDetailQuery, OrderDetailDto&gt;\n{\n    public async Task&lt;OrderDetailDto&gt; Handle(\n        GetOrderDetailQuery request, \n        CancellationToken cancellationToken)\n    {\n        // \u8de8\u805a\u5408\u67e5\u8be2\uff0c\u5305\u542b\u8ba2\u5355\u548c\u8ba2\u5355\u9879\n        var order = await context.Orders\n            .Include(o =&gt; o.OrderItems)\n            .Where(o =&gt; o.Id == request.OrderId)\n            .Select(o =&gt; new OrderDetailDto(\n                o.Id,\n                o.CustomerName,\n                o.OrderStatus.ToString(),\n                o.OrderItems.Select(i =&gt; new OrderItemDto(\n                    i.Id,\n                    i.ProductName,\n                    i.Price,\n                    i.Quantity\n                )).ToList()\n            ))\n            .FirstOrDefaultAsync(cancellationToken) ??\n            throw new KnownException($\"\u672a\u627e\u5230\u8ba2\u5355\uff0cOrderId = {request.OrderId}\");\n\n        return order;\n    }\n}\n\npublic record OrderDetailDto(\n    OrderId Id,\n    string CustomerName,\n    string Status,\n    List&lt;OrderItemDto&gt; Items);\n\npublic record OrderItemDto(\n    OrderItemId Id,\n    string ProductName,\n    decimal Price,\n    int Quantity);\n</code></pre>"},{"location":"development-guide/query-development/#_14","title":"\u6846\u67b6\u63d0\u4f9b\u4e86\u54ea\u4e9b\u6269\u5c55\u65b9\u6cd5\uff1f","text":""},{"location":"development-guide/query-development/#whereif-","title":"WhereIf - \u5982\u4f55\u6761\u4ef6\u8fc7\u6ee4\uff1f","text":"<p>\u4f7f\u7528 <code>WhereIf</code> \u65b9\u6cd5\u53ef\u4ee5\u6839\u636e\u6761\u4ef6\u52a8\u6001\u6dfb\u52a0 Where \u5b50\u53e5\uff0c\u907f\u514d\u7f16\u5199\u5197\u957f\u7684\u6761\u4ef6\u5224\u65ad\u4ee3\u7801\uff1a</p> <pre><code>// \u4f20\u7edf\u5199\u6cd5\nvar query = context.Users.AsQueryable();\nif (!string.IsNullOrWhiteSpace(searchName))\n{\n    query = query.Where(x =&gt; x.Name.Contains(searchName));\n}\nif (isActive.HasValue)\n{\n    query = query.Where(x =&gt; x.IsActive == isActive.Value);\n}\n\n// \u4f7f\u7528 WhereIf \u7684\u7b80\u5316\u5199\u6cd5\nvar query = context.Users\n    .WhereIf(!string.IsNullOrWhiteSpace(searchName), x =&gt; x.Name.Contains(searchName!))\n    .WhereIf(isActive.HasValue, x =&gt; x.IsActive == isActive!.Value);\n</code></pre>"},{"location":"development-guide/query-development/#orderbyif-thenbyif-","title":"OrderByIf / ThenByIf - \u5982\u4f55\u6761\u4ef6\u6392\u5e8f\uff1f","text":"<p>\u4f7f\u7528 <code>OrderByIf</code> \u548c <code>ThenByIf</code> \u65b9\u6cd5\u53ef\u4ee5\u6839\u636e\u6761\u4ef6\u52a8\u6001\u6dfb\u52a0\u6392\u5e8f\uff1a</p> <pre><code>// \u590d\u6742\u7684\u52a8\u6001\u6392\u5e8f\u793a\u4f8b\nvar orderedQuery = context.Users\n    .OrderByIf(sortBy == \"name\", x =&gt; x.Name, desc)\n    .ThenByIf(sortBy == \"email\", x =&gt; x.Email, desc)\n    .ThenByIf(sortBy == \"createTime\", x =&gt; x.CreateTime, desc)\n    .ThenByIf(string.IsNullOrEmpty(sortBy), x =&gt; x.Id); // \u9ed8\u8ba4\u6392\u5e8f\n\n// \u53c2\u6570\u8bf4\u660e\uff1a\n// - condition: \u6761\u4ef6\u8868\u8fbe\u5f0f\uff0c\u4e3a true \u65f6\u624d\u5e94\u7528\u6392\u5e8f\n// - predicate: \u6392\u5e8f\u5b57\u6bb5\u8868\u8fbe\u5f0f\n// - desc: \u53ef\u9009\u53c2\u6570\uff0c\u662f\u5426\u964d\u5e8f\u6392\u5e8f\uff0c\u9ed8\u8ba4\u4e3a false\uff08\u5347\u5e8f\uff09\n</code></pre>"},{"location":"development-guide/query-development/#topageddataasync-","title":"ToPagedDataAsync - \u5982\u4f55\u5904\u7406\u5206\u9875\u6570\u636e\uff1f","text":"<p>\u4f7f\u7528 <code>ToPagedDataAsync</code> \u65b9\u6cd5\u53ef\u4ee5\u81ea\u52a8\u5904\u7406\u5206\u9875\u903b\u8f91\uff0c\u8fd4\u56de <code>PagedData&lt;T&gt;</code> \u7c7b\u578b\uff1a</p> <pre><code>// \u57fa\u672c\u5206\u9875\u7528\u6cd5 - \u9ed8\u8ba4\u4f1a\u67e5\u8be2\u603b\u6570\nvar pagedResult = await query\n    .Select(u =&gt; new UserListItemDto(u.Id, u.Name, u.Email))\n    .ToPagedDataAsync(pageIndex, pageSize, cancellationToken: cancellationToken);\n\n// \u6027\u80fd\u4f18\u5316\u7248\u672c - \u4e0d\u67e5\u8be2\u603b\u6570\uff08\u9002\u7528\u4e8e\u4e0d\u9700\u8981\u663e\u793a\u603b\u9875\u6570\u7684\u573a\u666f\uff09\nvar pagedResult = await query\n    .Select(u =&gt; new UserListItemDto(u.Id, u.Name, u.Email))\n    .ToPagedDataAsync(pageIndex, pageSize, countTotal: false, cancellationToken);\n\n// PagedData&lt;T&gt; \u5305\u542b\u4ee5\u4e0b\u5c5e\u6027\uff1a\n// - Items: IEnumerable&lt;T&gt; - \u5f53\u524d\u9875\u6570\u636e\n// - Total: int - \u603b\u8bb0\u5f55\u6570\n// - PageIndex: int - \u5f53\u524d\u9875\u7801\n// - PageSize: int - \u6bcf\u9875\u5927\u5c0f\n</code></pre>"},{"location":"development-guide/query-development/#_15","title":"\u5982\u4f55\u7f16\u5199\u5b8c\u6574\u7684\u5206\u9875\u67e5\u8be2\uff1f","text":"<pre><code>public class GetProductListQueryHandler(ApplicationDbContext context) \n    : IQueryHandler&lt;GetProductListQuery, PagedData&lt;ProductListItemDto&gt;&gt;\n{\n    public async Task&lt;PagedData&lt;ProductListItemDto&gt;&gt; Handle(\n        GetProductListQuery request, \n        CancellationToken cancellationToken)\n    {\n        return await context.Products\n            // \u6761\u4ef6\u8fc7\u6ee4\n            .WhereIf(!string.IsNullOrWhiteSpace(request.Name), x =&gt; x.Name.Contains(request.Name!))\n            .WhereIf(request.CategoryId.HasValue, x =&gt; x.CategoryId == request.CategoryId!.Value)\n            .WhereIf(request.MinPrice.HasValue, x =&gt; x.Price &gt;= request.MinPrice!.Value)\n            .WhereIf(request.MaxPrice.HasValue, x =&gt; x.Price &lt;= request.MaxPrice!.Value)\n            .WhereIf(request.IsActive.HasValue, x =&gt; x.IsActive == request.IsActive!.Value)\n            // \u52a8\u6001\u6392\u5e8f\n            .OrderByIf(request.SortBy == \"name\", x =&gt; x.Name, request.Desc)\n            .ThenByIf(request.SortBy == \"price\", x =&gt; x.Price, request.Desc)\n            .ThenByIf(request.SortBy == \"createTime\", x =&gt; x.CreateTime, request.Desc)\n            .ThenByIf(string.IsNullOrEmpty(request.SortBy), x =&gt; x.Id) // \u9ed8\u8ba4\u6392\u5e8f\u786e\u4fdd\u7ed3\u679c\u7a33\u5b9a\n            // \u6570\u636e\u6295\u5f71\n            .Select(p =&gt; new ProductListItemDto(\n                p.Id, \n                p.Name, \n                p.Price, \n                p.CategoryName, \n                p.IsActive,\n                p.CreateTime))\n            // \u5206\u9875\u5904\u7406\n            .ToPagedDataAsync(\n                request.PageIndex, \n                request.PageSize, \n                cancellationToken: cancellationToken);\n    }\n}\n</code></pre>"},{"location":"development-guide/query-development/#id","title":"\u5982\u4f55\u5904\u7406\u5f3a\u7c7b\u578bID\uff1f","text":"<ul> <li>\u5728\u67e5\u8be2\u548cDTO\u4e2d\u76f4\u63a5\u4f7f\u7528\u5f3a\u7c7b\u578bID\u7c7b\u578b\uff0c\u5982 <code>UserId</code>\u3001<code>OrderId</code></li> <li>\u907f\u514d\u4f7f\u7528 <code>.Value</code> \u5c5e\u6027\u8bbf\u95ee\u5185\u90e8\u503c</li> <li>\u4f9d\u8d56\u6846\u67b6\u7684\u9690\u5f0f\u8f6c\u6362\u5904\u7406\u7c7b\u578b\u8f6c\u6362</li> </ul>"},{"location":"development-guide/query-development/#_16","title":"\u9047\u5230\u5e38\u89c1\u9519\u8bef\u600e\u4e48\u529e\uff1f","text":""},{"location":"development-guide/query-development/#entity-framework","title":"\u4e3a\u4ec0\u4e48Entity Framework\u6269\u5c55\u65b9\u6cd5\u62a5\u9519\uff1f","text":"<p>\u9519\u8bef: <code>IQueryable&lt;T&gt;\"\u672a\u5305\u542b\"CountAsync\"\u7684\u5b9a\u4e49</code> \u9519\u8bef: <code>IQueryable&lt;T&gt;\"\u672a\u5305\u542b\"ToListAsync\"\u7684\u5b9a\u4e49</code> \u9519\u8bef: <code>IQueryable&lt;T&gt;\"\u672a\u5305\u542b\"FirstOrDefaultAsync\"\u7684\u5b9a\u4e49</code></p> <p>\u539f\u56e0: \u7f3a\u5c11 Entity Framework Core \u7684 using \u5f15\u7528</p> <p>\u89e3\u51b3: \u5728\u67e5\u8be2\u6587\u4ef6\u4e2d\u6dfb\u52a0 <code>using Microsoft.EntityFrameworkCore;</code></p>"},{"location":"development-guide/query-development/#dbcontext","title":"\u4e3a\u4ec0\u4e48\u4f1a\u51fa\u73b0DbContext\u8bbf\u95ee\u9519\u8bef\uff1f","text":"<p>\u9519\u8bef: \u5728\u67e5\u8be2\u5904\u7406\u5668\u4e2d\u4f7f\u7528\u4ed3\u50a8\u65b9\u6cd5</p> <p>\u539f\u56e0: \u804c\u8d23\u6df7\u6dc6\uff0c\u67e5\u8be2\u5e94\u76f4\u63a5\u4f7f\u7528 DbContext</p> <p>\u89e3\u51b3:  - \u67e5\u8be2\u5904\u7406\u5668\u76f4\u63a5\u6ce8\u5165 <code>ApplicationDbContext</code> - \u4f7f\u7528 <code>context.EntitySetName</code> \u76f4\u63a5\u8bbf\u95ee\u6570\u636e - \u907f\u514d\u8c03\u7528\u4ed3\u50a8\u65b9\u6cd5</p>"},{"location":"development-guide/query-development/#_17","title":"\u4e3a\u4ec0\u4e48\u6846\u67b6\u6269\u5c55\u65b9\u6cd5\u627e\u4e0d\u5230\uff1f","text":"<p>\u9519\u8bef: <code>IQueryable&lt;T&gt;\"\u672a\u5305\u542b\"WhereIf\"\u7684\u5b9a\u4e49</code> \u9519\u8bef: <code>IQueryable&lt;T&gt;\"\u672a\u5305\u542b\"OrderByIf\"\u7684\u5b9a\u4e49</code> \u9519\u8bef: <code>IQueryable&lt;T&gt;\"\u672a\u5305\u542b\"ToPagedDataAsync\"\u7684\u5b9a\u4e49</code></p> <p>\u539f\u56e0: NetCorePal.Extensions.AspNetCore \u7684 using \u5f15\u7528\u95ee\u9898</p> <p>\u89e3\u51b3: \u786e\u4fdd <code>global using NetCorePal.Extensions.AspNetCore;</code> \u5df2\u5728GlobalUsings.cs\u4e2d\u5b9a\u4e49</p>"},{"location":"development-guide/query-development/#_18","title":"\u67e5\u8be2\u5f00\u53d1\u6709\u54ea\u4e9b\u6700\u4f73\u5b9e\u8df5\uff1f","text":"<ol> <li>\u6295\u5f71\u4f18\u5316: \u4f7f\u7528 <code>Select()</code> \u6295\u5f71\u907f\u514d\u67e5\u8be2\u4e0d\u9700\u8981\u7684\u5b57\u6bb5</li> <li>\u6761\u4ef6\u8fc7\u6ee4: \u5408\u7406\u4f7f\u7528 <code>WhereIf()</code> \u8fdb\u884c\u6761\u4ef6\u8fc7\u6ee4</li> <li>\u52a8\u6001\u6392\u5e8f: \u4f7f\u7528 <code>OrderByIf()</code> \u548c <code>ThenByIf()</code> \u5b9e\u73b0\u7075\u6d3b\u6392\u5e8f</li> <li>\u5206\u9875\u5904\u7406: \u4f7f\u7528 <code>ToPagedDataAsync()</code> \u7b80\u5316\u5206\u9875\u903b\u8f91</li> <li>\u9ed8\u8ba4\u6392\u5e8f: \u5728\u52a8\u6001\u6392\u5e8f\u65f6\uff0c\u59cb\u7ec8\u63d0\u4f9b\u9ed8\u8ba4\u6392\u5e8f\u5b57\u6bb5\u786e\u4fdd\u7ed3\u679c\u7a33\u5b9a\u6027</li> <li>\u53ea\u8bfb\u67e5\u8be2: \u67e5\u8be2\u4e0d\u5e94\u4fee\u6539\u6570\u636e\u72b6\u6001</li> <li>\u76f4\u63a5\u8bbf\u95ee: \u76f4\u63a5\u4f7f\u7528DbContext\uff0c\u4e0d\u901a\u8fc7\u4ed3\u50a8</li> </ol>"},{"location":"development-guide/query-development/#_19","title":"\u5728\u54ea\u91cc\u53ef\u4ee5\u627e\u5230\u76f8\u5173\u6587\u6863\uff1f","text":"<ul> <li>\u547d\u4ee4\u5f00\u53d1\u6307\u5357</li> <li>DTO\u8bbe\u8ba1\u6700\u4f73\u5b9e\u8df5</li> <li>\u6027\u80fd\u4f18\u5316\u6307\u5357</li> </ul>"},{"location":"development-guide/repository-development/","title":"\u4ed3\u50a8\u5f00\u53d1\u6307\u5357","text":""},{"location":"development-guide/repository-development/#_2","title":"\u4ec0\u4e48\u662f\u4ed3\u50a8\uff1f","text":"<p>\u4ed3\u50a8\u6a21\u5f0f\u5c01\u88c5\u4e86\u805a\u5408\u6839\u7684\u6301\u4e45\u5316\u903b\u8f91\uff0c\u63d0\u4f9b\u7c7b\u4f3c\u96c6\u5408\u7684\u8bbf\u95ee\u63a5\u53e3\u3002\u672c\u6a21\u677f\u4e2d\u4ed3\u50a8\u63a5\u53e3\u5b9a\u4e49\u5728\u57fa\u7840\u8bbe\u65bd\u5c42\uff0c\u5b9e\u73b0\u4e5f\u5728\u57fa\u7840\u8bbe\u65bd\u5c42\uff0c\u9075\u5faa\u4f9d\u8d56\u5012\u7f6e\u539f\u5219\u3002</p>"},{"location":"development-guide/repository-development/#_3","title":"\u4ed3\u50a8\u8bbe\u8ba1\u6709\u54ea\u4e9b\u91cd\u8981\u539f\u5219\uff1f","text":"<ul> <li>\u6bcf\u4e2a\u805a\u5408\u6839\u5bf9\u5e94\u4e00\u4e2a\u4ed3\u50a8</li> <li>\u4ed3\u50a8\u63a5\u53e3\u548c\u5b9e\u73b0\u5e94\u653e\u7f6e\u5728 <code>src/{ProjectName}.Infrastructure/Repositories/</code> \u76ee\u5f55\u4e0b</li> <li>\u63a5\u53e3\u548c\u5b9e\u73b0\u5b9a\u4e49\u5728\u540c\u4e00\u4e2a\u6587\u4ef6\u4e2d\uff0c\u6587\u4ef6\u540d\u683c\u5f0f\u4e3a <code>{AggregateName}Repository.cs</code></li> <li>\u63a5\u53e3\u5fc5\u987b\u7ee7\u627f <code>IRepository&lt;TEntity, TKey&gt;</code></li> <li>\u5b9e\u73b0\u5fc5\u987b\u7ee7\u627f <code>RepositoryBase&lt;TEntity, TKey, TDbContext&gt;</code></li> <li>\u4ed3\u50a8\u7c7b\u4f1a\u88ab\u81ea\u52a8\u6ce8\u518c\u5230\u4f9d\u8d56\u6ce8\u5165\u5bb9\u5668\u4e2d\uff0c\u65e0\u9700\u624b\u52a8\u6ce8\u518c</li> <li>\u9ed8\u8ba4\u57fa\u7c7b\u5df2\u7ecf\u5b9e\u73b0\u4e86\u4e00\u7ec4\u5e38\u7528\u65b9\u6cd5\uff0c\u5982\u65e0\u5fc5\u8981\uff0c\u5c3d\u91cf\u4e0d\u8981\u5b9a\u4e49\u65b0\u7684\u4ed3\u50a8\u65b9\u6cd5</li> </ul>"},{"location":"development-guide/repository-development/#_4","title":"\u4ed3\u50a8\u6587\u4ef6\u5e94\u8be5\u653e\u5728\u54ea\u91cc\uff1f","text":"<p>\u7c7b\u6587\u4ef6\u547d\u540d\u5e94\u9075\u5faa\u4ee5\u4e0b\u89c4\u5219\uff1a</p> <ul> <li>\u5e94\u653e\u7f6e\u5728 <code>src/{ProjectName}.Infrastructure/Repositories/</code> \u76ee\u5f55\u4e0b</li> <li>\u6587\u4ef6\u540d\u683c\u5f0f\u4e3a <code>{AggregateName}Repository.cs</code></li> <li>\u63a5\u53e3\u548c\u5b9e\u73b0\u5728\u540c\u4e00\u6587\u4ef6\u4e2d</li> </ul>"},{"location":"development-guide/repository-development/#_5","title":"\u5982\u4f55\u5b9a\u4e49\u4ed3\u50a8\uff1f","text":"<p>\u4ed3\u50a8\u7684\u5b9a\u4e49\u5e94\u9075\u5faa\u4ee5\u4e0b\u89c4\u5219\uff1a</p> <ul> <li>\u63a5\u53e3\u7ee7\u627f <code>IRepository&lt;TEntity, TKey&gt;</code></li> <li>\u5b9e\u73b0\u7ee7\u627f <code>RepositoryBase&lt;TEntity, TKey, TDbContext&gt;</code></li> <li>\u4ed3\u50a8\u65b9\u6cd5\u5e94\u8be5\u53cd\u6620\u4e1a\u52a1\u610f\u56fe</li> <li>\u6240\u6709\u64cd\u4f5c\u5fc5\u987b\u662f\u5f02\u6b65\u7684</li> <li>\u901a\u8fc7\u6784\u9020\u51fd\u6570\u53c2\u6570\u8bbf\u95ee <code>ApplicationDbContext</code></li> <li>\u4ed3\u50a8\u4f1a\u88ab\u81ea\u52a8\u6ce8\u518c\u5230 DI \u5bb9\u5668</li> </ul>"},{"location":"development-guide/repository-development/#_6","title":"\u9700\u8981\u5f15\u7528\u54ea\u4e9b\u547d\u540d\u7a7a\u95f4\uff1f","text":"<p>\u4ed3\u50a8\u6587\u4ef6\u4e2d\u7684\u5fc5\u8981\u5f15\u7528\u5df2\u5728GlobalUsings.cs\u4e2d\u5b9a\u4e49\uff1a</p> <ul> <li><code>global using Microsoft.EntityFrameworkCore;</code> - \u7528\u4e8eEF Core\u6269\u5c55\u65b9\u6cd5</li> </ul> <p>\u56e0\u6b64\u5728\u4ed3\u50a8\u6587\u4ef6\u4e2d\u65e0\u9700\u91cd\u590d\u6dfb\u52a0\u8fd9\u4e9busing\u8bed\u53e5\u3002</p>"},{"location":"development-guide/repository-development/#dbcontext","title":"\u5982\u4f55\u8bbf\u95eeDbContext\uff1f","text":"<ul> <li>\u901a\u8fc7\u6784\u9020\u51fd\u6570\u53c2\u6570\u8bbf\u95ee <code>ApplicationDbContext</code></li> <li>\u4f7f\u7528 <code>context.EntitySetName</code> \u8bbf\u95ee\u5177\u4f53\u7684DbSet</li> <li>\u57fa\u7c7b\u6ca1\u6709\u63d0\u4f9b\u516c\u5f00\u7684 <code>DbSet</code> \u6216 <code>Context</code> \u5c5e\u6027</li> </ul>"},{"location":"development-guide/repository-development/#_7","title":"\u5982\u4f55\u7f16\u5199\u57fa\u672c\u4ed3\u50a8\uff1f","text":"<p>\u6587\u4ef6: <code>src/MyProject.Infrastructure/Repositories/UserRepository.cs</code></p> <pre><code>using MyProject.Domain.AggregatesModel.UserAggregate;\n\nnamespace MyProject.Infrastructure.Repositories;\n\n// \u63a5\u53e3\u548c\u5b9e\u73b0\u5b9a\u4e49\u5728\u540c\u4e00\u6587\u4ef6\u4e2d\npublic interface IUserRepository : IRepository&lt;User, UserId&gt;\n{\n    /// &lt;summary&gt;\n    /// \u6839\u636e\u90ae\u7bb1\u83b7\u53d6\u7528\u6237\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"email\"&gt;\u90ae\u7bb1\u5730\u5740&lt;/param&gt;\n    /// &lt;param name=\"cancellationToken\"&gt;\u53d6\u6d88\u4ee4\u724c&lt;/param&gt;\n    /// &lt;returns&gt;\u7528\u6237\u5b9e\u4f53\uff0c\u5982\u679c\u4e0d\u5b58\u5728\u5219\u8fd4\u56denull&lt;/returns&gt;\n    Task&lt;User?&gt; GetByEmailAsync(string email, CancellationToken cancellationToken = default);\n\n    /// &lt;summary&gt;\n    /// \u68c0\u67e5\u90ae\u7bb1\u662f\u5426\u5df2\u5b58\u5728\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"email\"&gt;\u90ae\u7bb1\u5730\u5740&lt;/param&gt;\n    /// &lt;param name=\"cancellationToken\"&gt;\u53d6\u6d88\u4ee4\u724c&lt;/param&gt;\n    /// &lt;returns&gt;\u5982\u679c\u5b58\u5728\u8fd4\u56detrue\uff0c\u5426\u5219\u8fd4\u56defalse&lt;/returns&gt;\n    Task&lt;bool&gt; EmailExistsAsync(string email, CancellationToken cancellationToken = default);\n}\n\npublic class UserRepository(ApplicationDbContext context) \n    : RepositoryBase&lt;User, UserId, ApplicationDbContext&gt;(context), IUserRepository\n{\n    public async Task&lt;User?&gt; GetByEmailAsync(string email, CancellationToken cancellationToken = default)\n    {\n        return await context.Users\n            .FirstOrDefaultAsync(x =&gt; x.Email == email, cancellationToken);\n    }\n\n    public async Task&lt;bool&gt; EmailExistsAsync(string email, CancellationToken cancellationToken = default)\n    {\n        return await context.Users\n            .AnyAsync(x =&gt; x.Email == email, cancellationToken);\n    }\n}\n</code></pre>"},{"location":"development-guide/repository-development/#_8","title":"\u5982\u4f55\u7f16\u5199\u5e26\u6709\u590d\u6742\u67e5\u8be2\u7684\u4ed3\u50a8\uff1f","text":"<p>\u6587\u4ef6: <code>src/MyProject.Infrastructure/Repositories/OrderRepository.cs</code></p> <pre><code>using MyProject.Domain.AggregatesModel.OrderAggregate;\n\nnamespace MyProject.Infrastructure.Repositories;\n\npublic interface IOrderRepository : IRepository&lt;Order, OrderId&gt;\n{\n    /// &lt;summary&gt;\n    /// \u6839\u636e\u5ba2\u6237\u540d\u79f0\u83b7\u53d6\u8ba2\u5355\u5217\u8868\n    /// &lt;/summary&gt;\n    Task&lt;List&lt;Order&gt;&gt; GetByCustomerNameAsync(\n        string customerName, \n        CancellationToken cancellationToken = default);\n\n    /// &lt;summary&gt;\n    /// \u6839\u636e\u72b6\u6001\u83b7\u53d6\u8ba2\u5355\u5217\u8868\n    /// &lt;/summary&gt;\n    Task&lt;List&lt;Order&gt;&gt; GetByStatusAsync(\n        OrderStatus status, \n        CancellationToken cancellationToken = default);\n\n    /// &lt;summary&gt;\n    /// \u83b7\u53d6\u5f85\u652f\u4ed8\u7684\u8d85\u65f6\u8ba2\u5355\n    /// &lt;/summary&gt;\n    Task&lt;List&lt;Order&gt;&gt; GetPendingTimeoutOrdersAsync(\n        DateTimeOffset before, \n        CancellationToken cancellationToken = default);\n}\n\npublic class OrderRepository(ApplicationDbContext context) \n    : RepositoryBase&lt;Order, OrderId, ApplicationDbContext&gt;(context), IOrderRepository\n{\n    public async Task&lt;List&lt;Order&gt;&gt; GetByCustomerNameAsync(\n        string customerName, \n        CancellationToken cancellationToken = default)\n    {\n        return await context.Orders\n            .Include(o =&gt; o.OrderItems)\n            .Where(o =&gt; o.CustomerName == customerName)\n            .ToListAsync(cancellationToken);\n    }\n\n    public async Task&lt;List&lt;Order&gt;&gt; GetByStatusAsync(\n        OrderStatus status, \n        CancellationToken cancellationToken = default)\n    {\n        return await context.Orders\n            .Where(o =&gt; o.OrderStatus == status)\n            .ToListAsync(cancellationToken);\n    }\n\n    public async Task&lt;List&lt;Order&gt;&gt; GetPendingTimeoutOrdersAsync(\n        DateTimeOffset before, \n        CancellationToken cancellationToken = default)\n    {\n        return await context.Orders\n            .Where(o =&gt; o.OrderStatus == OrderStatus.Pending &amp;&amp; o.CreateTime &lt; before)\n            .ToListAsync(cancellationToken);\n    }\n}\n</code></pre>"},{"location":"development-guide/repository-development/#_9","title":"\u5982\u4f55\u7f16\u5199\u5e26\u6709\u5173\u8054\u5b9e\u4f53\u52a0\u8f7d\u7684\u4ed3\u50a8\uff1f","text":"<p>\u6587\u4ef6: <code>src/MyProject.Infrastructure/Repositories/ProductRepository.cs</code></p> <pre><code>using MyProject.Domain.AggregatesModel.ProductAggregate;\n\nnamespace MyProject.Infrastructure.Repositories;\n\npublic interface IProductRepository : IRepository&lt;Product, ProductId&gt;\n{\n    /// &lt;summary&gt;\n    /// \u6839\u636e\u5206\u7c7bID\u83b7\u53d6\u4ea7\u54c1\u5217\u8868\uff08\u5305\u542b\u8bc4\u8bba\uff09\n    /// &lt;/summary&gt;\n    Task&lt;List&lt;Product&gt;&gt; GetByCategoryIdWithReviewsAsync(\n        CategoryId categoryId, \n        CancellationToken cancellationToken = default);\n\n    /// &lt;summary&gt;\n    /// \u68c0\u67e5\u4ea7\u54c1\u7f16\u7801\u662f\u5426\u5b58\u5728\n    /// &lt;/summary&gt;\n    Task&lt;bool&gt; CodeExistsAsync(\n        string code, \n        CancellationToken cancellationToken = default);\n\n    /// &lt;summary&gt;\n    /// \u6279\u91cf\u83b7\u53d6\u4ea7\u54c1\uff08\u7528\u4e8e\u8ba2\u5355\u5904\u7406\uff09\n    /// &lt;/summary&gt;\n    Task&lt;List&lt;Product&gt;&gt; GetByIdsAsync(\n        List&lt;ProductId&gt; productIds, \n        CancellationToken cancellationToken = default);\n}\n\npublic class ProductRepository(ApplicationDbContext context) \n    : RepositoryBase&lt;Product, ProductId, ApplicationDbContext&gt;(context), IProductRepository\n{\n    public async Task&lt;List&lt;Product&gt;&gt; GetByCategoryIdWithReviewsAsync(\n        CategoryId categoryId, \n        CancellationToken cancellationToken = default)\n    {\n        return await context.Products\n            .Include(p =&gt; p.Reviews)\n            .Where(p =&gt; p.CategoryId == categoryId)\n            .ToListAsync(cancellationToken);\n    }\n\n    public async Task&lt;bool&gt; CodeExistsAsync(\n        string code, \n        CancellationToken cancellationToken = default)\n    {\n        return await context.Products\n            .AnyAsync(p =&gt; p.Code == code, cancellationToken);\n    }\n\n    public async Task&lt;List&lt;Product&gt;&gt; GetByIdsAsync(\n        List&lt;ProductId&gt; productIds, \n        CancellationToken cancellationToken = default)\n    {\n        return await context.Products\n            .Where(p =&gt; productIds.Contains(p.Id))\n            .ToListAsync(cancellationToken);\n    }\n}\n</code></pre>"},{"location":"development-guide/repository-development/#_10","title":"\u6846\u67b6\u9ed8\u8ba4\u5b9e\u73b0\u4e86\u54ea\u4e9b\u65b9\u6cd5\uff1f","text":"<p>\u6846\u67b6\u5df2\u7ecf\u5b9e\u73b0\u4e86\u4ee5\u4e0b\u5e38\u7528\u65b9\u6cd5\uff0c\u65e0\u9700\u989d\u5916\u5b9e\u73b0\uff1a</p> <pre><code>public interface IRepository&lt;TEntity, TKey&gt; : IRepository&lt;TEntity&gt;\n    where TEntity : notnull, Entity&lt;TKey&gt;, IAggregateRoot\n    where TKey : notnull\n{\n    // \u83b7\u53d6\u5de5\u4f5c\u5355\u5143\u5bf9\u8c61\n    IUnitOfWork UnitOfWork { get; }\n\n    // \u6dfb\u52a0\u65b9\u6cd5\n    TEntity Add(TEntity entity);\n    Task&lt;TEntity&gt; AddAsync(TEntity entity, CancellationToken cancellationToken = default);\n    void AddRange(IEnumerable&lt;TEntity&gt; entities);\n    Task AddRangeAsync(IEnumerable&lt;TEntity&gt; entities, CancellationToken cancellationToken = default);\n\n    // \u9644\u52a0\u65b9\u6cd5\n    void Attach(TEntity entity);\n    void AttachRange(IEnumerable&lt;TEntity&gt; entities);\n\n    // \u66f4\u65b0\u65b9\u6cd5\n    TEntity Update(TEntity entity);\n    Task&lt;TEntity&gt; UpdateAsync(TEntity entity, CancellationToken cancellationToken = default);\n\n    // \u5220\u9664\u65b9\u6cd5\n    bool Remove(Entity entity);\n    Task&lt;bool&gt; RemoveAsync(Entity entity);\n    int DeleteById(TKey id);\n    Task&lt;int&gt; DeleteByIdAsync(TKey id, CancellationToken cancellationToken = default);\n\n    // \u83b7\u53d6\u65b9\u6cd5\n    TEntity? Get(TKey id);\n    Task&lt;TEntity?&gt; GetAsync(TKey id, CancellationToken cancellationToken = default);\n}\n</code></pre>"},{"location":"development-guide/repository-development/#_11","title":"\u5982\u4f55\u547d\u540d\u4ed3\u50a8\u65b9\u6cd5\uff1f","text":""},{"location":"development-guide/repository-development/#_12","title":"\u4e1a\u52a1\u610f\u56fe\u4f18\u5148","text":"<p>\u4ed3\u50a8\u65b9\u6cd5\u540d\u5e94\u8be5\u53cd\u6620\u4e1a\u52a1\u610f\u56fe\uff0c\u800c\u4e0d\u662f\u6570\u636e\u5e93\u64cd\u4f5c\uff1a</p> <p>\u2705 \u597d\u7684\u547d\u540d: <pre><code>Task&lt;User?&gt; GetByEmailAsync(string email, CancellationToken cancellationToken);\nTask&lt;bool&gt; EmailExistsAsync(string email, CancellationToken cancellationToken);\nTask&lt;List&lt;Order&gt;&gt; GetPendingOrdersAsync(CancellationToken cancellationToken);\nTask&lt;List&lt;Product&gt;&gt; GetPublishedProductsAsync(CancellationToken cancellationToken);\n</code></pre></p> <p>\u274c \u4e0d\u597d\u7684\u547d\u540d: <pre><code>Task&lt;User?&gt; FindByEmail(string email); // \u4e0d\u591f\u660e\u786e\uff0c\u4e0d\u662f\u5f02\u6b65\nTask&lt;bool&gt; CheckEmail(string email); // \u4e0d\u6e05\u695a\u8fd4\u56de\u503c\u542b\u4e49\nTask&lt;List&lt;Order&gt;&gt; Query(Expression&lt;Func&lt;Order, bool&gt;&gt; predicate); // \u8fc7\u4e8e\u901a\u7528\n</code></pre></p>"},{"location":"development-guide/repository-development/#vs","title":"\u67e5\u8be2vs\u5b58\u5728\u6027\u68c0\u67e5\u6709\u4ec0\u4e48\u533a\u522b\uff1f","text":"<pre><code>// \u67e5\u8be2\u65b9\u6cd5 - \u8fd4\u56de\u5b9e\u4f53\u6216\u5b9e\u4f53\u5217\u8868\nTask&lt;User?&gt; GetByEmailAsync(string email, CancellationToken cancellationToken);\nTask&lt;List&lt;Order&gt;&gt; GetByCustomerNameAsync(string customerName, CancellationToken cancellationToken);\n\n// \u5b58\u5728\u6027\u68c0\u67e5 - \u8fd4\u56debool\nTask&lt;bool&gt; EmailExistsAsync(string email, CancellationToken cancellationToken);\nTask&lt;bool&gt; CodeExistsAsync(string code, CancellationToken cancellationToken);\n</code></pre>"},{"location":"development-guide/repository-development/#_13","title":"\u4ec0\u4e48\u573a\u666f\u5e94\u8be5\u4f7f\u7528\u4ed3\u50a8\uff1f","text":""},{"location":"development-guide/repository-development/#_14","title":"\u2705 \u5e94\u8be5\u4f7f\u7528\u4ed3\u50a8\u7684\u573a\u666f","text":"<ol> <li> <p>\u547d\u4ee4\u5904\u7406\u5668\u4e2d\u83b7\u53d6\u805a\u5408\u8fdb\u884c\u4e1a\u52a1\u64cd\u4f5c <pre><code>public async Task Handle(UpdateUserEmailCommand command, CancellationToken cancellationToken)\n{\n    var user = await userRepository.GetAsync(command.UserId, cancellationToken);\n    user.ChangeEmail(command.Email);\n}\n</code></pre></p> </li> <li> <p>\u68c0\u67e5\u4e1a\u52a1\u89c4\u5219 <pre><code>if (await userRepository.EmailExistsAsync(command.Email, cancellationToken))\n{\n    throw new KnownException(\"\u90ae\u7bb1\u5df2\u5b58\u5728\");\n}\n</code></pre></p> </li> <li> <p>\u6279\u91cf\u83b7\u53d6\u805a\u5408\u8fdb\u884c\u4e1a\u52a1\u64cd\u4f5c <pre><code>var products = await productRepository.GetByIdsAsync(productIds, cancellationToken);\nforeach (var product in products)\n{\n    product.DecreaseStock(quantity);\n}\n</code></pre></p> </li> </ol>"},{"location":"development-guide/repository-development/#_15","title":"\u274c \u4e0d\u5e94\u8be5\u4f7f\u7528\u4ed3\u50a8\u7684\u573a\u666f","text":"<ol> <li> <p>\u67e5\u8be2\u5904\u7406\u5668\u4e2d\u7684\u6570\u636e\u8bfb\u53d6 - \u5e94\u8be5\u76f4\u63a5\u4f7f\u7528DbContext <pre><code>// \u274c \u9519\u8bef\npublic class GetUserListQueryHandler(IUserRepository userRepository)\n{\n    public async Task&lt;List&lt;UserDto&gt;&gt; Handle(...)\n    {\n        var users = await userRepository.GetAllAsync(); // \u4e0d\u8981\u8fd9\u6837\n    }\n}\n\n// \u2705 \u6b63\u786e\npublic class GetUserListQueryHandler(ApplicationDbContext context)\n{\n    public async Task&lt;List&lt;UserDto&gt;&gt; Handle(...)\n    {\n        return await context.Users.Select(...).ToListAsync(); // \u76f4\u63a5\u4f7f\u7528DbContext\n    }\n}\n</code></pre></p> </li> <li> <p>\u590d\u6742\u7684\u7edf\u8ba1\u548c\u62a5\u8868\u67e5\u8be2 - \u5e94\u8be5\u76f4\u63a5\u4f7f\u7528DbContext <pre><code>// \u274c \u9519\u8bef - \u5728\u4ed3\u50a8\u4e2d\u5b9a\u4e49\u590d\u6742\u7edf\u8ba1\u65b9\u6cd5\nTask&lt;OrderStatisticsDto&gt; GetOrderStatisticsAsync(...);\n\n// \u2705 \u6b63\u786e - \u5728\u67e5\u8be2\u5904\u7406\u5668\u4e2d\u76f4\u63a5\u67e5\u8be2\npublic class GetOrderStatisticsQueryHandler(ApplicationDbContext context)\n{\n    // \u76f4\u63a5\u4f7f\u7528DbContext\u8fdb\u884c\u590d\u6742\u67e5\u8be2\n}\n</code></pre></p> </li> </ol>"},{"location":"development-guide/repository-development/#_16","title":"\u9047\u5230\u5e38\u89c1\u9519\u8bef\u600e\u4e48\u529e\uff1f","text":""},{"location":"development-guide/repository-development/#_17","title":"\u4e3a\u4ec0\u4e48\u51fa\u73b0\u4f9d\u8d56\u6ce8\u5165\u9519\u8bef\uff1f","text":"<p>\u9519\u8bef: <code>\u672a\u80fd\u627e\u5230\u7c7b\u578b\u6216\u547d\u540d\u7a7a\u95f4\u540d\"IUserRepository\"</code></p> <p>\u539f\u56e0: \u5728\u5176\u4ed6\u5c42\uff08\u5982Domain\u5c42\uff09\u8bd5\u56fe\u4f7f\u7528\u4ed3\u50a8\u63a5\u53e3</p> <p>\u89e3\u51b3:  - \u786e\u4fdd\u4ed3\u50a8\u63a5\u53e3\u5b9a\u4e49\u5728 Infrastructure \u5c42 - \u5728\u4f7f\u7528\u4ed3\u50a8\u7684\u5730\u65b9\u6dfb\u52a0 <code>using {ProjectName}.Infrastructure.Repositories;</code></p>"},{"location":"development-guide/repository-development/#_18","title":"\u4e3a\u4ec0\u4e48\u4ed3\u50a8\u6ca1\u6709\u81ea\u52a8\u6ce8\u518c\uff1f","text":"<p>\u9519\u8bef: \u4ed3\u50a8\u672a\u6ce8\u518c\u5230 DI \u5bb9\u5668</p> <p>\u539f\u56e0: \u671f\u671b\u624b\u52a8\u6ce8\u518c\u4ed3\u50a8</p> <p>\u89e3\u51b3:  - Infrastructure \u5c42\u7684 <code>AddRepositories()</code> \u5df2\u81ea\u52a8\u6ce8\u518c\u6240\u6709\u4ed3\u50a8 - \u65e0\u9700\u5728 Program.cs \u4e2d\u624b\u52a8\u6ce8\u518c\u4ed3\u50a8</p>"},{"location":"development-guide/repository-development/#_19","title":"\u4e3a\u4ec0\u4e48\u51fa\u73b0\u4e3b\u6784\u9020\u51fd\u6570\u8b66\u544a\uff1f","text":"<p>\u8b66\u544a: <code>\u53c2\u6570\"ApplicationDbContext context\"\u6355\u83b7\u5230\u5c01\u95ed\u7c7b\u578b\u72b6\u6001\uff0c\u5176\u503c\u4e5f\u4f20\u9012\u7ed9\u57fa\u6784\u9020\u51fd\u6570</code></p> <p>\u539f\u56e0: \u4f7f\u7528\u4e3b\u6784\u9020\u51fd\u6570\u65f6\u7f16\u8bd1\u5668\u7684\u4fdd\u5b88\u8b66\u544a</p> <p>\u89e3\u51b3: \u8fd9\u662f\u6b63\u5e38\u7684\u8b66\u544a\uff0c\u4e0d\u5f71\u54cd\u529f\u80fd\uff0c\u53ef\u4ee5\u5ffd\u7565\u3002\u5982\u9700\u6d88\u9664\u8b66\u544a\uff0c\u53ef\u4f7f\u7528\u4f20\u7edf\u6784\u9020\u51fd\u6570\uff1a</p> <pre><code>// \u4f1a\u4ea7\u751f\u8b66\u544a\u4f46\u529f\u80fd\u6b63\u5e38\u7684\u5199\u6cd5\npublic class UserRepository(ApplicationDbContext context) \n    : RepositoryBase&lt;User, UserId, ApplicationDbContext&gt;(context), IUserRepository\n{\n    // \u5b9e\u73b0\n}\n\n// \u4e0d\u4ea7\u751f\u8b66\u544a\u7684\u4f20\u7edf\u5199\u6cd5\npublic class UserRepository \n    : RepositoryBase&lt;User, UserId, ApplicationDbContext&gt;, IUserRepository\n{\n    public UserRepository(ApplicationDbContext context) : base(context)\n    {\n    }\n    // \u5b9e\u73b0\n}\n</code></pre>"},{"location":"development-guide/repository-development/#_20","title":"\u4ed3\u50a8\u5f00\u53d1\u6709\u54ea\u4e9b\u6700\u4f73\u5b9e\u8df5\uff1f","text":"<ol> <li>\u5355\u4e00\u804c\u8d23: \u6bcf\u4e2a\u4ed3\u50a8\u53ea\u8d1f\u8d23\u4e00\u4e2a\u805a\u5408\u6839</li> <li>\u4e1a\u52a1\u8bed\u8a00: \u4f7f\u7528\u4e1a\u52a1\u9886\u57df\u7684\u8bed\u8a00\u547d\u540d\u65b9\u6cd5</li> <li>\u5f02\u6b65\u4f18\u5148: \u6240\u6709\u6570\u636e\u5e93\u64cd\u4f5c\u90fd\u5e94\u8be5\u662f\u5f02\u6b65\u7684</li> <li>\u804c\u8d23\u5206\u79bb: \u4ed3\u50a8\u7528\u4e8e\u547d\u4ee4\uff0c\u67e5\u8be2\u5904\u7406\u5668\u76f4\u63a5\u7528DbContext</li> <li>\u6700\u5c0f\u5316\u65b9\u6cd5: \u53ea\u5b9a\u4e49\u771f\u6b63\u9700\u8981\u7684\u65b9\u6cd5\uff0c\u5229\u7528\u57fa\u7c7b\u63d0\u4f9b\u7684\u9ed8\u8ba4\u65b9\u6cd5</li> <li>\u5305\u542b\u5173\u8054: \u9700\u8981\u5173\u8054\u5b9e\u4f53\u65f6\u4f7f\u7528Include\u663e\u5f0f\u52a0\u8f7d</li> </ol>"},{"location":"development-guide/repository-development/#_21","title":"\u5728\u54ea\u91cc\u53ef\u4ee5\u627e\u5230\u76f8\u5173\u6587\u6863\uff1f","text":"<ul> <li>\u805a\u5408\u5f00\u53d1\u6307\u5357</li> <li>\u547d\u4ee4\u5f00\u53d1\u6307\u5357</li> <li>\u67e5\u8be2\u5f00\u53d1\u6307\u5357</li> <li>\u5b9e\u4f53\u914d\u7f6e\u6307\u5357</li> </ul>"},{"location":"getting-started/quick-start/","title":"\u5feb\u901f\u5f00\u59cb","text":"<p>\u672c\u6307\u5357\u5c06\u5e2e\u52a9\u4f60\u5feb\u901f\u5f00\u59cb\u4f7f\u7528NetCorePal\u63d0\u4f9b\u7684\u6846\u67b6\u6784\u5efa\u57fa\u4e8eDDD\u548cClean Architecture\u7684\u5e94\u7528\u7a0b\u5e8f\u3002</p>"},{"location":"getting-started/quick-start/#_2","title":"\u9009\u62e9\u6846\u67b6","text":"<p>\u6211\u4eec\u63d0\u4f9b\u4e86\u4e24\u4e2a\u4e3b\u6d41\u5e73\u53f0\u7684\u6846\u67b6\uff1a</p>"},{"location":"getting-started/quick-start/#net-netcorepal-cloud-framework","title":".NET \u5e73\u53f0 - NetCorePal Cloud Framework","text":"<p>\u9002\u7528\u4e8eC#/.NET\u5f00\u53d1\u8005</p> <ul> <li>GitHub: netcorepal-cloud-framework</li> <li>\u57fa\u4e8e.NET 8+</li> <li>\u652f\u6301\u5fae\u670d\u52a1\u67b6\u6784</li> <li>\u96c6\u6210\u9886\u57df\u4e8b\u4ef6\u3001CQRS\u7b49\u6a21\u5f0f</li> </ul>"},{"location":"getting-started/quick-start/#java-cap4j","title":"Java \u5e73\u53f0 - CAP4J","text":"<p>\u9002\u7528\u4e8eJava\u5f00\u53d1\u8005</p> <ul> <li>GitHub: cap4j</li> <li>\u57fa\u4e8eSpring Boot</li> <li>\u5b8c\u6574\u7684DDD\u6218\u672f\u6a21\u5f0f\u652f\u6301</li> <li>\u7075\u6d3b\u7684\u67b6\u6784\u8bbe\u8ba1</li> </ul>"},{"location":"getting-started/quick-start/#netcorepal-cloud-framework-net","title":"\u4f7f\u7528 NetCorePal Cloud Framework (.NET)","text":""},{"location":"getting-started/quick-start/#1","title":"1. \u73af\u5883\u51c6\u5907","text":"<p>\u786e\u4fdd\u5df2\u5b89\u88c5\u4ee5\u4e0b\u5de5\u5177\uff1a</p> <ul> <li>.NET 8 SDK \u6216\u66f4\u9ad8\u7248\u672c</li> <li>IDE: Visual Studio 2022 \u6216 JetBrains Rider</li> <li>Docker (\u53ef\u9009\uff0c\u7528\u4e8e\u672c\u5730\u5f00\u53d1\u73af\u5883)</li> </ul>"},{"location":"getting-started/quick-start/#2","title":"2. \u521b\u5efa\u9879\u76ee","text":"<pre><code># \u5b89\u88c5\u9879\u76ee\u6a21\u677f\ndotnet new install NetCorePal.Template\n\n# \u521b\u5efa\u65b0\u9879\u76ee\ndotnet new netcorepal-webapi -n MyProject\ncd MyProject\n</code></pre>"},{"location":"getting-started/quick-start/#3","title":"3. \u9879\u76ee\u7ed3\u6784","text":"<pre><code>MyProject/\n\u251c\u2500\u2500 src/\n\u2502   \u251c\u2500\u2500 MyProject.Domain/          # \u9886\u57df\u5c42\n\u2502   \u2502   \u251c\u2500\u2500 Aggregates/            # \u805a\u5408\u6839\n\u2502   \u2502   \u251c\u2500\u2500 DomainEvents/          # \u9886\u57df\u4e8b\u4ef6\n\u2502   \u2502   \u2514\u2500\u2500 DomainServices/        # \u9886\u57df\u670d\u52a1\n\u2502   \u251c\u2500\u2500 MyProject.Application/     # \u5e94\u7528\u5c42\n\u2502   \u2502   \u251c\u2500\u2500 Commands/              # \u547d\u4ee4\n\u2502   \u2502   \u251c\u2500\u2500 Queries/               # \u67e5\u8be2\n\u2502   \u2502   \u2514\u2500\u2500 IntegrationEvents/     # \u96c6\u6210\u4e8b\u4ef6\n\u2502   \u251c\u2500\u2500 MyProject.Infrastructure/  # \u57fa\u7840\u8bbe\u65bd\u5c42\n\u2502   \u2502   \u251c\u2500\u2500 Repositories/          # \u4ed3\u50a8\u5b9e\u73b0\n\u2502   \u2502   \u2514\u2500\u2500 EntityConfigurations/  # \u5b9e\u4f53\u914d\u7f6e\n\u2502   \u2514\u2500\u2500 MyProject.Api/             # API\u5c42\n\u2502       \u2514\u2500\u2500 Controllers/           # \u63a7\u5236\u5668\n\u2514\u2500\u2500 tests/\n    \u251c\u2500\u2500 MyProject.Domain.Tests/\n    \u2514\u2500\u2500 MyProject.Application.Tests/\n</code></pre>"},{"location":"getting-started/quick-start/#4","title":"4. \u5b9a\u4e49\u9886\u57df\u6a21\u578b","text":"<pre><code>// Domain/Aggregates/Order.cs\npublic class Order : AggregateRoot&lt;OrderId&gt;\n{\n    public OrderNumber OrderNumber { get; private set; }\n    public OrderStatus Status { get; private set; }\n\n    private readonly List&lt;OrderItem&gt; _items = new();\n    public IReadOnlyCollection&lt;OrderItem&gt; Items =&gt; _items.AsReadOnly();\n\n    public void AddItem(ProductId productId, int quantity, decimal price)\n    {\n        var item = new OrderItem(productId, quantity, price);\n        _items.Add(item);\n\n        // \u53d1\u5e03\u9886\u57df\u4e8b\u4ef6\n        RaiseDomainEvent(new OrderItemAddedEvent(Id, productId, quantity));\n    }\n\n    public void Submit()\n    {\n        if (Status != OrderStatus.Draft)\n            throw new DomainException(\"Only draft orders can be submitted\");\n\n        Status = OrderStatus.Submitted;\n        RaiseDomainEvent(new OrderSubmittedEvent(Id));\n    }\n}\n</code></pre>"},{"location":"getting-started/quick-start/#5","title":"5. \u521b\u5efa\u5e94\u7528\u670d\u52a1","text":"<pre><code>// Application/Commands/SubmitOrderCommand.cs\npublic record SubmitOrderCommand(OrderId OrderId) : ICommand&lt;Result&gt;;\n\n// Application/Commands/SubmitOrderCommandHandler.cs\npublic class SubmitOrderCommandHandler : ICommandHandler&lt;SubmitOrderCommand, Result&gt;\n{\n    private readonly IOrderRepository _repository;\n    private readonly IUnitOfWork _unitOfWork;\n\n    public async Task&lt;Result&gt; Handle(SubmitOrderCommand command, CancellationToken ct)\n    {\n        var order = await _repository.GetByIdAsync(command.OrderId, ct);\n\n        order.Submit();\n\n        await _unitOfWork.SaveChangesAsync(ct);\n\n        return Result.Success();\n    }\n}\n</code></pre>"},{"location":"getting-started/quick-start/#6-api","title":"6. \u521b\u5efaAPI\u7aef\u70b9","text":"<pre><code>// Api/Controllers/OrdersController.cs\n[ApiController]\n[Route(\"api/orders\")]\npublic class OrdersController : ControllerBase\n{\n    private readonly IMediator _mediator;\n\n    [HttpPost(\"{id}/submit\")]\n    public async Task&lt;IActionResult&gt; Submit(Guid id)\n    {\n        var result = await _mediator.Send(new SubmitOrderCommand(new OrderId(id)));\n        return result.IsSuccess ? Ok() : BadRequest(result.Error);\n    }\n}\n</code></pre>"},{"location":"getting-started/quick-start/#7","title":"7. \u8fd0\u884c\u5e94\u7528","text":"<pre><code># \u6062\u590d\u4f9d\u8d56\ndotnet restore\n\n# \u8fd0\u884c\u6570\u636e\u5e93\u8fc1\u79fb\ndotnet ef database update -p src/MyProject.Infrastructure -s src/MyProject.Api\n\n# \u542f\u52a8\u5e94\u7528\ndotnet run --project src/MyProject.Api\n</code></pre> <p>\u8bbf\u95ee <code>https://localhost:5001/swagger</code> \u67e5\u770bAPI\u6587\u6863\u3002</p>"},{"location":"getting-started/quick-start/#cap4j-java","title":"\u4f7f\u7528 CAP4J (Java)","text":""},{"location":"getting-started/quick-start/#1_1","title":"1. \u73af\u5883\u51c6\u5907","text":"<ul> <li>JDK 17 \u6216\u66f4\u9ad8\u7248\u672c</li> <li>Maven 3.6+ \u6216 Gradle 7+</li> <li>IDE: IntelliJ IDEA</li> </ul>"},{"location":"getting-started/quick-start/#2_1","title":"2. \u521b\u5efa\u9879\u76ee","text":"<pre><code># \u514b\u9686\u6a21\u677f\u9879\u76ee\ngit clone https://github.com/netcorepal/cap4j-template.git my-project\ncd my-project\n</code></pre>"},{"location":"getting-started/quick-start/#3_1","title":"3. \u9879\u76ee\u7ed3\u6784","text":"<pre><code>my-project/\n\u251c\u2500\u2500 domain/                  # \u9886\u57df\u5c42\n\u2502   \u251c\u2500\u2500 model/              # \u9886\u57df\u6a21\u578b\n\u2502   \u2514\u2500\u2500 event/              # \u9886\u57df\u4e8b\u4ef6\n\u251c\u2500\u2500 application/            # \u5e94\u7528\u5c42\n\u2502   \u251c\u2500\u2500 command/            # \u547d\u4ee4\n\u2502   \u2514\u2500\u2500 query/              # \u67e5\u8be2\n\u251c\u2500\u2500 infrastructure/         # \u57fa\u7840\u8bbe\u65bd\u5c42\n\u2502   \u2514\u2500\u2500 repository/         # \u4ed3\u50a8\u5b9e\u73b0\n\u2514\u2500\u2500 adapter/                # \u9002\u914d\u5668\u5c42\n    \u2514\u2500\u2500 rest/               # REST API\n</code></pre>"},{"location":"getting-started/quick-start/#4_1","title":"4. \u5b9a\u4e49\u9886\u57df\u6a21\u578b","text":"<pre><code>// domain/model/Order.java\n@Getter\npublic class Order extends AggregateRoot&lt;OrderId&gt; {\n    private OrderNumber orderNumber;\n    private OrderStatus status;\n    private List&lt;OrderItem&gt; items = new ArrayList&lt;&gt;();\n\n    public void addItem(ProductId productId, int quantity, BigDecimal price) {\n        var item = new OrderItem(productId, quantity, price);\n        items.add(item);\n\n        registerEvent(new OrderItemAddedEvent(getId(), productId, quantity));\n    }\n\n    public void submit() {\n        if (status != OrderStatus.DRAFT) {\n            throw new DomainException(\"Only draft orders can be submitted\");\n        }\n\n        status = OrderStatus.SUBMITTED;\n        registerEvent(new OrderSubmittedEvent(getId()));\n    }\n}\n</code></pre>"},{"location":"getting-started/quick-start/#5_1","title":"5. \u521b\u5efa\u5e94\u7528\u670d\u52a1","text":"<pre><code>// application/command/SubmitOrderCommand.java\n@Data\npublic class SubmitOrderCommand {\n    private OrderId orderId;\n}\n\n// application/command/SubmitOrderCommandHandler.java\n@Service\npublic class SubmitOrderCommandHandler {\n    private final OrderRepository repository;\n\n    @Transactional\n    public void handle(SubmitOrderCommand command) {\n        Order order = repository.findById(command.getOrderId())\n            .orElseThrow(() -&gt; new OrderNotFoundException());\n\n        order.submit();\n        repository.save(order);\n    }\n}\n</code></pre>"},{"location":"getting-started/quick-start/#6","title":"6. \u8fd0\u884c\u5e94\u7528","text":"<pre><code># \u7f16\u8bd1\u9879\u76ee\nmvn clean package\n\n# \u8fd0\u884c\u5e94\u7528\njava -jar target/my-project.jar\n</code></pre>"},{"location":"getting-started/quick-start/#_3","title":"\u4e0b\u4e00\u6b65\u5b66\u4e60","text":""},{"location":"getting-started/quick-start/#_4","title":"\u6df1\u5165\u6838\u5fc3\u6982\u5ff5","text":"<ul> <li>\u9886\u57df\u6a21\u578b</li> <li>\u805a\u5408\u6839</li> <li>\u9886\u57df\u4e8b\u4ef6</li> <li>\u4ed3\u50a8\u6a21\u5f0f</li> </ul>"},{"location":"getting-started/quick-start/#_5","title":"\u5b66\u4e60\u67b6\u6784\u8bbe\u8ba1","text":"<ul> <li>\u6574\u6d01\u67b6\u6784\u8be6\u89e3</li> <li>CQRS\u6a21\u5f0f</li> <li>\u4e8b\u4ef6\u9a71\u52a8\u67b6\u6784</li> </ul>"},{"location":"getting-started/quick-start/#_6","title":"\u67e5\u770b\u6700\u4f73\u5b9e\u8df5","text":"<ul> <li>\u9879\u76ee\u7ed3\u6784</li> <li>\u547d\u540d\u89c4\u8303</li> <li>\u6d4b\u8bd5\u7b56\u7565</li> </ul>"},{"location":"getting-started/quick-start/#_7","title":"\u83b7\u53d6\u5e2e\u52a9","text":"<p>\u9047\u5230\u95ee\u9898\uff1f</p> <ul> <li>\u67e5\u770b\u6846\u67b6\u6587\u6863: .NET | Java</li> <li>\u5728GitHub\u4e0a\u63d0Issue</li> <li>\u52a0\u5165\u6211\u4eec\u7684\u793e\u533a\u8ba8\u8bba</li> </ul>"},{"location":"getting-started/quick-start/#_8","title":"\u793a\u4f8b\u9879\u76ee","text":"<p>\u6211\u4eec\u63d0\u4f9b\u4e86\u5b8c\u6574\u7684\u793a\u4f8b\u9879\u76ee\u4f9b\u53c2\u8003\uff1a</p> <ul> <li>.NET\u793a\u4f8b</li> <li>Java\u793a\u4f8b</li> </ul> <p>\u795d\u4f60\u6784\u5efa\u6210\u529f\uff01\ud83d\ude80</p>"},{"location":"getting-started/what-is-clean-architecture/","title":"\u4ec0\u4e48\u662f\u6574\u6d01\u67b6\u6784 (Clean Architecture)","text":""},{"location":"getting-started/what-is-clean-architecture/#_1","title":"\u7b80\u4ecb","text":"<p>\u6574\u6d01\u67b6\u6784(Clean Architecture)\u662f\u7531Robert C. Martin (Uncle Bob)\u63d0\u51fa\u7684\u4e00\u79cd\u8f6f\u4ef6\u67b6\u6784\u6a21\u5f0f\u3002\u5b83\u5f3a\u8c03\u5c06\u4e1a\u52a1\u903b\u8f91\u4e0e\u6280\u672f\u5b9e\u73b0\u7ec6\u8282\u5206\u79bb\uff0c\u4f7f\u7cfb\u7edf\u66f4\u6613\u4e8e\u7406\u89e3\u3001\u5f00\u53d1\u3001\u6d4b\u8bd5\u548c\u7ef4\u62a4\u3002</p>"},{"location":"getting-started/what-is-clean-architecture/#_2","title":"\u6838\u5fc3\u539f\u5219","text":""},{"location":"getting-started/what-is-clean-architecture/#1-dependency-rule","title":"1. \u4f9d\u8d56\u89c4\u5219 (Dependency Rule)","text":"<p>\u4f9d\u8d56\u53ea\u80fd\u7531\u5916\u5411\u5185\u6307\u5411\uff0c\u5185\u5c42\u4e0d\u80fd\u4f9d\u8d56\u5916\u5c42\u3002\u8fd9\u662f\u6574\u6d01\u67b6\u6784\u6700\u6838\u5fc3\u7684\u89c4\u5219\uff1a</p> <pre><code>\u5916\u5c42\uff08\u6846\u67b6\u3001\u6570\u636e\u5e93\u3001UI\uff09\n    \u2193\n\u4e2d\u95f4\u5c42\uff08\u63a5\u53e3\u9002\u914d\u5668\u3001\u7528\u4f8b\uff09\n    \u2193\n\u5185\u5c42\uff08\u5b9e\u4f53\u3001\u9886\u57df\u6a21\u578b\uff09\n</code></pre>"},{"location":"getting-started/what-is-clean-architecture/#2","title":"2. \u72ec\u7acb\u6027\u539f\u5219","text":"<p>\u7cfb\u7edf\u5e94\u8be5\u72ec\u7acb\u4e8e\uff1a</p> <ul> <li>\u6846\u67b6: \u6846\u67b6\u4f5c\u4e3a\u5de5\u5177\uff0c\u800c\u975e\u7ea6\u675f</li> <li>\u6570\u636e\u5e93: \u4e1a\u52a1\u903b\u8f91\u4e0d\u5173\u5fc3\u6570\u636e\u5b58\u50a8\u65b9\u5f0f</li> <li>UI: \u754c\u9762\u53ef\u4ee5\u8f7b\u677e\u66f4\u6362</li> <li>\u5916\u90e8\u7cfb\u7edf: \u4e1a\u52a1\u89c4\u5219\u4e0d\u4f9d\u8d56\u5916\u90e8\u670d\u52a1</li> <li>\u6d4b\u8bd5: \u4e1a\u52a1\u903b\u8f91\u53ef\u4ee5\u72ec\u7acb\u6d4b\u8bd5</li> </ul>"},{"location":"getting-started/what-is-clean-architecture/#_3","title":"\u67b6\u6784\u5c42\u6b21","text":"<p>\u6574\u6d01\u67b6\u6784\u901a\u5e38\u5305\u542b\u4ee5\u4e0b\u51e0\u5c42\uff1a</p>"},{"location":"getting-started/what-is-clean-architecture/#1-entities","title":"1. \u5b9e\u4f53\u5c42 (Entities)","text":"<ul> <li>\u6700\u5185\u5c42\uff0c\u5305\u542b\u4f01\u4e1a\u7ea7\u4e1a\u52a1\u89c4\u5219</li> <li>\u5c01\u88c5\u6700\u901a\u7528\u548c\u9ad8\u5c42\u7684\u4e1a\u52a1\u89c4\u5219</li> <li>\u6700\u7a33\u5b9a\uff0c\u53d8\u5316\u6700\u5c11</li> </ul> <pre><code>// \u793a\u4f8b\uff1a\u5b9e\u4f53\npublic class Order\n{\n    public Guid Id { get; private set; }\n    public DateTime CreatedAt { get; private set; }\n    public OrderStatus Status { get; private set; }\n\n    public void Submit()\n    {\n        if (Status != OrderStatus.Draft)\n            throw new InvalidOperationException(\"Only draft orders can be submitted\");\n\n        Status = OrderStatus.Submitted;\n    }\n}\n</code></pre>"},{"location":"getting-started/what-is-clean-architecture/#2-use-cases","title":"2. \u7528\u4f8b\u5c42 (Use Cases)","text":"<ul> <li>\u5305\u542b\u5e94\u7528\u7279\u5b9a\u7684\u4e1a\u52a1\u89c4\u5219</li> <li>\u534f\u8c03\u5b9e\u4f53\u4e4b\u95f4\u7684\u4ea4\u4e92</li> <li>\u5b9a\u4e49\u8f93\u5165\u8f93\u51fa\u63a5\u53e3</li> </ul> <pre><code>// \u793a\u4f8b\uff1a\u7528\u4f8b\npublic class SubmitOrderUseCase\n{\n    private readonly IOrderRepository _repository;\n\n    public async Task&lt;OrderDto&gt; Execute(SubmitOrderCommand command)\n    {\n        var order = await _repository.GetById(command.OrderId);\n        order.Submit();\n        await _repository.Save(order);\n        return OrderDto.From(order);\n    }\n}\n</code></pre>"},{"location":"getting-started/what-is-clean-architecture/#3-interface-adapters","title":"3. \u63a5\u53e3\u9002\u914d\u5668\u5c42 (Interface Adapters)","text":"<ul> <li>\u5c06\u7528\u4f8b\u548c\u5b9e\u4f53\u7684\u6570\u636e\u8f6c\u6362\u4e3a\u5916\u90e8\u7cfb\u7edf\u9700\u8981\u7684\u683c\u5f0f</li> <li>\u5305\u542b\u63a7\u5236\u5668\u3001\u5c55\u793a\u5668\u3001\u7f51\u5173\u7b49</li> <li>\u5904\u7406\u6570\u636e\u683c\u5f0f\u8f6c\u6362</li> </ul> <pre><code>// \u793a\u4f8b\uff1a\u63a7\u5236\u5668\n[ApiController]\n[Route(\"api/orders\")]\npublic class OrdersController : ControllerBase\n{\n    private readonly SubmitOrderUseCase _useCase;\n\n    [HttpPost(\"{id}/submit\")]\n    public async Task&lt;IActionResult&gt; Submit(Guid id)\n    {\n        var result = await _useCase.Execute(new SubmitOrderCommand { OrderId = id });\n        return Ok(result);\n    }\n}\n</code></pre>"},{"location":"getting-started/what-is-clean-architecture/#4-frameworks-and-drivers","title":"4. \u6846\u67b6\u548c\u9a71\u52a8\u5c42 (Frameworks and Drivers)","text":"<ul> <li>\u6700\u5916\u5c42\uff0c\u5305\u542b\u6846\u67b6\u548c\u5de5\u5177</li> <li>\u6570\u636e\u5e93\u3001Web\u6846\u67b6\u3001\u8bbe\u5907\u7b49</li> <li>\u53d8\u5316\u6700\u9891\u7e41\u7684\u5c42</li> </ul>"},{"location":"getting-started/what-is-clean-architecture/#ddd","title":"\u4e0eDDD\u7684\u5173\u7cfb","text":"<p>\u6574\u6d01\u67b6\u6784\u548cDDD\u53ef\u4ee5\u5b8c\u7f8e\u7ed3\u5408\uff1a</p> \u6574\u6d01\u67b6\u6784\u5c42\u6b21 DDD\u6982\u5ff5 \u5b9e\u4f53\u5c42 \u9886\u57df\u6a21\u578b\uff08\u5b9e\u4f53\u3001\u503c\u5bf9\u8c61\u3001\u805a\u5408\uff09 \u7528\u4f8b\u5c42 \u5e94\u7528\u670d\u52a1\u3001\u9886\u57df\u670d\u52a1 \u63a5\u53e3\u9002\u914d\u5668\u5c42 \u4ed3\u50a8\u5b9e\u73b0\u3001API\u63a7\u5236\u5668 \u6846\u67b6\u5c42 \u57fa\u7840\u8bbe\u65bd\u3001\u6570\u636e\u5e93\u3001Web\u6846\u67b6"},{"location":"getting-started/what-is-clean-architecture/#_4","title":"\u5173\u952e\u6a21\u5f0f","text":""},{"location":"getting-started/what-is-clean-architecture/#dependency-inversion","title":"\u4f9d\u8d56\u5012\u7f6e (Dependency Inversion)","text":"<p>\u901a\u8fc7\u63a5\u53e3\u548c\u62bd\u8c61\uff0c\u5185\u5c42\u5b9a\u4e49\u63a5\u53e3\uff0c\u5916\u5c42\u5b9e\u73b0\u63a5\u53e3\uff1a</p> <pre><code>// \u5185\u5c42\u5b9a\u4e49\u63a5\u53e3\npublic interface IOrderRepository\n{\n    Task&lt;Order&gt; GetById(Guid id);\n    Task Save(Order order);\n}\n\n// \u5916\u5c42\u5b9e\u73b0\u63a5\u53e3\npublic class SqlOrderRepository : IOrderRepository\n{\n    public async Task&lt;Order&gt; GetById(Guid id)\n    {\n        // \u6570\u636e\u5e93\u5b9e\u73b0\n    }\n}\n</code></pre>"},{"location":"getting-started/what-is-clean-architecture/#ports-and-adapters","title":"\u7aef\u53e3\u548c\u9002\u914d\u5668 (Ports and Adapters)","text":"<ul> <li>\u7aef\u53e3: \u5185\u5c42\u5b9a\u4e49\u7684\u63a5\u53e3</li> <li>\u9002\u914d\u5668: \u5916\u5c42\u5bf9\u63a5\u53e3\u7684\u5b9e\u73b0</li> </ul>"},{"location":"getting-started/what-is-clean-architecture/#_5","title":"\u6d4b\u8bd5\u7b56\u7565","text":"<p>\u6574\u6d01\u67b6\u6784\u4f7f\u6d4b\u8bd5\u53d8\u5f97\u5bb9\u6613\uff1a</p> <pre><code>[Test]\npublic async Task SubmitOrder_ShouldChangeStatus()\n{\n    // Arrange\n    var mockRepo = new Mock&lt;IOrderRepository&gt;();\n    var order = new Order();\n    mockRepo.Setup(r =&gt; r.GetById(It.IsAny&lt;Guid&gt;()))\n            .ReturnsAsync(order);\n\n    var useCase = new SubmitOrderUseCase(mockRepo.Object);\n\n    // Act\n    await useCase.Execute(new SubmitOrderCommand { OrderId = order.Id });\n\n    // Assert\n    Assert.Equal(OrderStatus.Submitted, order.Status);\n}\n</code></pre>"},{"location":"getting-started/what-is-clean-architecture/#_6","title":"\u4f18\u52bf","text":""},{"location":"getting-started/what-is-clean-architecture/#1","title":"1. \u53ef\u6d4b\u8bd5\u6027","text":"<p>\u4e1a\u52a1\u903b\u8f91\u72ec\u7acb\u4e8e\u6280\u672f\u7ec6\u8282\uff0c\u53ef\u4ee5\u8f7b\u677e\u8fdb\u884c\u5355\u5143\u6d4b\u8bd5\u3002</p>"},{"location":"getting-started/what-is-clean-architecture/#2_1","title":"2. \u53ef\u7ef4\u62a4\u6027","text":"<p>\u6e05\u6670\u7684\u5c42\u6b21\u7ed3\u6784\u548c\u4f9d\u8d56\u89c4\u5219\uff0c\u4f7f\u4ee3\u7801\u6613\u4e8e\u7406\u89e3\u548c\u4fee\u6539\u3002</p>"},{"location":"getting-started/what-is-clean-architecture/#3","title":"3. \u7075\u6d3b\u6027","text":"<p>\u53ef\u4ee5\u8f7b\u677e\u66ff\u6362\u6280\u672f\u6808\uff0c\u5982\u6570\u636e\u5e93\u3001Web\u6846\u67b6\u7b49\u3002</p>"},{"location":"getting-started/what-is-clean-architecture/#4","title":"4. \u72ec\u7acb\u5f00\u53d1","text":"<p>\u5404\u5c42\u53ef\u4ee5\u76f8\u5bf9\u72ec\u7acb\u5f00\u53d1\uff0c\u63d0\u9ad8\u56e2\u961f\u534f\u4f5c\u6548\u7387\u3002</p>"},{"location":"getting-started/what-is-clean-architecture/#5","title":"5. \u4e1a\u52a1\u4e3a\u4e2d\u5fc3","text":"<p>\u4e1a\u52a1\u903b\u8f91\u662f\u7cfb\u7edf\u7684\u6838\u5fc3\uff0c\u4e0d\u53d7\u6280\u672f\u7ec6\u8282\u5f71\u54cd\u3002</p>"},{"location":"getting-started/what-is-clean-architecture/#_7","title":"\u5b9e\u65bd\u6b65\u9aa4","text":"<ol> <li>\u8bc6\u522b\u4e1a\u52a1\u89c4\u5219: \u786e\u5b9a\u6838\u5fc3\u4e1a\u52a1\u903b\u8f91</li> <li>\u8bbe\u8ba1\u7528\u4f8b: \u5b9a\u4e49\u5e94\u7528\u573a\u666f\u548c\u4ea4\u4e92\u6d41\u7a0b</li> <li>\u5b9a\u4e49\u63a5\u53e3: \u5728\u5185\u5c42\u5b9a\u4e49\u9700\u8981\u7684\u63a5\u53e3</li> <li>\u5b9e\u73b0\u9002\u914d\u5668: \u5728\u5916\u5c42\u5b9e\u73b0\u63a5\u53e3</li> <li>\u914d\u7f6e\u4f9d\u8d56\u6ce8\u5165: \u8fde\u63a5\u5404\u5c42\u7ec4\u4ef6</li> </ol>"},{"location":"getting-started/what-is-clean-architecture/#_8","title":"\u5e38\u89c1\u8bef\u533a","text":""},{"location":"getting-started/what-is-clean-architecture/#_9","title":"\u274c \u8fc7\u5ea6\u8bbe\u8ba1","text":"<p>\u4e0d\u662f\u6240\u6709\u9879\u76ee\u90fd\u9700\u8981\u5b8c\u6574\u7684\u6574\u6d01\u67b6\u6784\uff0c\u8981\u6839\u636e\u590d\u6742\u5ea6\u9009\u62e9\u3002</p>"},{"location":"getting-started/what-is-clean-architecture/#_10","title":"\u274c \u5c42\u6b21\u6df7\u6dc6","text":"<p>\u4e25\u683c\u9075\u5b88\u4f9d\u8d56\u89c4\u5219\uff0c\u4e0d\u8981\u8ba9\u5916\u5c42\u7684\u6982\u5ff5\u6cc4\u6f0f\u5230\u5185\u5c42\u3002</p>"},{"location":"getting-started/what-is-clean-architecture/#_11","title":"\u274c \u8d2b\u8840\u6a21\u578b","text":"<p>\u5b9e\u4f53\u5c42\u5e94\u8be5\u5305\u542b\u4e1a\u52a1\u903b\u8f91\uff0c\u800c\u4e0d\u4ec5\u4ec5\u662f\u6570\u636e\u5bb9\u5668\u3002</p>"},{"location":"getting-started/what-is-clean-architecture/#_12","title":"\u274c \u5ffd\u89c6\u6027\u80fd","text":"<p>\u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u6e05\u6670\u7684\u67b6\u6784\u6bd4\u6027\u80fd\u4f18\u5316\u66f4\u91cd\u8981\uff0c\u4f46\u4e0d\u80fd\u5b8c\u5168\u5ffd\u89c6\u6027\u80fd\u3002</p>"},{"location":"getting-started/what-is-clean-architecture/#_13","title":"\u76f8\u5173\u67b6\u6784","text":"<p>\u6574\u6d01\u67b6\u6784\u4e0e\u4ee5\u4e0b\u67b6\u6784\u6709\u76f8\u4f3c\u4e4b\u5904\uff1a</p> <ul> <li>\u516d\u8fb9\u5f62\u67b6\u6784 (Hexagonal Architecture)</li> <li>\u6d0b\u8471\u67b6\u6784 (Onion Architecture)</li> <li>\u7aef\u53e3\u9002\u914d\u5668\u67b6\u6784 (Ports and Adapters)</li> </ul> <p>\u5b83\u4eec\u7684\u6838\u5fc3\u601d\u60f3\u90fd\u662f\u4f9d\u8d56\u5012\u7f6e\u548c\u5173\u6ce8\u70b9\u5206\u79bb\u3002</p>"},{"location":"getting-started/what-is-clean-architecture/#_14","title":"\u4e0b\u4e00\u6b65","text":"<ul> <li>\u5feb\u901f\u5f00\u59cb - \u4f7f\u7528\u6211\u4eec\u7684\u6846\u67b6\u5f00\u59cb\u5b9e\u8df5</li> <li>\u5206\u5c42\u67b6\u6784\u8be6\u89e3</li> <li>\u516d\u8fb9\u5f62\u67b6\u6784</li> <li>\u9879\u76ee\u7ed3\u6784\u6700\u4f73\u5b9e\u8df5</li> </ul>"},{"location":"getting-started/what-is-ddd/","title":"\u4ec0\u4e48\u662f\u9886\u57df\u9a71\u52a8\u8bbe\u8ba1 (DDD)","text":""},{"location":"getting-started/what-is-ddd/#_1","title":"\u7b80\u4ecb","text":"<p>\u9886\u57df\u9a71\u52a8\u8bbe\u8ba1(Domain-Driven Design\uff0c\u7b80\u79f0DDD)\u662f\u7531Eric Evans\u57282003\u5e74\u63d0\u51fa\u7684\u4e00\u79cd\u8f6f\u4ef6\u5f00\u53d1\u65b9\u6cd5\u8bba\u3002\u5b83\u5f3a\u8c03\u5c06\u8f6f\u4ef6\u8bbe\u8ba1\u4e0e\u4e1a\u52a1\u9886\u57df\u6df1\u5ea6\u7ed3\u5408\uff0c\u901a\u8fc7\u6784\u5efa\u9886\u57df\u6a21\u578b\u6765\u5e94\u5bf9\u590d\u6742\u7684\u4e1a\u52a1\u9700\u6c42\u3002</p>"},{"location":"getting-started/what-is-ddd/#_2","title":"\u6838\u5fc3\u601d\u60f3","text":"<p>DDD\u7684\u6838\u5fc3\u601d\u60f3\u53ef\u4ee5\u6982\u62ec\u4e3a\u4ee5\u4e0b\u51e0\u70b9\uff1a</p>"},{"location":"getting-started/what-is-ddd/#1","title":"1. \u9886\u57df\u6a21\u578b\u4e3a\u4e2d\u5fc3","text":"<p>\u8f6f\u4ef6\u5f00\u53d1\u5e94\u8be5\u4ee5\u4e1a\u52a1\u9886\u57df\u4e3a\u6838\u5fc3\uff0c\u800c\u4e0d\u662f\u4ee5\u6280\u672f\u5b9e\u73b0\u4e3a\u4e2d\u5fc3\u3002\u9886\u57df\u6a21\u578b\u662f\u5bf9\u4e1a\u52a1\u6982\u5ff5\u3001\u89c4\u5219\u548c\u6d41\u7a0b\u7684\u62bd\u8c61\u8868\u8fbe\u3002</p>"},{"location":"getting-started/what-is-ddd/#2-ubiquitous-language","title":"2. \u7edf\u4e00\u8bed\u8a00 (Ubiquitous Language)","text":"<p>\u5f00\u53d1\u56e2\u961f\u548c\u9886\u57df\u4e13\u5bb6\u5e94\u8be5\u4f7f\u7528\u76f8\u540c\u7684\u8bed\u8a00\u8fdb\u884c\u6c9f\u901a\u3002\u8fd9\u79cd\u7edf\u4e00\u8bed\u8a00\u4f53\u73b0\u5728\u4ee3\u7801\u3001\u6587\u6863\u548c\u65e5\u5e38\u4ea4\u6d41\u4e2d\uff0c\u51cf\u5c11\u8bef\u89e3\uff0c\u63d0\u9ad8\u6c9f\u901a\u6548\u7387\u3002</p>"},{"location":"getting-started/what-is-ddd/#3","title":"3. \u6218\u7565\u8bbe\u8ba1","text":"<p>\u901a\u8fc7\u4ee5\u4e0b\u6982\u5ff5\u8fdb\u884c\u7cfb\u7edf\u7684\u6218\u7565\u89c4\u5212\uff1a</p> <ul> <li>\u9650\u754c\u4e0a\u4e0b\u6587 (Bounded Context): \u660e\u786e\u5b9a\u4e49\u6a21\u578b\u7684\u8fb9\u754c</li> <li>\u4e0a\u4e0b\u6587\u6620\u5c04 (Context Map): \u63cf\u8ff0\u4e0d\u540c\u4e0a\u4e0b\u6587\u4e4b\u95f4\u7684\u5173\u7cfb</li> <li>\u5b50\u57df (Subdomain): \u5c06\u5927\u578b\u4e1a\u52a1\u9886\u57df\u5212\u5206\u4e3a\u66f4\u5c0f\u7684\u5b50\u57df</li> </ul>"},{"location":"getting-started/what-is-ddd/#4","title":"4. \u6218\u672f\u8bbe\u8ba1","text":"<p>\u5728\u9650\u754c\u4e0a\u4e0b\u6587\u5185\u90e8\uff0c\u4f7f\u7528\u4ee5\u4e0b\u6a21\u5f0f\u6784\u5efa\u9886\u57df\u6a21\u578b\uff1a</p> <ul> <li>\u5b9e\u4f53 (Entity): \u6709\u552f\u4e00\u6807\u8bc6\u7684\u5bf9\u8c61</li> <li>\u503c\u5bf9\u8c61 (Value Object): \u65e0\u8eab\u4efd\u6807\u8bc6\uff0c\u53ea\u5173\u6ce8\u5c5e\u6027\u7684\u5bf9\u8c61</li> <li>\u805a\u5408 (Aggregate): \u4e00\u7ec4\u76f8\u5173\u5bf9\u8c61\u7684\u96c6\u5408</li> <li>\u805a\u5408\u6839 (Aggregate Root): \u805a\u5408\u7684\u5165\u53e3</li> <li>\u9886\u57df\u4e8b\u4ef6 (Domain Event): \u9886\u57df\u4e2d\u53d1\u751f\u7684\u91cd\u8981\u4e8b\u4ef6</li> <li>\u9886\u57df\u670d\u52a1 (Domain Service): \u65e0\u6cd5\u5f52\u5c5e\u4e8e\u5b9e\u4f53\u6216\u503c\u5bf9\u8c61\u7684\u4e1a\u52a1\u903b\u8f91</li> <li>\u4ed3\u50a8 (Repository): \u7ba1\u7406\u805a\u5408\u7684\u6301\u4e45\u5316</li> <li>\u5de5\u5382 (Factory): \u521b\u5efa\u590d\u6742\u5bf9\u8c61</li> </ul>"},{"location":"getting-started/what-is-ddd/#ddd_1","title":"DDD\u7684\u4f18\u52bf","text":""},{"location":"getting-started/what-is-ddd/#_3","title":"\u5e94\u5bf9\u590d\u6742\u6027","text":"<p>DDD\u901a\u8fc7\u6218\u7565\u8bbe\u8ba1\u548c\u6218\u672f\u8bbe\u8ba1\u7684\u5b8c\u6574\u65b9\u6cd5\u8bba\uff0c\u5e2e\u52a9\u56e2\u961f\u5e94\u5bf9\u4e1a\u52a1\u590d\u6742\u6027\uff1a</p> <ul> <li>\u5c06\u5927\u95ee\u9898\u5206\u89e3\u4e3a\u5c0f\u95ee\u9898</li> <li>\u5efa\u7acb\u6e05\u6670\u7684\u8fb9\u754c\u548c\u63a5\u53e3</li> <li>\u4e13\u6ce8\u4e8e\u6838\u5fc3\u4e1a\u52a1\u4ef7\u503c</li> </ul>"},{"location":"getting-started/what-is-ddd/#_4","title":"\u63d0\u9ad8\u6c9f\u901a\u6548\u7387","text":"<p>\u7edf\u4e00\u8bed\u8a00\u786e\u4fdd\u56e2\u961f\u6210\u5458\u5bf9\u4e1a\u52a1\u7406\u89e3\u7684\u4e00\u81f4\u6027\uff0c\u51cf\u5c11\u9700\u6c42\u8bef\u89e3\u548c\u8fd4\u5de5\u3002</p>"},{"location":"getting-started/what-is-ddd/#_5","title":"\u7075\u6d3b\u5e94\u5bf9\u53d8\u5316","text":"<p>\u6e05\u6670\u7684\u9886\u57df\u6a21\u578b\u548c\u67b6\u6784\u8fb9\u754c\uff0c\u4f7f\u7cfb\u7edf\u66f4\u5bb9\u6613\u9002\u5e94\u4e1a\u52a1\u53d8\u5316\u3002</p>"},{"location":"getting-started/what-is-ddd/#_6","title":"\u63d0\u5347\u4ee3\u7801\u8d28\u91cf","text":"<p>\u5c06\u4e1a\u52a1\u903b\u8f91\u663e\u5f0f\u8868\u8fbe\u5728\u4ee3\u7801\u4e2d\uff0c\u4f7f\u4ee3\u7801\u66f4\u6613\u7406\u89e3\u548c\u7ef4\u62a4\u3002</p>"},{"location":"getting-started/what-is-ddd/#ddd_2","title":"\u4f55\u65f6\u4f7f\u7528DDD","text":"<p>DDD\u7279\u522b\u9002\u5408\u4ee5\u4e0b\u573a\u666f\uff1a</p> <ul> <li>\u590d\u6742\u4e1a\u52a1\u903b\u8f91: \u4e1a\u52a1\u89c4\u5219\u590d\u6742\uff0c\u9700\u8981\u6df1\u5165\u7406\u89e3\u9886\u57df\u77e5\u8bc6</li> <li>\u957f\u671f\u9879\u76ee: \u9879\u76ee\u9700\u8981\u957f\u671f\u7ef4\u62a4\u548c\u6f14\u8fdb</li> <li>\u56e2\u961f\u534f\u4f5c: \u9700\u8981\u5f00\u53d1\u56e2\u961f\u4e0e\u9886\u57df\u4e13\u5bb6\u7d27\u5bc6\u5408\u4f5c</li> <li>\u4e1a\u52a1\u9891\u7e41\u53d8\u5316: \u4e1a\u52a1\u9700\u6c42\u7ecf\u5e38\u53d8\u5316\uff0c\u9700\u8981\u7075\u6d3b\u5e94\u5bf9</li> </ul>"},{"location":"getting-started/what-is-ddd/#ddd_3","title":"\u4f55\u65f6\u4e0d\u9002\u5408DDD","text":"<p>DDD\u4e5f\u4e0d\u662f\u4e07\u80fd\u7684\uff0c\u4ee5\u4e0b\u573a\u666f\u53ef\u80fd\u4e0d\u9002\u5408\uff1a</p> <ul> <li>\u7b80\u5355CRUD\u5e94\u7528: \u4e1a\u52a1\u903b\u8f91\u7b80\u5355\uff0c\u4e3b\u8981\u662f\u6570\u636e\u5b58\u53d6</li> <li>\u77ed\u671f\u9879\u76ee: \u9879\u76ee\u5468\u671f\u77ed\uff0cDDD\u7684\u6295\u5165\u4ea7\u51fa\u6bd4\u4e0d\u9ad8</li> <li>\u6280\u672f\u9a71\u52a8\u9879\u76ee: \u4e3b\u8981\u662f\u6280\u672f\u5b9e\u73b0\uff0c\u4e1a\u52a1\u903b\u8f91\u8f83\u5c11</li> <li>\u56e2\u961f\u4e0d\u5177\u5907\u6761\u4ef6: \u56e2\u961f\u7f3a\u4e4fDDD\u7ecf\u9a8c\uff0c\u5b66\u4e60\u6210\u672c\u8fc7\u9ad8</li> </ul>"},{"location":"getting-started/what-is-ddd/#ddd_4","title":"DDD\u4e0e\u654f\u6377\u5f00\u53d1","text":"<p>DDD\u4e0e\u654f\u6377\u5f00\u53d1\u76f8\u8f85\u76f8\u6210\uff1a</p> <ul> <li>\u8fed\u4ee3\u5f00\u53d1: DDD\u652f\u6301\u8fed\u4ee3\u5f0f\u7684\u9886\u57df\u6a21\u578b\u6f14\u8fdb</li> <li>\u6301\u7eed\u91cd\u6784: \u968f\u7740\u5bf9\u9886\u57df\u7406\u89e3\u7684\u6df1\u5165\uff0c\u6301\u7eed\u6539\u8fdb\u6a21\u578b</li> <li>\u7528\u6237\u6545\u4e8b: \u4f7f\u7528\u7edf\u4e00\u8bed\u8a00\u63cf\u8ff0\u7528\u6237\u6545\u4e8b</li> <li>\u6d4b\u8bd5\u9a71\u52a8: \u9886\u57df\u6a21\u578b\u6613\u4e8e\u6d4b\u8bd5\uff0c\u652f\u6301TDD\u5b9e\u8df5</li> </ul>"},{"location":"getting-started/what-is-ddd/#_7","title":"\u5b66\u4e60\u8def\u5f84","text":"<p>\u5efa\u8bae\u6309\u4ee5\u4e0b\u987a\u5e8f\u5b66\u4e60DDD\uff1a</p> <ol> <li>\u7406\u89e3\u57fa\u672c\u6982\u5ff5: \u5b9e\u4f53\u3001\u503c\u5bf9\u8c61\u3001\u805a\u5408\u7b49</li> <li>\u5b66\u4e60\u6218\u672f\u8bbe\u8ba1: \u5982\u4f55\u5728\u4ee3\u7801\u4e2d\u5b9e\u73b0DDD\u6a21\u5f0f</li> <li>\u638c\u63e1\u6218\u7565\u8bbe\u8ba1: \u5982\u4f55\u5212\u5206\u9650\u754c\u4e0a\u4e0b\u6587\u548c\u8bbe\u8ba1\u4e0a\u4e0b\u6587\u6620\u5c04</li> <li>\u5b9e\u8df5\u5e94\u7528: \u5728\u5b9e\u9645\u9879\u76ee\u4e2d\u5e94\u7528DDD</li> <li>\u6301\u7eed\u6539\u8fdb: \u901a\u8fc7\u53cd\u601d\u548c\u91cd\u6784\u4e0d\u65ad\u6539\u8fdb\u9886\u57df\u6a21\u578b</li> </ol>"},{"location":"getting-started/what-is-ddd/#_8","title":"\u63a8\u8350\u8d44\u6e90","text":""},{"location":"getting-started/what-is-ddd/#_9","title":"\u4e66\u7c4d","text":"<ul> <li>\u300a\u9886\u57df\u9a71\u52a8\u8bbe\u8ba1\u300b(Domain-Driven Design) - Eric Evans</li> <li>\u300a\u5b9e\u73b0\u9886\u57df\u9a71\u52a8\u8bbe\u8ba1\u300b(Implementing Domain-Driven Design) - Vaughn Vernon</li> <li>\u300a\u9886\u57df\u9a71\u52a8\u8bbe\u8ba1\u7cbe\u7cb9\u300b(Domain-Driven Design Distilled) - Vaughn Vernon</li> </ul>"},{"location":"getting-started/what-is-ddd/#_10","title":"\u5728\u7ebf\u8d44\u6e90","text":"<ul> <li>DDD Community</li> <li>Domain-Driven Design Reference</li> </ul>"},{"location":"getting-started/what-is-ddd/#_11","title":"\u4e0b\u4e00\u6b65","text":"<ul> <li>\u4e86\u89e3Clean Architecture</li> <li>\u5feb\u901f\u5f00\u59cb</li> <li>\u6838\u5fc3\u6982\u5ff5\u8be6\u89e3</li> </ul>"},{"location":"tools/cap4j-framework/","title":"Cap4j Framework","text":"<p>(\u5185\u5bb9\u5f85\u8865\u5145)</p>"},{"location":"tools/development-tools/","title":"\u5f00\u53d1\u5de5\u5177\u63a8\u8350","text":""},{"location":"tools/development-tools/#_2","title":"\u6982\u8ff0","text":"<p>\u9009\u62e9\u5408\u9002\u7684\u5f00\u53d1\u5de5\u5177\u53ef\u4ee5\u663e\u8457\u63d0\u9ad8\u5f00\u53d1\u6548\u7387\u548c\u4ee3\u7801\u8d28\u91cf\u3002\u672c\u6587\u6863\u63a8\u8350\u4e00\u7cfb\u5217\u5728DDD\u548cClean Architecture\u9879\u76ee\u4e2d\u5e38\u7528\u7684\u5f00\u53d1\u5de5\u5177\u3002</p>"},{"location":"tools/development-tools/#ide","title":"\u96c6\u6210\u5f00\u53d1\u73af\u5883\uff08IDE\uff09","text":""},{"location":"tools/development-tools/#visual-studio-2022","title":"Visual Studio 2022","text":"<p>\u5b98\u7f51: https://visualstudio.microsoft.com/</p> <p>\u4f18\u52bf: - \u5b8c\u6574\u7684.NET\u5f00\u53d1\u652f\u6301 - \u5f3a\u5927\u7684\u8c03\u8bd5\u5de5\u5177 - \u5185\u7f6e\u6570\u636e\u5e93\u5de5\u5177 - Resharper\u96c6\u6210 - \u4f18\u79c0\u7684\u91cd\u6784\u652f\u6301</p> <p>\u63a8\u8350\u7248\u672c: Professional\u6216Enterprise</p> <p>\u5fc5\u5907\u63d2\u4ef6: - ReSharper - \u4ee3\u7801\u5206\u6790\u548c\u91cd\u6784 - SonarLint - \u4ee3\u7801\u8d28\u91cf\u68c0\u67e5 - CodeMaid - \u4ee3\u7801\u6e05\u7406 - Productivity Power Tools - \u751f\u4ea7\u529b\u589e\u5f3a</p>"},{"location":"tools/development-tools/#jetbrains-rider","title":"JetBrains Rider","text":"<p>\u5b98\u7f51: https://www.jetbrains.com/rider/</p> <p>\u4f18\u52bf: - \u8de8\u5e73\u53f0\u652f\u6301 - \u5185\u7f6eReSharper\u529f\u80fd - \u6027\u80fd\u4f18\u79c0 - \u5f3a\u5927\u7684\u4ee3\u7801\u5bfc\u822a - \u4f18\u79c0\u7684\u8c03\u8bd5\u4f53\u9a8c</p> <p>\u63a8\u8350\u4f7f\u7528\u573a\u666f: - macOS\u6216Linux\u5f00\u53d1 - \u8ffd\u6c42\u6027\u80fd\u548c\u54cd\u5e94\u901f\u5ea6 - \u559c\u6b22JetBrains\u7cfb\u5217\u5de5\u5177</p>"},{"location":"tools/development-tools/#visual-studio-code","title":"Visual Studio Code","text":"<p>\u5b98\u7f51: https://code.visualstudio.com/</p> <p>\u4f18\u52bf: - \u8f7b\u91cf\u7ea7 - \u4e30\u5bcc\u7684\u6269\u5c55\u751f\u6001 - \u8de8\u5e73\u53f0 - \u5feb\u901f\u542f\u52a8 - \u5f3a\u5927\u7684Git\u96c6\u6210</p> <p>\u63a8\u8350\u6269\u5c55: - C# Dev Kit - C#\u5f00\u53d1\u652f\u6301 - GitLens - Git\u589e\u5f3a - REST Client - API\u6d4b\u8bd5 - Docker - \u5bb9\u5668\u652f\u6301 - ESLint - \u4ee3\u7801\u89c4\u8303</p>"},{"location":"tools/development-tools/#_3","title":"\u6570\u636e\u5e93\u5de5\u5177","text":""},{"location":"tools/development-tools/#azure-data-studio","title":"Azure Data Studio","text":"<p>\u5b98\u7f51: https://azure.microsoft.com/en-us/products/data-studio</p> <p>\u7279\u70b9: - \u8de8\u5e73\u53f0SQL Server\u5de5\u5177 - \u73b0\u4ee3\u5316\u754c\u9762 - \u6269\u5c55\u652f\u6301 - Notebook\u652f\u6301</p>"},{"location":"tools/development-tools/#dbeaver","title":"DBeaver","text":"<p>\u5b98\u7f51: https://dbeaver.io/</p> <p>\u7279\u70b9: - \u652f\u6301\u591a\u79cd\u6570\u636e\u5e93 - \u514d\u8d39\u5f00\u6e90 - ER\u56fe\u751f\u6210 - \u6570\u636e\u5bfc\u5165\u5bfc\u51fa</p>"},{"location":"tools/development-tools/#sql-server-management-studio-ssms","title":"SQL Server Management Studio (SSMS)","text":"<p>\u5b98\u7f51: https://docs.microsoft.com/en-us/sql/ssms/</p> <p>\u7279\u70b9: - SQL Server\u4e13\u7528\u5de5\u5177 - \u529f\u80fd\u5168\u9762 - \u67e5\u8be2\u4f18\u5316\u5efa\u8bae - \u6027\u80fd\u76d1\u63a7</p>"},{"location":"tools/development-tools/#api","title":"API\u5f00\u53d1\u4e0e\u6d4b\u8bd5","text":""},{"location":"tools/development-tools/#postman","title":"Postman","text":"<p>\u5b98\u7f51: https://www.postman.com/</p> <p>\u529f\u80fd: - API\u8bf7\u6c42\u6d4b\u8bd5 - \u96c6\u5408\u7ba1\u7406 - \u73af\u5883\u53d8\u91cf - \u81ea\u52a8\u5316\u6d4b\u8bd5 - \u6587\u6863\u751f\u6210</p> <p>\u4f7f\u7528\u5efa\u8bae: - \u4e3a\u6bcf\u4e2a\u9879\u76ee\u521b\u5efaCollection - \u4f7f\u7528\u73af\u5883\u53d8\u91cf\u7ba1\u7406\u4e0d\u540c\u73af\u5883 - \u7f16\u5199\u6d4b\u8bd5\u811a\u672c\u8fdb\u884c\u81ea\u52a8\u5316\u6d4b\u8bd5</p>"},{"location":"tools/development-tools/#swaggeropenapi","title":"Swagger/OpenAPI","text":"<p>\u96c6\u6210\u65b9\u5f0f: <pre><code>// Program.cs\nbuilder.Services.AddEndpointsApiExplorer();\nbuilder.Services.AddSwaggerGen(c =&gt;\n{\n    c.SwaggerDoc(\"v1\", new OpenApiInfo \n    { \n        Title = \"My API\", \n        Version = \"v1\" \n    });\n});\n\nvar app = builder.Build();\n\nif (app.Environment.IsDevelopment())\n{\n    app.UseSwagger();\n    app.UseSwaggerUI();\n}\n</code></pre></p> <p>\u7279\u70b9: - \u81ea\u52a8\u751f\u6210API\u6587\u6863 - \u5728\u7ebf\u6d4b\u8bd5\u63a5\u53e3 - \u5ba2\u6237\u7aef\u4ee3\u7801\u751f\u6210</p>"},{"location":"tools/development-tools/#rest-client-vs-code-extension","title":"REST Client (VS Code Extension)","text":"<p>\u7279\u70b9: - \u5728\u4ee3\u7801\u7f16\u8f91\u5668\u4e2d\u6d4b\u8bd5API - \u652f\u6301.http\u6587\u4ef6 - \u7248\u672c\u63a7\u5236\u53cb\u597d</p> <p>\u793a\u4f8b: <pre><code>### \u521b\u5efa\u7528\u6237\nPOST https://localhost:5001/api/users\nContent-Type: application/json\n\n{\n  \"name\": \"\u5f20\u4e09\",\n  \"email\": \"zhangsan@example.com\"\n}\n\n### \u83b7\u53d6\u7528\u6237\u5217\u8868\nGET https://localhost:5001/api/users?pageIndex=1&amp;pageSize=20\n</code></pre></p>"},{"location":"tools/development-tools/#_4","title":"\u7248\u672c\u63a7\u5236","text":""},{"location":"tools/development-tools/#git","title":"Git","text":"<p>\u5b98\u7f51: https://git-scm.com/</p> <p>\u5fc5\u5907\u6280\u80fd: - \u57fa\u672c\u547d\u4ee4: add, commit, push, pull - \u5206\u652f\u7ba1\u7406: branch, merge, rebase - \u51b2\u7a81\u89e3\u51b3 - \u6807\u7b7e\u7ba1\u7406</p> <p>\u63a8\u8350Git\u5de5\u4f5c\u6d41: - Git Flow - \u9002\u5408\u53d1\u5e03\u5468\u671f\u660e\u786e\u7684\u9879\u76ee - GitHub Flow - \u9002\u5408\u6301\u7eed\u90e8\u7f72\u7684\u9879\u76ee - Trunk Based Development - \u9002\u5408\u9ad8\u9891\u90e8\u7f72</p>"},{"location":"tools/development-tools/#github-desktop","title":"GitHub Desktop","text":"<p>\u5b98\u7f51: https://desktop.github.com/</p> <p>\u7279\u70b9: - \u56fe\u5f62\u5316Git\u5ba2\u6237\u7aef - \u7b80\u5355\u6613\u7528 - \u9002\u5408Git\u65b0\u624b</p>"},{"location":"tools/development-tools/#sourcetree","title":"SourceTree","text":"<p>\u5b98\u7f51: https://www.sourcetreeapp.com/</p> <p>\u7279\u70b9: - \u5f3a\u5927\u7684\u53ef\u89c6\u5316 - \u652f\u6301Git Flow - \u4ea4\u4e92\u5f0f\u53d8\u57fa</p>"},{"location":"tools/development-tools/#_5","title":"\u5bb9\u5668\u4e0e\u7f16\u6392","text":""},{"location":"tools/development-tools/#docker-desktop","title":"Docker Desktop","text":"<p>\u5b98\u7f51: https://www.docker.com/products/docker-desktop/</p> <p>\u7528\u9014: - \u672c\u5730\u5f00\u53d1\u73af\u5883 - \u6570\u636e\u5e93\u5bb9\u5668 - \u5fae\u670d\u52a1\u6d4b\u8bd5 - CI/CD\u96c6\u6210</p> <p>\u793a\u4f8bDockerfile: <pre><code>FROM mcr.microsoft.com/dotnet/aspnet:8.0 AS base\nWORKDIR /app\nEXPOSE 80\n\nFROM mcr.microsoft.com/dotnet/sdk:8.0 AS build\nWORKDIR /src\nCOPY [\"MyProject.Web/MyProject.Web.csproj\", \"MyProject.Web/\"]\nRUN dotnet restore \"MyProject.Web/MyProject.Web.csproj\"\nCOPY . .\nWORKDIR \"/src/MyProject.Web\"\nRUN dotnet build \"MyProject.Web.csproj\" -c Release -o /app/build\n\nFROM build AS publish\nRUN dotnet publish \"MyProject.Web.csproj\" -c Release -o /app/publish\n\nFROM base AS final\nWORKDIR /app\nCOPY --from=publish /app/publish .\nENTRYPOINT [\"dotnet\", \"MyProject.Web.dll\"]\n</code></pre></p>"},{"location":"tools/development-tools/#docker-compose","title":"Docker Compose","text":"<p>\u7528\u9014: - \u591a\u5bb9\u5668\u5e94\u7528\u7f16\u6392 - \u672c\u5730\u5f00\u53d1\u73af\u5883</p> <p>\u793a\u4f8bdocker-compose.yml: <pre><code>version: '3.8'\n\nservices:\n  api:\n    build: .\n    ports:\n      - \"5000:80\"\n    environment:\n      - ASPNETCORE_ENVIRONMENT=Development\n      - ConnectionStrings__DefaultConnection=Server=db;Database=MyProjectDb;User=sa;Password=Your_password123;\n    depends_on:\n      - db\n\n  db:\n    image: mcr.microsoft.com/mssql/server:2022-latest\n    environment:\n      - ACCEPT_EULA=Y\n      - SA_PASSWORD=Your_password123\n    ports:\n      - \"1433:1433\"\n    volumes:\n      - sqldata:/var/opt/mssql\n\nvolumes:\n  sqldata:\n</code></pre></p>"},{"location":"tools/development-tools/#_6","title":"\u6027\u80fd\u5206\u6790","text":""},{"location":"tools/development-tools/#dotnet-counters","title":"dotnet-counters","text":"<p>\u5b89\u88c5: <pre><code>dotnet tool install --global dotnet-counters\n</code></pre></p> <p>\u4f7f\u7528: <pre><code># \u76d1\u63a7\u5e94\u7528\u6027\u80fd\ndotnet-counters monitor --process-id &lt;PID&gt;\n</code></pre></p>"},{"location":"tools/development-tools/#dotnet-trace","title":"dotnet-trace","text":"<p>\u5b89\u88c5: <pre><code>dotnet tool install --global dotnet-trace\n</code></pre></p> <p>\u4f7f\u7528: <pre><code># \u6536\u96c6\u6027\u80fd\u8ffd\u8e2a\ndotnet-trace collect --process-id &lt;PID&gt;\n</code></pre></p>"},{"location":"tools/development-tools/#miniprofiler","title":"MiniProfiler","text":"<p>NuGet\u5305: <pre><code>dotnet add package MiniProfiler.AspNetCore.Mvc\n</code></pre></p> <p>\u914d\u7f6e: <pre><code>builder.Services.AddMiniProfiler(options =&gt;\n{\n    options.RouteBasePath = \"/profiler\";\n}).AddEntityFramework();\n\napp.UseMiniProfiler();\n</code></pre></p>"},{"location":"tools/development-tools/#_7","title":"\u65e5\u5fd7\u4e0e\u76d1\u63a7","text":""},{"location":"tools/development-tools/#serilog","title":"Serilog","text":"<p>NuGet\u5305: <pre><code>dotnet add package Serilog.AspNetCore\ndotnet add package Serilog.Sinks.Console\ndotnet add package Serilog.Sinks.File\n</code></pre></p> <p>\u914d\u7f6e: <pre><code>builder.Host.UseSerilog((context, configuration) =&gt;\n{\n    configuration\n        .ReadFrom.Configuration(context.Configuration)\n        .Enrich.FromLogContext()\n        .WriteTo.Console()\n        .WriteTo.File(\"logs/log-.txt\", rollingInterval: RollingInterval.Day);\n});\n</code></pre></p>"},{"location":"tools/development-tools/#seq","title":"Seq","text":"<p>\u5b98\u7f51: https://datalust.co/seq</p> <p>\u7279\u70b9: - \u7ed3\u6784\u5316\u65e5\u5fd7\u67e5\u8be2 - \u5b9e\u65f6\u65e5\u5fd7\u67e5\u770b - \u5f3a\u5927\u7684\u8fc7\u6ee4\u548c\u641c\u7d22</p>"},{"location":"tools/development-tools/#application-insights","title":"Application Insights","text":"<p>\u5b98\u7f51: https://azure.microsoft.com/en-us/products/monitor/</p> <p>\u7279\u70b9: - Azure\u96c6\u6210 - \u5e94\u7528\u6027\u80fd\u76d1\u63a7 - \u5206\u5e03\u5f0f\u8ffd\u8e2a - \u5f02\u5e38\u8ddf\u8e2a</p>"},{"location":"tools/development-tools/#_8","title":"\u4ee3\u7801\u8d28\u91cf","text":""},{"location":"tools/development-tools/#sonarqube","title":"SonarQube","text":"<p>\u5b98\u7f51: https://www.sonarsource.com/products/sonarqube/</p> <p>\u529f\u80fd: - \u4ee3\u7801\u8d28\u91cf\u5206\u6790 - \u5b89\u5168\u6f0f\u6d1e\u68c0\u6d4b - \u6280\u672f\u503a\u52a1\u8bc4\u4f30 - \u4ee3\u7801\u8986\u76d6\u7387</p>"},{"location":"tools/development-tools/#resharper","title":"ReSharper","text":"<p>\u5b98\u7f51: https://www.jetbrains.com/resharper/</p> <p>\u529f\u80fd: - \u4ee3\u7801\u5206\u6790 - \u5feb\u901f\u91cd\u6784 - \u4ee3\u7801\u751f\u6210 - \u5bfc\u822a\u589e\u5f3a</p>"},{"location":"tools/development-tools/#stylecop","title":"StyleCop","text":"<p>NuGet\u5305: <pre><code>dotnet add package StyleCop.Analyzers\n</code></pre></p> <p>\u914d\u7f6e: <pre><code>&lt;!-- .editorconfig --&gt;\n[*.cs]\ndotnet_diagnostic.SA1633.severity = none # \u6587\u4ef6\u5934\u6ce8\u91ca\ndotnet_diagnostic.SA1200.severity = none # Using\u6307\u4ee4\u4f4d\u7f6e\n</code></pre></p>"},{"location":"tools/development-tools/#_9","title":"\u6d4b\u8bd5\u5de5\u5177","text":""},{"location":"tools/development-tools/#xunit","title":"xUnit","text":"<p>NuGet\u5305: <pre><code>dotnet add package xunit\ndotnet add package xunit.runner.visualstudio\n</code></pre></p>"},{"location":"tools/development-tools/#moq","title":"Moq","text":"<p>NuGet\u5305: <pre><code>dotnet add package Moq\n</code></pre></p>"},{"location":"tools/development-tools/#fluentassertions","title":"FluentAssertions","text":"<p>NuGet\u5305: <pre><code>dotnet add package FluentAssertions\n</code></pre></p> <p>\u793a\u4f8b: <pre><code>user.Name.Should().Be(\"\u5f20\u4e09\");\nuser.Email.Should().NotBeNullOrEmpty();\nusers.Should().HaveCount(10);\n</code></pre></p>"},{"location":"tools/development-tools/#coverlet","title":"Coverlet","text":"<p>NuGet\u5305: <pre><code>dotnet add package coverlet.collector\n</code></pre></p> <p>\u4f7f\u7528: <pre><code>dotnet test /p:CollectCoverage=true /p:CoverletOutputFormat=opencover\n</code></pre></p>"},{"location":"tools/development-tools/#_10","title":"\u6587\u6863\u751f\u6210","text":""},{"location":"tools/development-tools/#docfx","title":"DocFX","text":"<p>\u5b98\u7f51: https://dotnet.github.io/docfx/</p> <p>\u7279\u70b9: - API\u6587\u6863\u751f\u6210 - Markdown\u652f\u6301 - \u81ea\u5b9a\u4e49\u4e3b\u9898</p>"},{"location":"tools/development-tools/#mermaid","title":"Mermaid","text":"<p>\u5b98\u7f51: https://mermaid.js.org/</p> <p>\u7528\u9014: - \u6d41\u7a0b\u56fe - \u5e8f\u5217\u56fe - \u7c7b\u56fe - ER\u56fe</p> <p>\u793a\u4f8b: <pre><code>sequenceDiagram\n    Client-&gt;&gt;+API: CreateUserCommand\n    API-&gt;&gt;+CommandHandler: Handle\n    CommandHandler-&gt;&gt;+Repository: AddAsync\n    Repository-&gt;&gt;+Database: Insert\n    Database--&gt;&gt;-Repository: Success\n    Repository--&gt;&gt;-CommandHandler: UserId\n    CommandHandler--&gt;&gt;-API: UserId\n    API--&gt;&gt;-Client: Response\n</code></pre></p>"},{"location":"tools/development-tools/#cicd","title":"CI/CD\u5de5\u5177","text":""},{"location":"tools/development-tools/#github-actions","title":"GitHub Actions","text":"<p>\u793a\u4f8b\u5de5\u4f5c\u6d41: <pre><code>name: .NET Build and Test\n\non:\n  push:\n    branches: [ main ]\n  pull_request:\n    branches: [ main ]\n\njobs:\n  build:\n    runs-on: ubuntu-latest\n\n    steps:\n    - uses: actions/checkout@v3\n    - name: Setup .NET\n      uses: actions/setup-dotnet@v3\n      with:\n        dotnet-version: 8.0.x\n    - name: Restore dependencies\n      run: dotnet restore\n    - name: Build\n      run: dotnet build --no-restore\n    - name: Test\n      run: dotnet test --no-build --verbosity normal\n</code></pre></p>"},{"location":"tools/development-tools/#azure-devops","title":"Azure DevOps","text":"<p>\u7279\u70b9: - \u5b8c\u6574\u7684DevOps\u5e73\u53f0 - \u5de5\u4f5c\u9879\u7ba1\u7406 - \u6e90\u4ee3\u7801\u7ba1\u7406 - CI/CD\u7ba1\u9053</p>"},{"location":"tools/development-tools/#jenkins","title":"Jenkins","text":"<p>\u7279\u70b9: - \u5f00\u6e90\u514d\u8d39 - \u4e30\u5bcc\u7684\u63d2\u4ef6 - \u9ad8\u5ea6\u53ef\u5b9a\u5236</p>"},{"location":"tools/development-tools/#_11","title":"\u5f00\u53d1\u6548\u7387\u5de5\u5177","text":""},{"location":"tools/development-tools/#linqpad","title":"LINQPad","text":"<p>\u5b98\u7f51: https://www.linqpad.net/</p> <p>\u7528\u9014: - LINQ\u67e5\u8be2\u6d4b\u8bd5 - C#\u4ee3\u7801\u7247\u6bb5\u8fd0\u884c - \u6570\u636e\u5e93\u67e5\u8be2</p>"},{"location":"tools/development-tools/#net-interactive-notebooks","title":".NET Interactive Notebooks","text":"<p>\u5b89\u88c5: <pre><code>dotnet tool install -g Microsoft.dotnet-interactive\n</code></pre></p> <p>\u7528\u9014: - \u4ea4\u4e92\u5f0f\u4ee3\u7801\u6267\u884c - \u6587\u6863\u548c\u4ee3\u7801\u7ed3\u5408 - \u6570\u636e\u5206\u6790</p>"},{"location":"tools/development-tools/#snippet-generator","title":"Snippet Generator","text":"<p>\u7528\u9014: - \u521b\u5efa\u4ee3\u7801\u7247\u6bb5 - \u63d0\u9ad8\u7f16\u7801\u6548\u7387</p>"},{"location":"tools/development-tools/#_12","title":"\u63a8\u8350\u5de5\u5177\u7ec4\u5408","text":""},{"location":"tools/development-tools/#_13","title":"\u4e2a\u4eba\u5f00\u53d1\u8005","text":"<ul> <li>IDE: Visual Studio Code\u6216Rider</li> <li>API\u6d4b\u8bd5: REST Client</li> <li>\u6570\u636e\u5e93: Azure Data Studio</li> <li>\u7248\u672c\u63a7\u5236: GitHub Desktop</li> <li>\u5bb9\u5668: Docker Desktop</li> </ul>"},{"location":"tools/development-tools/#_14","title":"\u56e2\u961f\u5f00\u53d1","text":"<ul> <li>IDE: Visual Studio 2022\u6216Rider</li> <li>API\u6d4b\u8bd5: Postman</li> <li>\u6570\u636e\u5e93: SQL Server Management Studio</li> <li>\u7248\u672c\u63a7\u5236: Git + SourceTree</li> <li>CI/CD: GitHub Actions</li> <li>\u4ee3\u7801\u8d28\u91cf: SonarQube</li> <li>\u65e5\u5fd7: Serilog + Seq</li> </ul>"},{"location":"tools/development-tools/#_15","title":"\u4f01\u4e1a\u7ea7\u9879\u76ee","text":"<ul> <li>IDE: Visual Studio 2022 Enterprise</li> <li>API\u7f51\u5173: Kong\u6216Ocelot</li> <li>\u670d\u52a1\u7f51\u683c: Istio</li> <li>\u76d1\u63a7: Application Insights</li> <li>\u65e5\u5fd7: ELK Stack</li> <li>CI/CD: Azure DevOps</li> <li>\u4ee3\u7801\u8d28\u91cf: SonarQube</li> </ul>"},{"location":"tools/development-tools/#_16","title":"\u5b66\u4e60\u8d44\u6e90","text":""},{"location":"tools/development-tools/#_17","title":"\u5728\u7ebf\u8bfe\u7a0b","text":"<ul> <li>Pluralsight - .NET\u76f8\u5173\u8bfe\u7a0b</li> <li>Udemy - DDD\u548cClean Architecture</li> <li>Microsoft Learn - \u5b98\u65b9\u5b66\u4e60\u5e73\u53f0</li> </ul>"},{"location":"tools/development-tools/#_18","title":"\u4e66\u7c4d\u63a8\u8350","text":"<ul> <li>\u300aDomain-Driven Design\u300b - Eric Evans</li> <li>\u300aImplementing Domain-Driven Design\u300b - Vaughn Vernon</li> <li>\u300aClean Architecture\u300b - Robert C. Martin</li> <li>\u300aPatterns, Principles, and Practices of Domain-Driven Design\u300b</li> </ul>"},{"location":"tools/development-tools/#_19","title":"\u535a\u5ba2\u548c\u7f51\u7ad9","text":"<ul> <li>Martin Fowler\u7684\u535a\u5ba2</li> <li>Microsoft .NET Blog</li> <li>DDD Community</li> <li>Clean Coder Blog</li> </ul>"},{"location":"tools/development-tools/#_20","title":"\u76f8\u5173\u6587\u6863","text":"<ul> <li>NetCorePal Framework</li> <li>CAP4J Framework</li> <li>\u9879\u76ee\u7ed3\u6784\u6700\u4f73\u5b9e\u8df5</li> <li>\u6d4b\u8bd5\u7b56\u7565</li> </ul>"},{"location":"tools/netcorepal-framework/","title":"NetCorePal Cloud Framework","text":""},{"location":"tools/netcorepal-framework/#_1","title":"\u6982\u8ff0","text":"<p>NetCorePal Cloud Framework \u662f\u4e00\u4e2a\u57fa\u4e8e .NET 8 \u7684\u4f01\u4e1a\u7ea7\u5fae\u670d\u52a1\u5f00\u53d1\u6846\u67b6\uff0c\u6df1\u5ea6\u96c6\u6210\u4e86\u9886\u57df\u9a71\u52a8\u8bbe\u8ba1\uff08DDD\uff09\u548c\u6574\u6d01\u67b6\u6784\uff08Clean Architecture\uff09\u7684\u6700\u4f73\u5b9e\u8df5\u3002\u8be5\u6846\u67b6\u63d0\u4f9b\u4e86\u5b8c\u6574\u7684\u5f00\u53d1\u6a21\u677f\u548c\u5de5\u5177\u5e93\uff0c\u5e2e\u52a9\u5f00\u53d1\u56e2\u961f\u5feb\u901f\u6784\u5efa\u9ad8\u8d28\u91cf\u7684\u5fae\u670d\u52a1\u5e94\u7528\u3002</p>"},{"location":"tools/netcorepal-framework/#_2","title":"\u6838\u5fc3\u7279\u6027","text":""},{"location":"tools/netcorepal-framework/#1-ddd","title":"1. DDD \u6838\u5fc3\u6982\u5ff5\u652f\u6301","text":"<ul> <li>\u805a\u5408\u6839\u4e0e\u5b9e\u4f53: \u63d0\u4f9b\u57fa\u7840Entity\u7c7b\u548cIAggregateRoot\u63a5\u53e3</li> <li>\u5f3a\u7c7b\u578bID: \u652f\u6301IGuidStronglyTypedId\u548cIInt64StronglyTypedId\uff0c\u907f\u514dID\u7c7b\u578b\u6df7\u6dc6</li> <li>\u9886\u57df\u4e8b\u4ef6: \u5185\u7f6eIDomainEvent\u63a5\u53e3\u548c\u4e8b\u4ef6\u53d1\u5e03\u673a\u5236</li> <li>\u503c\u5bf9\u8c61: \u652f\u6301\u503c\u5bf9\u8c61\u7684\u5b9a\u4e49\u548c\u4f7f\u7528</li> <li>\u4ed3\u50a8\u6a21\u5f0f: \u63d0\u4f9bIRepository\u63a5\u53e3\u548cRepositoryBase\u57fa\u7c7b</li> </ul>"},{"location":"tools/netcorepal-framework/#2-cqrs","title":"2. CQRS \u6a21\u5f0f\u5b9e\u73b0","text":"<ul> <li>\u547d\u4ee4\u5904\u7406: \u57fa\u4e8eMediatR\u7684ICommand\u548cICommandHandler\u63a5\u53e3</li> <li>\u67e5\u8be2\u5904\u7406: IQuery\u548cIQueryHandler\u63a5\u53e3\uff0c\u652f\u6301\u8bfb\u5199\u5206\u79bb</li> <li>\u9a8c\u8bc1\u96c6\u6210: FluentValidation\u81ea\u52a8\u9a8c\u8bc1\u652f\u6301</li> <li>\u4e8b\u52a1\u7ba1\u7406: \u81ea\u52a8\u4e8b\u52a1\u8fb9\u754c\u7ba1\u7406</li> </ul>"},{"location":"tools/netcorepal-framework/#3","title":"3. \u4e8b\u4ef6\u9a71\u52a8\u67b6\u6784","text":"<ul> <li>\u9886\u57df\u4e8b\u4ef6: \u805a\u5408\u5185\u4e8b\u4ef6\uff0c\u4e8b\u52a1\u8fb9\u754c\u5185\u5904\u7406</li> <li>\u96c6\u6210\u4e8b\u4ef6: \u8de8\u670d\u52a1\u4e8b\u4ef6\uff0c\u5f02\u6b65\u6d88\u606f\u4f20\u9012</li> <li>\u4e8b\u4ef6\u5904\u7406\u5668: \u81ea\u52a8\u6ce8\u518c\u548c\u8c03\u7528\u673a\u5236</li> <li>\u4e8b\u4ef6\u6eaf\u6e90: \u53ef\u9009\u7684\u4e8b\u4ef6\u5b58\u50a8\u652f\u6301</li> </ul>"},{"location":"tools/netcorepal-framework/#4","title":"4. \u5fae\u670d\u52a1\u57fa\u7840\u8bbe\u65bd","text":"<ul> <li>\u670d\u52a1\u6ce8\u518c\u4e0e\u53d1\u73b0: \u652f\u6301Consul\u3001Nacos\u7b49\u6ce8\u518c\u4e2d\u5fc3</li> <li>\u914d\u7f6e\u7ba1\u7406: \u96c6\u4e2d\u5f0f\u914d\u7f6e\u548c\u52a8\u6001\u5237\u65b0</li> <li>\u94fe\u8def\u8ffd\u8e2a: OpenTelemetry\u96c6\u6210</li> <li>\u5065\u5eb7\u68c0\u67e5: \u5185\u7f6e\u5065\u5eb7\u68c0\u67e5\u7aef\u70b9</li> <li>\u7194\u65ad\u964d\u7ea7: Polly\u96c6\u6210</li> </ul>"},{"location":"tools/netcorepal-framework/#5","title":"5. \u6570\u636e\u8bbf\u95ee","text":"<ul> <li>EF Core\u96c6\u6210: \u6df1\u5ea6\u96c6\u6210Entity Framework Core</li> <li>\u591a\u6570\u636e\u5e93\u652f\u6301: SQL Server\u3001MySQL\u3001PostgreSQL</li> <li>\u81ea\u52a8\u5ba1\u8ba1: \u521b\u5efa\u65f6\u95f4\u3001\u66f4\u65b0\u65f6\u95f4\u3001\u64cd\u4f5c\u4eba\u81ea\u52a8\u8bb0\u5f55</li> <li>\u8f6f\u5220\u9664: \u5185\u7f6e\u8f6f\u5220\u9664\u652f\u6301</li> <li>\u4e50\u89c2\u5e76\u53d1: RowVersion\u81ea\u52a8\u7ba1\u7406</li> </ul>"},{"location":"tools/netcorepal-framework/#6-api","title":"6. API\u5f00\u53d1","text":"<ul> <li>FastEndpoints\u96c6\u6210: \u9ad8\u6027\u80fd\u7aef\u70b9\u8def\u7531</li> <li>\u81ea\u52a8API\u6587\u6863: Swagger/OpenAPI\u652f\u6301</li> <li>\u7248\u672c\u63a7\u5236: API\u7248\u672c\u7ba1\u7406</li> <li>\u54cd\u5e94\u5305\u88c5: \u7edf\u4e00\u54cd\u5e94\u683c\u5f0f</li> <li>\u5f02\u5e38\u5904\u7406: \u7edf\u4e00\u5f02\u5e38\u5904\u7406\u4e2d\u95f4\u4ef6</li> </ul>"},{"location":"tools/netcorepal-framework/#_3","title":"\u5feb\u901f\u5f00\u59cb","text":""},{"location":"tools/netcorepal-framework/#1","title":"1. \u5b89\u88c5\u6a21\u677f","text":"<pre><code># \u5b89\u88c5 NetCorePal \u9879\u76ee\u6a21\u677f\ndotnet new install NetCorePal.Template\n\n# \u67e5\u770b\u5df2\u5b89\u88c5\u7684\u6a21\u677f\ndotnet new list\n</code></pre>"},{"location":"tools/netcorepal-framework/#2","title":"2. \u521b\u5efa\u9879\u76ee","text":"<pre><code># \u521b\u5efa\u65b0\u7684\u5fae\u670d\u52a1\u9879\u76ee\ndotnet new netcorepal-webapi -n MyProject\ncd MyProject\n\n# \u6062\u590d\u4f9d\u8d56\ndotnet restore\n\n# \u8fd0\u884c\u9879\u76ee\ndotnet run --project src/MyProject.Web\n</code></pre>"},{"location":"tools/netcorepal-framework/#3_1","title":"3. \u9879\u76ee\u7ed3\u6784","text":"<pre><code>MyProject/\n\u251c\u2500\u2500 src/\n\u2502   \u251c\u2500\u2500 MyProject.Domain/           # \u9886\u57df\u5c42\n\u2502   \u2502   \u251c\u2500\u2500 AggregatesModel/        # \u805a\u5408\u6839\n\u2502   \u2502   \u251c\u2500\u2500 DomainEvents/           # \u9886\u57df\u4e8b\u4ef6\n\u2502   \u2502   \u2514\u2500\u2500 DomainServices/         # \u9886\u57df\u670d\u52a1\n\u2502   \u251c\u2500\u2500 MyProject.Infrastructure/   # \u57fa\u7840\u8bbe\u65bd\u5c42\n\u2502   \u2502   \u251c\u2500\u2500 Repositories/           # \u4ed3\u50a8\u5b9e\u73b0\n\u2502   \u2502   \u251c\u2500\u2500 EntityConfigurations/   # \u5b9e\u4f53\u914d\u7f6e\n\u2502   \u2502   \u251c\u2500\u2500 Migrations/             # \u6570\u636e\u5e93\u8fc1\u79fb\n\u2502   \u2502   \u2514\u2500\u2500 ApplicationDbContext.cs\n\u2502   \u2514\u2500\u2500 MyProject.Web/             # \u8868\u73b0\u5c42\n\u2502       \u251c\u2500\u2500 Application/            # \u5e94\u7528\u670d\u52a1\n\u2502       \u2502   \u251c\u2500\u2500 Commands/          # \u547d\u4ee4\n\u2502       \u2502   \u251c\u2500\u2500 Queries/           # \u67e5\u8be2\n\u2502       \u2502   \u251c\u2500\u2500 DomainEventHandlers/\n\u2502       \u2502   \u2514\u2500\u2500 IntegrationEvents/\n\u2502       \u251c\u2500\u2500 Endpoints/             # API\u7aef\u70b9\n\u2502       \u2514\u2500\u2500 Program.cs\n\u2514\u2500\u2500 test/                          # \u6d4b\u8bd5\u9879\u76ee\n    \u251c\u2500\u2500 MyProject.Domain.UnitTests/\n    \u251c\u2500\u2500 MyProject.Infrastructure.UnitTests/\n    \u2514\u2500\u2500 MyProject.Web.UnitTests/\n</code></pre>"},{"location":"tools/netcorepal-framework/#_4","title":"\u6838\u5fc3\u7ec4\u4ef6\u8be6\u89e3","text":""},{"location":"tools/netcorepal-framework/#id","title":"\u5f3a\u7c7b\u578bID","text":"<p>\u6846\u67b6\u63d0\u4f9b\u4e86\u5f3a\u7c7b\u578bID\u652f\u6301\uff0c\u907f\u514d\u4e0d\u540c\u5b9e\u4f53ID\u4e4b\u95f4\u7684\u6df7\u6dc6\uff1a</p> <pre><code>// \u5b9a\u4e49\u5f3a\u7c7b\u578bID\npublic partial record UserId : IGuidStronglyTypedId;\npublic partial record OrderId : IGuidStronglyTypedId;\n\n// \u4f7f\u7528\u5f3a\u7c7b\u578bID\npublic class User : Entity&lt;UserId&gt;, IAggregateRoot\n{\n    protected User() { }\n\n    public User(string name)\n    {\n        Name = name;\n        // ID\u4f1a\u7531EF Core\u503c\u751f\u6210\u5668\u81ea\u52a8\u751f\u6210\n    }\n\n    public string Name { get; private set; } = string.Empty;\n}\n</code></pre>"},{"location":"tools/netcorepal-framework/#_5","title":"\u805a\u5408\u6839\u57fa\u7c7b","text":"<pre><code>public abstract class Entity&lt;TId&gt; where TId : notnull\n{\n    public TId Id { get; protected set; } = default!;\n\n    private readonly List&lt;IDomainEvent&gt; _domainEvents = new();\n\n    protected void AddDomainEvent(IDomainEvent domainEvent)\n    {\n        _domainEvents.Add(domainEvent);\n    }\n\n    public IReadOnlyCollection&lt;IDomainEvent&gt; GetDomainEvents() \n        =&gt; _domainEvents.AsReadOnly();\n\n    public void ClearDomainEvents() \n        =&gt; _domainEvents.Clear();\n}\n\npublic interface IAggregateRoot { }\n</code></pre>"},{"location":"tools/netcorepal-framework/#_6","title":"\u4ed3\u50a8\u57fa\u7c7b","text":"<pre><code>public abstract class RepositoryBase&lt;TEntity, TKey, TDbContext&gt; \n    : IRepository&lt;TEntity, TKey&gt;\n    where TEntity : Entity&lt;TKey&gt;, IAggregateRoot\n    where TKey : notnull\n    where TDbContext : DbContext\n{\n    protected readonly TDbContext Context;\n\n    protected RepositoryBase(TDbContext context)\n    {\n        Context = context;\n    }\n\n    public virtual async Task&lt;TEntity?&gt; GetAsync(\n        TKey id, \n        CancellationToken cancellationToken = default)\n    {\n        return await Context.Set&lt;TEntity&gt;()\n            .FindAsync(new object[] { id }, cancellationToken);\n    }\n\n    public virtual async Task&lt;TEntity&gt; AddAsync(\n        TEntity entity, \n        CancellationToken cancellationToken = default)\n    {\n        await Context.Set&lt;TEntity&gt;().AddAsync(entity, cancellationToken);\n        return entity;\n    }\n\n    // ... \u66f4\u591a\u9ed8\u8ba4\u65b9\u6cd5\n}\n</code></pre>"},{"location":"tools/netcorepal-framework/#_7","title":"\u547d\u4ee4\u548c\u67e5\u8be2\u63a5\u53e3","text":"<pre><code>// \u547d\u4ee4\u63a5\u53e3\npublic interface ICommand : IRequest { }\npublic interface ICommand&lt;TResponse&gt; : IRequest&lt;TResponse&gt; { }\n\n// \u547d\u4ee4\u5904\u7406\u5668\u63a5\u53e3\npublic interface ICommandHandler&lt;in TCommand&gt; : IRequestHandler&lt;TCommand&gt;\n    where TCommand : ICommand { }\n\npublic interface ICommandHandler&lt;in TCommand, TResponse&gt; \n    : IRequestHandler&lt;TCommand, TResponse&gt;\n    where TCommand : ICommand&lt;TResponse&gt; { }\n\n// \u67e5\u8be2\u63a5\u53e3\npublic interface IQuery&lt;TResponse&gt; : IRequest&lt;TResponse&gt; { }\n\n// \u67e5\u8be2\u5904\u7406\u5668\u63a5\u53e3\npublic interface IQueryHandler&lt;in TQuery, TResponse&gt; \n    : IRequestHandler&lt;TQuery, TResponse&gt;\n    where TQuery : IQuery&lt;TResponse&gt; { }\n</code></pre>"},{"location":"tools/netcorepal-framework/#_8","title":"\u9886\u57df\u4e8b\u4ef6\u5904\u7406","text":"<pre><code>// \u9886\u57df\u4e8b\u4ef6\u63a5\u53e3\npublic interface IDomainEvent\n{\n    DateTimeOffset OccurredOn { get; }\n}\n\n// \u9886\u57df\u4e8b\u4ef6\u5904\u7406\u5668\u63a5\u53e3\npublic interface IDomainEventHandler&lt;in TDomainEvent&gt; \n    where TDomainEvent : IDomainEvent\n{\n    Task Handle(TDomainEvent domainEvent, CancellationToken cancellationToken);\n}\n</code></pre>"},{"location":"tools/netcorepal-framework/#_9","title":"\u914d\u7f6e\u4e0e\u4f7f\u7528","text":""},{"location":"tools/netcorepal-framework/#programcs","title":"Program.cs \u914d\u7f6e","text":"<pre><code>var builder = WebApplication.CreateBuilder(args);\n\n// \u6dfb\u52a0\u670d\u52a1\nbuilder.Services\n    .AddFastEndpoints()\n    .AddMediatR(cfg =&gt; cfg.RegisterServicesFromAssembly(Assembly.GetExecutingAssembly()))\n    .AddValidatorsFromAssembly(Assembly.GetExecutingAssembly())\n    .AddDbContext&lt;ApplicationDbContext&gt;(options =&gt;\n        options.UseSqlServer(builder.Configuration.GetConnectionString(\"DefaultConnection\")))\n    .AddRepositories()\n    .AddDomainEventHandlers();\n\nvar app = builder.Build();\n\n// \u914d\u7f6e\u4e2d\u95f4\u4ef6\napp.UseHttpsRedirection();\napp.UseFastEndpoints();\napp.Run();\n</code></pre>"},{"location":"tools/netcorepal-framework/#_10","title":"\u6570\u636e\u5e93\u8fc1\u79fb","text":"<pre><code># \u6dfb\u52a0\u8fc1\u79fb\ndotnet ef migrations add InitialCreate -p src/MyProject.Infrastructure -s src/MyProject.Web\n\n# \u66f4\u65b0\u6570\u636e\u5e93\ndotnet ef database update -p src/MyProject.Infrastructure -s src/MyProject.Web\n\n# \u5220\u9664\u6700\u540e\u4e00\u6b21\u8fc1\u79fb\ndotnet ef migrations remove -p src/MyProject.Infrastructure -s src/MyProject.Web\n</code></pre>"},{"location":"tools/netcorepal-framework/#_11","title":"\u6269\u5c55\u65b9\u6cd5","text":""},{"location":"tools/netcorepal-framework/#_12","title":"\u67e5\u8be2\u6269\u5c55","text":"<pre><code>// WhereIf - \u6761\u4ef6\u8fc7\u6ee4\nquery.WhereIf(condition, x =&gt; x.Name == name)\n\n// OrderByIf - \u6761\u4ef6\u6392\u5e8f\nquery.OrderByIf(condition, x =&gt; x.CreateTime, descending)\n\n// ToPagedDataAsync - \u5206\u9875\nawait query.ToPagedDataAsync(pageIndex, pageSize, cancellationToken)\n</code></pre>"},{"location":"tools/netcorepal-framework/#_13","title":"\u54cd\u5e94\u5305\u88c5","text":"<pre><code>// ResponseData&lt;T&gt; - \u7edf\u4e00\u54cd\u5e94\u683c\u5f0f\npublic record ResponseData&lt;T&gt;\n{\n    public bool Success { get; init; }\n    public T? Data { get; init; }\n    public string? Message { get; init; }\n    public int? ErrorCode { get; init; }\n}\n\n// \u4f7f\u7528\u793a\u4f8b\nreturn new ResponseData&lt;UserId&gt;\n{\n    Success = true,\n    Data = userId,\n    Message = \"\u7528\u6237\u521b\u5efa\u6210\u529f\"\n};\n</code></pre>"},{"location":"tools/netcorepal-framework/#_14","title":"\u6700\u4f73\u5b9e\u8df5","text":""},{"location":"tools/netcorepal-framework/#1_1","title":"1. \u5206\u5c42\u67b6\u6784","text":"<ul> <li>\u4e25\u683c\u9075\u5b88\u4f9d\u8d56\u65b9\u5411\uff1aWeb \u2192 Infrastructure \u2192 Domain</li> <li>Domain\u5c42\u4fdd\u6301\u7eaf\u51c0\uff0c\u4e0d\u4f9d\u8d56\u5916\u90e8\u6846\u67b6</li> <li>\u4f7f\u7528\u63a5\u53e3\u8fdb\u884c\u4f9d\u8d56\u5012\u7f6e</li> </ul>"},{"location":"tools/netcorepal-framework/#2_1","title":"2. \u805a\u5408\u8bbe\u8ba1","text":"<ul> <li>\u4fdd\u6301\u805a\u5408\u8fb9\u754c\u5c0f\u800c\u6e05\u6670</li> <li>\u901a\u8fc7\u805a\u5408\u6839\u8bbf\u95ee\u548c\u4fee\u6539\u805a\u5408\u5185\u5b9e\u4f53</li> <li>\u4f7f\u7528\u5f3a\u7c7b\u578bID\u907f\u514dID\u6df7\u6dc6</li> </ul>"},{"location":"tools/netcorepal-framework/#3_2","title":"3. \u547d\u4ee4\u548c\u67e5\u8be2\u5206\u79bb","text":"<ul> <li>\u547d\u4ee4\u7528\u4e8e\u4fee\u6539\u72b6\u6001\uff0c\u4f7f\u7528\u4ed3\u50a8</li> <li>\u67e5\u8be2\u7528\u4e8e\u8bfb\u53d6\u6570\u636e\uff0c\u76f4\u63a5\u7528DbContext</li> <li>\u907f\u514d\u5728\u67e5\u8be2\u4e2d\u4fee\u6539\u72b6\u6001</li> </ul>"},{"location":"tools/netcorepal-framework/#4_1","title":"4. \u4e8b\u4ef6\u9a71\u52a8","text":"<ul> <li>\u5728\u805a\u5408\u5185\u53d1\u5e03\u9886\u57df\u4e8b\u4ef6</li> <li>\u4f7f\u7528\u9886\u57df\u4e8b\u4ef6\u5904\u7406\u5668\u5b9e\u73b0\u8de8\u805a\u5408\u534f\u4f5c</li> <li>\u4f7f\u7528\u96c6\u6210\u4e8b\u4ef6\u5b9e\u73b0\u8de8\u670d\u52a1\u901a\u4fe1</li> </ul>"},{"location":"tools/netcorepal-framework/#5_1","title":"5. \u5f02\u5e38\u5904\u7406","text":"<ul> <li>\u4f7f\u7528KnownException\u5904\u7406\u4e1a\u52a1\u5f02\u5e38</li> <li>\u6846\u67b6\u81ea\u52a8\u8f6c\u6362\u4e3a\u5408\u9002\u7684HTTP\u72b6\u6001\u7801</li> <li>\u63d0\u4f9b\u6e05\u6670\u7684\u9519\u8bef\u6d88\u606f</li> </ul>"},{"location":"tools/netcorepal-framework/#_15","title":"\u6027\u80fd\u4f18\u5316","text":""},{"location":"tools/netcorepal-framework/#1_2","title":"1. \u67e5\u8be2\u4f18\u5316","text":"<pre><code>// \u4f7f\u7528\u6295\u5f71\u51cf\u5c11\u6570\u636e\u4f20\u8f93\nvar users = await context.Users\n    .Select(u =&gt; new UserDto(u.Id, u.Name, u.Email))\n    .ToListAsync();\n\n// \u907f\u514dN+1\u67e5\u8be2\nvar orders = await context.Orders\n    .Include(o =&gt; o.OrderItems)\n    .ToListAsync();\n</code></pre>"},{"location":"tools/netcorepal-framework/#2_2","title":"2. \u7f13\u5b58\u7b56\u7565","text":"<pre><code>// \u4f7f\u7528IMemoryCache\u8fdb\u884c\u672c\u5730\u7f13\u5b58\nservices.AddMemoryCache();\n\n// \u4f7f\u7528IDistributedCache\u8fdb\u884c\u5206\u5e03\u5f0f\u7f13\u5b58\nservices.AddStackExchangeRedisCache(options =&gt;\n{\n    options.Configuration = \"localhost:6379\";\n});\n</code></pre>"},{"location":"tools/netcorepal-framework/#3_3","title":"3. \u5f02\u6b65\u7f16\u7a0b","text":"<ul> <li>\u6240\u6709IO\u64cd\u4f5c\u4f7f\u7528\u5f02\u6b65\u65b9\u6cd5</li> <li>\u6b63\u786e\u4f20\u9012CancellationToken</li> <li>\u907f\u514dasync void\u65b9\u6cd5</li> </ul>"},{"location":"tools/netcorepal-framework/#_16","title":"\u5e38\u89c1\u95ee\u9898","text":""},{"location":"tools/netcorepal-framework/#q","title":"Q: \u5982\u4f55\u5904\u7406\u5e76\u53d1\u51b2\u7a81\uff1f","text":"<p>A: \u4f7f\u7528RowVersion\u5c5e\u6027\u5b9e\u73b0\u4e50\u89c2\u5e76\u53d1\u63a7\u5236\uff1a</p> <pre><code>public class User : Entity&lt;UserId&gt;, IAggregateRoot\n{\n    public RowVersion RowVersion { get; private set; } = new RowVersion(0);\n    // ...\n}\n\n// EF Core\u4f1a\u81ea\u52a8\u68c0\u6d4b\u5e76\u53d1\u51b2\u7a81\n</code></pre>"},{"location":"tools/netcorepal-framework/#q_1","title":"Q: \u5982\u4f55\u5b9e\u73b0\u8f6f\u5220\u9664\uff1f","text":"<p>A: \u6dfb\u52a0IsDeleted\u5c5e\u6027\u5e76\u914d\u7f6e\u5168\u5c40\u67e5\u8be2\u8fc7\u6ee4\u5668\uff1a</p> <pre><code>public class User : Entity&lt;UserId&gt;, IAggregateRoot\n{\n    public bool IsDeleted { get; private set; }\n\n    public void Delete()\n    {\n        IsDeleted = true;\n        this.AddDomainEvent(new UserDeletedDomainEvent(this));\n    }\n}\n\n// \u5728DbContext\u4e2d\u914d\u7f6e\nmodelBuilder.Entity&lt;User&gt;()\n    .HasQueryFilter(u =&gt; !u.IsDeleted);\n</code></pre>"},{"location":"tools/netcorepal-framework/#q_2","title":"Q: \u5982\u4f55\u5904\u7406\u957f\u65f6\u95f4\u8fd0\u884c\u7684\u64cd\u4f5c\uff1f","text":"<p>A: \u4f7f\u7528\u540e\u53f0\u4f5c\u4e1a\u6216\u6d88\u606f\u961f\u5217\uff1a</p> <pre><code>// \u4f7f\u7528Hangfire\u5904\u7406\u540e\u53f0\u4f5c\u4e1a\nservices.AddHangfire(configuration =&gt; ...);\n\n// \u5728\u547d\u4ee4\u5904\u7406\u5668\u4e2d\u89e6\u53d1\u540e\u53f0\u4f5c\u4e1a\nBackgroundJob.Enqueue(() =&gt; ProcessLongRunningTask(orderId));\n</code></pre>"},{"location":"tools/netcorepal-framework/#_17","title":"\u76f8\u5173\u8d44\u6e90","text":""},{"location":"tools/netcorepal-framework/#_18","title":"\u6587\u6863","text":"<ul> <li>\u805a\u5408\u5f00\u53d1\u6307\u5357</li> <li>\u547d\u4ee4\u5f00\u53d1\u6307\u5357</li> <li>\u67e5\u8be2\u5f00\u53d1\u6307\u5357</li> <li>\u4ed3\u50a8\u5f00\u53d1\u6307\u5357</li> </ul>"},{"location":"tools/netcorepal-framework/#_19","title":"\u793a\u4f8b\u9879\u76ee","text":"<ul> <li>NetCorePal Cloud Framework \u793a\u4f8b</li> </ul>"},{"location":"tools/netcorepal-framework/#github","title":"GitHub\u4ed3\u5e93","text":"<ul> <li>NetCorePal Cloud Framework</li> <li>\u9879\u76ee\u6a21\u677f</li> </ul>"},{"location":"tools/netcorepal-framework/#_20","title":"\u793e\u533a\u652f\u6301","text":"<ul> <li>GitHub Issues: \u62a5\u544a\u95ee\u9898\u548c\u5efa\u8bae</li> <li>\u8ba8\u8bba\u533a: \u6280\u672f\u4ea4\u6d41\u548c\u95ee\u9898\u8ba8\u8bba</li> </ul>"},{"location":"tools/netcorepal-framework/#_21","title":"\u7248\u672c\u5386\u53f2","text":""},{"location":"tools/netcorepal-framework/#v200-2024-01","title":"v2.0.0 (2024-01)","text":"<ul> <li>\u5347\u7ea7\u5230 .NET 8</li> <li>\u6539\u8fdb\u5f3a\u7c7b\u578bID\u5b9e\u73b0</li> <li>\u589e\u5f3a\u4e8b\u4ef6\u5904\u7406\u673a\u5236</li> <li>\u4f18\u5316\u6027\u80fd\u548c\u5185\u5b58\u4f7f\u7528</li> </ul>"},{"location":"tools/netcorepal-framework/#v150-2023-11","title":"v1.5.0 (2023-11)","text":"<ul> <li>\u6dfb\u52a0FastEndpoints\u96c6\u6210</li> <li>\u6539\u8fdb\u9a8c\u8bc1\u5668\u81ea\u52a8\u6ce8\u518c</li> <li>\u589e\u5f3a\u5206\u9875\u67e5\u8be2\u652f\u6301</li> </ul>"},{"location":"tools/netcorepal-framework/#v100-2023-06","title":"v1.0.0 (2023-06)","text":"<ul> <li>\u521d\u59cb\u7248\u672c\u53d1\u5e03</li> <li>\u57fa\u7840DDD\u652f\u6301</li> <li>CQRS\u6a21\u5f0f\u5b9e\u73b0</li> <li>\u4e8b\u4ef6\u9a71\u52a8\u67b6\u6784</li> </ul>"},{"location":"tools/netcorepal-framework/#_22","title":"\u8bb8\u53ef\u8bc1","text":"<p>MIT License - \u8be6\u89c1 LICENSE</p>"}]}